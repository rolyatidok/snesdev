
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />
<meta name="viewport" content="width=device-width, initial-scale=1">
    <title>wla-dx 10.2 documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/haiku.css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" /> 
  </head><body>
      <div class="header" role="banner">
    <div class="wrapper">
        <h1 class="heading"><a href="index.html">
          <span>wla-dx 10.2 documentation</span></a></h1>
        <h2 class="heading"><span>wla-dx 10.2 documentation</span></h2>
    </div>
      </div>
      <div class="topnav" role="navigation" aria-label="top navigation">
      
        <p>
        <a class="uplink" href="#">Contents</a>
        </p>

      </div>
      <div class="content" role="main">
        
        
  <ul>
<li class="toctree-l1"><a class="reference internal" href="#document-introduction">1. Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="#document-asmdiv">2. Assembler Directives</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#bit">2.1. <code class="docutils literal notranslate"><span class="pre">.16BIT</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#id1">2.2. <code class="docutils literal notranslate"><span class="pre">.24BIT</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#id2">2.3. <code class="docutils literal notranslate"><span class="pre">.8BIT</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#accu-8">2.4. <code class="docutils literal notranslate"><span class="pre">.ACCU</span> <span class="pre">8</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#addr-16000-main-255">2.5. <code class="docutils literal notranslate"><span class="pre">.ADDR</span> <span class="pre">16000,</span> <span class="pre">main,</span> <span class="pre">255</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#arraydb-name-myarray-indices-0-0-1">2.6. <code class="docutils literal notranslate"><span class="pre">.ARRAYDB</span> <span class="pre">NAME</span> <span class="pre">MyArray</span> <span class="pre">INDICES</span> <span class="pre">'0',</span> <span class="pre">0,</span> <span class="pre">1</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#arraydd-name-myarray-indices-0-0-1">2.7. <code class="docutils literal notranslate"><span class="pre">.ARRAYDD</span> <span class="pre">NAME</span> <span class="pre">MyArray</span> <span class="pre">INDICES</span> <span class="pre">'0',</span> <span class="pre">0,</span> <span class="pre">1</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#arraydef-name-myarray-size-256">2.8. <code class="docutils literal notranslate"><span class="pre">.ARRAYDEF</span> <span class="pre">NAME</span> <span class="pre">MyArray</span> <span class="pre">SIZE</span> <span class="pre">256</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#arraydefine-name-myarray-size-256">2.9. <code class="docutils literal notranslate"><span class="pre">.ARRAYDEFINE</span> <span class="pre">NAME</span> <span class="pre">MyArray</span> <span class="pre">SIZE</span> <span class="pre">256</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#arraydl-name-myarray-indices-0-0-1">2.10. <code class="docutils literal notranslate"><span class="pre">.ARRAYDL</span> <span class="pre">NAME</span> <span class="pre">MyArray</span> <span class="pre">INDICES</span> <span class="pre">'0',</span> <span class="pre">0,</span> <span class="pre">1</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#arraydw-name-myarray-indices-0-0-1">2.11. <code class="docutils literal notranslate"><span class="pre">.ARRAYDW</span> <span class="pre">NAME</span> <span class="pre">MyArray</span> <span class="pre">INDICES</span> <span class="pre">'0',</span> <span class="pre">0,</span> <span class="pre">1</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#arrayin-name-myarray-index-0-value-10">2.12. <code class="docutils literal notranslate"><span class="pre">.ARRAYIN</span> <span class="pre">NAME</span> <span class="pre">MyArray</span> <span class="pre">INDEX</span> <span class="pre">0</span> <span class="pre">VALUE</span> <span class="pre">10</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#arrayout-name-myarray-index-0-definition-arrayout">2.13. <code class="docutils literal notranslate"><span class="pre">.ARRAYOUT</span> <span class="pre">NAME</span> <span class="pre">MyArray</span> <span class="pre">INDEX</span> <span class="pre">0</span> <span class="pre">DEFINITION</span> <span class="pre">ArrayOut</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#asc-hello-world">2.14. <code class="docutils literal notranslate"><span class="pre">.ASC</span> <span class="pre">&quot;HELLO</span> <span class="pre">WORLD!&quot;</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#asciitable">2.15. <code class="docutils literal notranslate"><span class="pre">.ASCIITABLE</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#ascstr-hello-world-a">2.16. <code class="docutils literal notranslate"><span class="pre">.ASCSTR</span> <span class="pre">&quot;HELLO</span> <span class="pre">WORLD!&quot;,</span> <span class="pre">$A</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#asctable">2.17. <code class="docutils literal notranslate"><span class="pre">.ASCTABLE</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#asm">2.18. <code class="docutils literal notranslate"><span class="pre">.ASM</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#background-parallax-gb">2.19. <code class="docutils literal notranslate"><span class="pre">.BACKGROUND</span> <span class="pre">&quot;parallax.gb&quot;</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#bank-0-slot-1">2.20. <code class="docutils literal notranslate"><span class="pre">.BANK</span> <span class="pre">0</span> <span class="pre">SLOT</span> <span class="pre">1</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#base-80">2.21. <code class="docutils literal notranslate"><span class="pre">.BASE</span> <span class="pre">$80</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#bits-4-data-1011-0100-1010-0101">2.22. <code class="docutils literal notranslate"><span class="pre">.BITS</span> <span class="pre">4</span> <span class="pre">DATA</span> <span class="pre">%1011,</span> <span class="pre">%0100,</span> <span class="pre">%1010,</span> <span class="pre">%0101</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#block-block1">2.23. <code class="docutils literal notranslate"><span class="pre">.BLOCK</span> <span class="pre">&quot;Block1&quot;</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#breakpoint">2.24. <code class="docutils literal notranslate"><span class="pre">.BREAKPOINT</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#br">2.25. <code class="docutils literal notranslate"><span class="pre">.BR</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#byt-100-30-1000-hello-world">2.26. <code class="docutils literal notranslate"><span class="pre">.BYT</span> <span class="pre">100,</span> <span class="pre">$30,</span> <span class="pre">%1000,</span> <span class="pre">&quot;HELLO</span> <span class="pre">WORLD!&quot;</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#cartridgetype-1">2.27. <code class="docutils literal notranslate"><span class="pre">.CARTRIDGETYPE</span> <span class="pre">1</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#computegbchecksum">2.28. <code class="docutils literal notranslate"><span class="pre">.COMPUTEGBCHECKSUM</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#computegbcomplementcheck">2.29. <code class="docutils literal notranslate"><span class="pre">.COMPUTEGBCOMPLEMENTCHECK</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#computesmschecksum">2.30. <code class="docutils literal notranslate"><span class="pre">.COMPUTESMSCHECKSUM</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#computesneschecksum">2.31. <code class="docutils literal notranslate"><span class="pre">.COMPUTESNESCHECKSUM</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#countrycode-1">2.32. <code class="docutils literal notranslate"><span class="pre">.COUNTRYCODE</span> <span class="pre">1</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#data-ff00-2">2.33. <code class="docutils literal notranslate"><span class="pre">.DATA</span> <span class="pre">$ff00,</span> <span class="pre">2</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#db-100-30-1000-hello-world">2.34. <code class="docutils literal notranslate"><span class="pre">.DB</span> <span class="pre">100,</span> <span class="pre">$30,</span> <span class="pre">%1000,</span> <span class="pre">&quot;HELLO</span> <span class="pre">WORLD!&quot;</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#dbcos-0-2-10-3-2-120-1-3">2.35. <code class="docutils literal notranslate"><span class="pre">.DBCOS</span> <span class="pre">0.2,</span> <span class="pre">10,</span> <span class="pre">3.2,</span> <span class="pre">120,</span> <span class="pre">1.3</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#dbm-filtermacro-1-2-encrypt-me">2.36. <code class="docutils literal notranslate"><span class="pre">.DBM</span> <span class="pre">filtermacro</span> <span class="pre">1,</span> <span class="pre">2,</span> <span class="pre">&quot;encrypt</span> <span class="pre">me&quot;</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#dbrnd-20-0-10">2.37. <code class="docutils literal notranslate"><span class="pre">.DBRND</span> <span class="pre">20,</span> <span class="pre">0,</span> <span class="pre">10</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#dbsin-0-2-10-3-2-120-1-3">2.38. <code class="docutils literal notranslate"><span class="pre">.DBSIN</span> <span class="pre">0.2,</span> <span class="pre">10,</span> <span class="pre">3.2,</span> <span class="pre">120,</span> <span class="pre">1.3</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#dd-1ffffff-2000000">2.39. <code class="docutils literal notranslate"><span class="pre">.DD</span> <span class="pre">$1ffffff,</span> <span class="pre">$2000000</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#ddm-filtermacro-1-2-3">2.40. <code class="docutils literal notranslate"><span class="pre">.DDM</span> <span class="pre">filtermacro</span> <span class="pre">1,</span> <span class="pre">2,</span> <span class="pre">3</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#def-if-ff0f">2.41. <code class="docutils literal notranslate"><span class="pre">.DEF</span> <span class="pre">IF</span> <span class="pre">$FF0F</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#define-if-ff0f">2.42. <code class="docutils literal notranslate"><span class="pre">.DEFINE</span> <span class="pre">IF</span> <span class="pre">$FF0F</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#destinationcode-1">2.43. <code class="docutils literal notranslate"><span class="pre">.DESTINATIONCODE</span> <span class="pre">1</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#dl-102030-405060">2.44. <code class="docutils literal notranslate"><span class="pre">.DL</span> <span class="pre">$102030,</span> <span class="pre">$405060</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#dlm-filtermacro-1-2-3">2.45. <code class="docutils literal notranslate"><span class="pre">.DLM</span> <span class="pre">filtermacro</span> <span class="pre">1,</span> <span class="pre">2,</span> <span class="pre">3</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#ds-256-10">2.46. <code class="docutils literal notranslate"><span class="pre">.DS</span> <span class="pre">256,</span> <span class="pre">$10</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#dsb-256-10">2.47. <code class="docutils literal notranslate"><span class="pre">.DSB</span> <span class="pre">256,</span> <span class="pre">$10</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#dsd-256-1ffffff">2.48. <code class="docutils literal notranslate"><span class="pre">.DSD</span> <span class="pre">256,</span> <span class="pre">$1ffffff</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#dsl-16-102030">2.49. <code class="docutils literal notranslate"><span class="pre">.DSL</span> <span class="pre">16,</span> <span class="pre">$102030</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#dstruct-waterdrop-instanceof-water-values">2.50. <code class="docutils literal notranslate"><span class="pre">.DSTRUCT</span> <span class="pre">waterdrop</span> <span class="pre">INSTANCEOF</span> <span class="pre">water</span> <span class="pre">VALUES</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#dsw-128-20">2.51. <code class="docutils literal notranslate"><span class="pre">.DSW</span> <span class="pre">128,</span> <span class="pre">20</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#dw-16000-10-255">2.52. <code class="docutils literal notranslate"><span class="pre">.DW</span> <span class="pre">16000,</span> <span class="pre">10,</span> <span class="pre">255</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#dwcos-0-2-10-3-2-1024-1-3">2.53. <code class="docutils literal notranslate"><span class="pre">.DWCOS</span> <span class="pre">0.2,</span> <span class="pre">10,</span> <span class="pre">3.2,</span> <span class="pre">1024,</span> <span class="pre">1.3</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#dwm-filtermacro-1-2-3">2.54. <code class="docutils literal notranslate"><span class="pre">.DWM</span> <span class="pre">filtermacro</span> <span class="pre">1,</span> <span class="pre">2,</span> <span class="pre">3</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#dwrnd-20-0-10">2.55. <code class="docutils literal notranslate"><span class="pre">.DWRND</span> <span class="pre">20,</span> <span class="pre">0,</span> <span class="pre">10</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#dwsin-0-2-10-3-2-1024-1-3">2.56. <code class="docutils literal notranslate"><span class="pre">.DWSIN</span> <span class="pre">0.2,</span> <span class="pre">10,</span> <span class="pre">3.2,</span> <span class="pre">1024,</span> <span class="pre">1.3</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#elif-defined-debug-version-110">2.57. <code class="docutils literal notranslate"><span class="pre">.ELIF</span> <span class="pre">defined(DEBUG)</span> <span class="pre">&amp;&amp;</span> <span class="pre">VERSION</span> <span class="pre">&gt;</span> <span class="pre">110</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#else">2.58. <code class="docutils literal notranslate"><span class="pre">.ELSE</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#emptyfill-c9">2.59. <code class="docutils literal notranslate"><span class="pre">.EMPTYFILL</span> <span class="pre">$C9</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#endasm">2.60. <code class="docutils literal notranslate"><span class="pre">.ENDASM</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#enda">2.61. <code class="docutils literal notranslate"><span class="pre">.ENDA</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#endb">2.62. <code class="docutils literal notranslate"><span class="pre">.ENDB</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#endbits">2.63. <code class="docutils literal notranslate"><span class="pre">.ENDBITS</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#endemuvector">2.64. <code class="docutils literal notranslate"><span class="pre">.ENDEMUVECTOR</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#ende">2.65. <code class="docutils literal notranslate"><span class="pre">.ENDE</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#endif">2.66. <code class="docutils literal notranslate"><span class="pre">.ENDIF</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#endme">2.67. <code class="docutils literal notranslate"><span class="pre">.ENDME</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#endm">2.68. <code class="docutils literal notranslate"><span class="pre">.ENDM</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#endnativevector">2.69. <code class="docutils literal notranslate"><span class="pre">.ENDNATIVEVECTOR</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#endro">2.70. <code class="docutils literal notranslate"><span class="pre">.ENDRO</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#endr">2.71. <code class="docutils literal notranslate"><span class="pre">.ENDR</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#endsnes">2.72. <code class="docutils literal notranslate"><span class="pre">.ENDSNES</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#endst">2.73. <code class="docutils literal notranslate"><span class="pre">.ENDST</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#ends">2.74. <code class="docutils literal notranslate"><span class="pre">.ENDS</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#endu">2.75. <code class="docutils literal notranslate"><span class="pre">.ENDU</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#enum-c000">2.76. <code class="docutils literal notranslate"><span class="pre">.ENUM</span> <span class="pre">$C000</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#enumid-id-1-0">2.77. <code class="docutils literal notranslate"><span class="pre">.ENUMID</span> <span class="pre">ID_1</span> <span class="pre">0</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#equ-if-ff0f">2.78. <code class="docutils literal notranslate"><span class="pre">.EQU</span> <span class="pre">IF</span> <span class="pre">$FF0F</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#exhirom">2.79. <code class="docutils literal notranslate"><span class="pre">.EXHIROM</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#export-work-x">2.80. <code class="docutils literal notranslate"><span class="pre">.EXPORT</span> <span class="pre">work_x</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#fail-the-eye-of-mordor-has-seen-us">2.81. <code class="docutils literal notranslate"><span class="pre">.FAIL</span> <span class="pre">&quot;THE</span> <span class="pre">EYE</span> <span class="pre">OF</span> <span class="pre">MORDOR</span> <span class="pre">HAS</span> <span class="pre">SEEN</span> <span class="pre">US!&quot;</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#faraddr-main-irq-1">2.82. <code class="docutils literal notranslate"><span class="pre">.FARADDR</span> <span class="pre">main,</span> <span class="pre">irq_1</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#fastrom">2.83. <code class="docutils literal notranslate"><span class="pre">.FASTROM</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#fclose-fp-databin">2.84. <code class="docutils literal notranslate"><span class="pre">.FCLOSE</span> <span class="pre">FP_DATABIN</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#filter-filtermacro-1-2-encrypt-me">2.85. <code class="docutils literal notranslate"><span class="pre">.FILTER</span> <span class="pre">filtermacro</span> <span class="pre">1,</span> <span class="pre">2,</span> <span class="pre">&quot;encrypt</span> <span class="pre">me&quot;</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#fopen-data-bin-fp-databin">2.86. <code class="docutils literal notranslate"><span class="pre">.FOPEN</span> <span class="pre">&quot;data.bin&quot;</span> <span class="pre">FP_DATABIN</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#fread-fp-databin-data">2.87. <code class="docutils literal notranslate"><span class="pre">.FREAD</span> <span class="pre">FP_DATABIN</span> <span class="pre">DATA</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#fseek-fp-databin-10-start">2.88. <code class="docutils literal notranslate"><span class="pre">.FSEEK</span> <span class="pre">FP_DATABIN</span> <span class="pre">10</span> <span class="pre">START</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#fsize-fp-databin-size">2.89. <code class="docutils literal notranslate"><span class="pre">.FSIZE</span> <span class="pre">FP_DATABIN</span> <span class="pre">SIZE</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#ftell-fp-databin-position">2.90. <code class="docutils literal notranslate"><span class="pre">.FTELL</span> <span class="pre">FP_DATABIN</span> <span class="pre">POSITION</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#gbheader">2.91. <code class="docutils literal notranslate"><span class="pre">.GBHEADER</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#hex-a0a0ffde">2.92. <code class="docutils literal notranslate"><span class="pre">.HEX</span> <span class="pre">&quot;a0A0ffDE&quot;</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#hirom">2.93. <code class="docutils literal notranslate"><span class="pre">.HIROM</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#if-debug-2">2.94. <code class="docutils literal notranslate"><span class="pre">.IF</span> <span class="pre">DEBUG</span> <span class="pre">==</span> <span class="pre">2</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#ifdef-if">2.95. <code class="docutils literal notranslate"><span class="pre">.IFDEF</span> <span class="pre">IF</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#ifdefm-2">2.96. <code class="docutils literal notranslate"><span class="pre">.IFDEFM</span> <span class="pre">\2</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#ifeq-debug-2">2.97. <code class="docutils literal notranslate"><span class="pre">.IFEQ</span> <span class="pre">DEBUG</span> <span class="pre">2</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#ifexists-main-s">2.98. <code class="docutils literal notranslate"><span class="pre">.IFEXISTS</span> <span class="pre">&quot;main.s&quot;</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#ifgr-debug-2">2.99. <code class="docutils literal notranslate"><span class="pre">.IFGR</span> <span class="pre">DEBUG</span> <span class="pre">2</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#ifgreq-debug-2">2.100. <code class="docutils literal notranslate"><span class="pre">.IFGREQ</span> <span class="pre">DEBUG</span> <span class="pre">2</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#ifle-debug-2">2.101. <code class="docutils literal notranslate"><span class="pre">.IFLE</span> <span class="pre">DEBUG</span> <span class="pre">2</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#ifleeq-debug-2">2.102. <code class="docutils literal notranslate"><span class="pre">.IFLEEQ</span> <span class="pre">DEBUG</span> <span class="pre">2</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#ifndef-if">2.103. <code class="docutils literal notranslate"><span class="pre">.IFNDEF</span> <span class="pre">IF</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#ifndefm-2">2.104. <code class="docutils literal notranslate"><span class="pre">.IFNDEFM</span> <span class="pre">\2</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#ifneq-debug-2">2.105. <code class="docutils literal notranslate"><span class="pre">.IFNEQ</span> <span class="pre">DEBUG</span> <span class="pre">2</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#inc-cgb-hardware-i">2.106. <code class="docutils literal notranslate"><span class="pre">.INC</span> <span class="pre">&quot;cgb_hardware.i&quot;</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#incbin-sorority-bin">2.107. <code class="docutils literal notranslate"><span class="pre">.INCBIN</span> <span class="pre">&quot;sorority.bin&quot;</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#incdir-usr-programming-gb-include">2.108. <code class="docutils literal notranslate"><span class="pre">.INCDIR</span> <span class="pre">&quot;/usr/programming/gb/include/&quot;</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#include-cgb-hardware-i">2.109. <code class="docutils literal notranslate"><span class="pre">.INCLUDE</span> <span class="pre">&quot;cgb_hardware.i&quot;</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#index-8">2.110. <code class="docutils literal notranslate"><span class="pre">.INDEX</span> <span class="pre">8</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#input-name">2.111. <code class="docutils literal notranslate"><span class="pre">.INPUT</span> <span class="pre">NAME</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#licenseecodenew-1a">2.112. <code class="docutils literal notranslate"><span class="pre">.LICENSEECODENEW</span> <span class="pre">&quot;1A&quot;</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#licenseecodeold-1a">2.113. <code class="docutils literal notranslate"><span class="pre">.LICENSEECODEOLD</span> <span class="pre">$1A</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#long-102030-405060">2.114. <code class="docutils literal notranslate"><span class="pre">.LONG</span> <span class="pre">$102030,</span> <span class="pre">$405060</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#lorom">2.115. <code class="docutils literal notranslate"><span class="pre">.LOROM</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#macro-test">2.116. <code class="docutils literal notranslate"><span class="pre">.MACRO</span> <span class="pre">TEST</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#memorymap">2.117. <code class="docutils literal notranslate"><span class="pre">.MEMORYMAP</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#name-name-of-the-rom">2.118. <code class="docutils literal notranslate"><span class="pre">.NAME</span> <span class="pre">&quot;NAME</span> <span class="pre">OF</span> <span class="pre">THE</span> <span class="pre">ROM&quot;</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#nextu-name">2.119. <code class="docutils literal notranslate"><span class="pre">.NEXTU</span> <span class="pre">name</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#nintendologo">2.120. <code class="docutils literal notranslate"><span class="pre">.NINTENDOLOGO</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#nowdc">2.121. <code class="docutils literal notranslate"><span class="pre">.NOWDC</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#org-150">2.122. <code class="docutils literal notranslate"><span class="pre">.ORG</span> <span class="pre">$150</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#orga-150">2.123. <code class="docutils literal notranslate"><span class="pre">.ORGA</span> <span class="pre">$150</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#outname-other-o">2.124. <code class="docutils literal notranslate"><span class="pre">.OUTNAME</span> <span class="pre">&quot;other.o&quot;</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#print-numbers-1-and-10-dec-1-hex-10-n">2.125. <code class="docutils literal notranslate"><span class="pre">.PRINT</span> <span class="pre">&quot;Numbers</span> <span class="pre">1</span> <span class="pre">and</span> <span class="pre">10:</span> <span class="pre">&quot;,</span> <span class="pre">DEC</span> <span class="pre">1,</span> <span class="pre">&quot;</span> <span class="pre">$&quot;,</span> <span class="pre">HEX</span> <span class="pre">10,</span> <span class="pre">&quot;\n&quot;</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#printt-here-we-are-n">2.126. <code class="docutils literal notranslate"><span class="pre">.PRINTT</span> <span class="pre">&quot;Here</span> <span class="pre">we</span> <span class="pre">are...\n&quot;</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#printv-dec-debug-1">2.127. <code class="docutils literal notranslate"><span class="pre">.PRINTV</span> <span class="pre">DEC</span> <span class="pre">DEBUG+1</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#ramsection-vars-bank-0-slot-1-align-256-offset-32">2.128. <code class="docutils literal notranslate"><span class="pre">.RAMSECTION</span> <span class="pre">&quot;Vars&quot;</span> <span class="pre">BANK</span> <span class="pre">0</span> <span class="pre">SLOT</span> <span class="pre">1</span> <span class="pre">ALIGN</span> <span class="pre">256</span> <span class="pre">OFFSET</span> <span class="pre">32</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#ramsize-0">2.129. <code class="docutils literal notranslate"><span class="pre">.RAMSIZE</span> <span class="pre">0</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#redef-if-0f">2.130. <code class="docutils literal notranslate"><span class="pre">.REDEF</span> <span class="pre">IF</span> <span class="pre">$0F</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#redefine-if-0f">2.131. <code class="docutils literal notranslate"><span class="pre">.REDEFINE</span> <span class="pre">IF</span> <span class="pre">$0F</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#repeat-6">2.132. <code class="docutils literal notranslate"><span class="pre">.REPEAT</span> <span class="pre">6</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#rept-6">2.133. <code class="docutils literal notranslate"><span class="pre">.REPT</span> <span class="pre">6</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#rombankmap">2.134. <code class="docutils literal notranslate"><span class="pre">.ROMBANKMAP</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#rombanks-2">2.135. <code class="docutils literal notranslate"><span class="pre">.ROMBANKS</span> <span class="pre">2</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#rombanksize-4000">2.136. <code class="docutils literal notranslate"><span class="pre">.ROMBANKSIZE</span> <span class="pre">$4000</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#romdmg">2.137. <code class="docutils literal notranslate"><span class="pre">.ROMDMG</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#romgbconly">2.138. <code class="docutils literal notranslate"><span class="pre">.ROMGBCONLY</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#romgbc">2.139. <code class="docutils literal notranslate"><span class="pre">.ROMGBC</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#romsgb">2.140. <code class="docutils literal notranslate"><span class="pre">.ROMSGB</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#romsize-1">2.141. <code class="docutils literal notranslate"><span class="pre">.ROMSIZE</span> <span class="pre">1</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#row-ff00-1-3">2.142. <code class="docutils literal notranslate"><span class="pre">.ROW</span> <span class="pre">$ff00,</span> <span class="pre">1,</span> <span class="pre">&quot;3&quot;</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#sdsctag-1-0-dungeon-man-a-wild-dungeon-exploration-game-ville-helin">2.143. <code class="docutils literal notranslate"><span class="pre">.SDSCTAG</span> <span class="pre">1.0,</span> <span class="pre">&quot;DUNGEON</span> <span class="pre">MAN&quot;,</span> <span class="pre">&quot;A</span> <span class="pre">wild</span> <span class="pre">dungeon</span> <span class="pre">exploration</span> <span class="pre">game&quot;,</span> <span class="pre">&quot;Ville</span> <span class="pre">Helin&quot;</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#section-init-force">2.144. <code class="docutils literal notranslate"><span class="pre">.SECTION</span> <span class="pre">&quot;Init&quot;</span> <span class="pre">FORCE</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#seed-123">2.145. <code class="docutils literal notranslate"><span class="pre">.SEED</span> <span class="pre">123</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#shift">2.146. <code class="docutils literal notranslate"><span class="pre">.SHIFT</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#slot-1">2.147. <code class="docutils literal notranslate"><span class="pre">.SLOT</span> <span class="pre">1</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#slowrom">2.148. <code class="docutils literal notranslate"><span class="pre">.SLOWROM</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#smc">2.149. <code class="docutils literal notranslate"><span class="pre">.SMC</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#smsheader">2.150. <code class="docutils literal notranslate"><span class="pre">.SMSHEADER</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#smstag">2.151. <code class="docutils literal notranslate"><span class="pre">.SMSTAG</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#snesemuvector">2.152. <code class="docutils literal notranslate"><span class="pre">.SNESEMUVECTOR</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#snesheader">2.153. <code class="docutils literal notranslate"><span class="pre">.SNESHEADER</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#snesnativevector">2.154. <code class="docutils literal notranslate"><span class="pre">.SNESNATIVEVECTOR</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#stringmap-script-hello-n">2.155. <code class="docutils literal notranslate"><span class="pre">.STRINGMAP</span> <span class="pre">script</span> <span class="pre">&quot;Hello\n&quot;</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#stringmaptable-script-script-tbl">2.156. <code class="docutils literal notranslate"><span class="pre">.STRINGMAPTABLE</span> <span class="pre">script</span> <span class="pre">&quot;script.tbl&quot;</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#struct-enemy-object">2.157. <code class="docutils literal notranslate"><span class="pre">.STRUCT</span> <span class="pre">enemy_object</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#sym-sausage">2.158. <code class="docutils literal notranslate"><span class="pre">.SYM</span> <span class="pre">SAUSAGE</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#symbol-sausage">2.159. <code class="docutils literal notranslate"><span class="pre">.SYMBOL</span> <span class="pre">SAUSAGE</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#table-byte-word-byte">2.160. <code class="docutils literal notranslate"><span class="pre">.TABLE</span> <span class="pre">byte,</span> <span class="pre">word,</span> <span class="pre">byte</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#unbackground-1000-1fff">2.161. <code class="docutils literal notranslate"><span class="pre">.UNBACKGROUND</span> <span class="pre">$1000</span> <span class="pre">$1FFF</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#undef-debug">2.162. <code class="docutils literal notranslate"><span class="pre">.UNDEF</span> <span class="pre">DEBUG</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#undefine-debug">2.163. <code class="docutils literal notranslate"><span class="pre">.UNDEFINE</span> <span class="pre">DEBUG</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#union-name">2.164. <code class="docutils literal notranslate"><span class="pre">.UNION</span> <span class="pre">name</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#version-1">2.165. <code class="docutils literal notranslate"><span class="pre">.VERSION</span> <span class="pre">1</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#wdc">2.166. <code class="docutils literal notranslate"><span class="pre">.WDC</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#word-16000-10-255">2.167. <code class="docutils literal notranslate"><span class="pre">.WORD</span> <span class="pre">16000,</span> <span class="pre">10,</span> <span class="pre">255</span></code></a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="#document-asmsyntax">3. Assembler Syntax</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#case-sensitivity">3.1. Case Sensitivity</a></li>
<li class="toctree-l2"><a class="reference internal" href="#comments">3.2. Comments</a></li>
<li class="toctree-l2"><a class="reference internal" href="#line-splitting">3.3. Line splitting</a></li>
<li class="toctree-l2"><a class="reference internal" href="#labels">3.4. Labels</a></li>
<li class="toctree-l2"><a class="reference internal" href="#number-types">3.5. Number Types</a></li>
<li class="toctree-l2"><a class="reference internal" href="#strings">3.6. Strings</a></li>
<li class="toctree-l2"><a class="reference internal" href="#substitution">3.7. Substitution</a></li>
<li class="toctree-l2"><a class="reference internal" href="#mnemonics">3.8. Mnemonics</a></li>
<li class="toctree-l2"><a class="reference internal" href="#brackets">3.9. Brackets?</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="#document-errormsg">4. Error Messages</a></li>
<li class="toctree-l1"><a class="reference internal" href="#document-gb-support">5. Supported ROM/RAM/Cartridge Types (WLA-GB)</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#rom-size">5.1. ROM Size</a></li>
<li class="toctree-l2"><a class="reference internal" href="#ram-size">5.2. RAM Size</a></li>
<li class="toctree-l2"><a class="reference internal" href="#cartridge-type">5.3. Cartridge Type</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="#document-bugs">6. Bugs</a></li>
<li class="toctree-l1"><a class="reference internal" href="#document-files">7. Files</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#tests">7.1. <code class="docutils literal notranslate"><span class="pre">tests</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#tests-gb-z80-lib">7.2. <code class="docutils literal notranslate"><span class="pre">tests/gb-z80/lib</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#memorymaps">7.3. <code class="docutils literal notranslate"><span class="pre">memorymaps</span></code></a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="#document-functions">8. Functions</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#built-in-functions">8.1. Built-in functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="#examples-of-functions">8.2. Examples of functions</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="#document-tempfiles">9. Temporary Files</a></li>
<li class="toctree-l1"><a class="reference internal" href="#document-compiling">10. Compiling</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#compiling-object-files">10.1. Compiling Object Files</a></li>
<li class="toctree-l2"><a class="reference internal" href="#compiling-library-files">10.2. Compiling Library Files</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="#document-linking">11. Linking</a></li>
<li class="toctree-l1"><a class="reference internal" href="#document-arithmetics">12. Arithmetics</a></li>
<li class="toctree-l1"><a class="reference internal" href="#document-bintodb">13. Binary to DB Conversion</a></li>
<li class="toctree-l1"><a class="reference internal" href="#document-codetoknow">14. Things you should know about coding for…</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#z80">14.1. Z80</a></li>
<li class="toctree-l2"><a class="reference internal" href="#codesub6502">14.2. 6502</a></li>
<li class="toctree-l2"><a class="reference internal" href="#c02">14.3. 65C02</a></li>
<li class="toctree-l2"><a class="reference internal" href="#ce02">14.4. 65CE02</a></li>
<li class="toctree-l2"><a class="reference internal" href="#id2">14.5. 65816</a></li>
<li class="toctree-l2"><a class="reference internal" href="#huc6280">14.6. HUC6280</a></li>
<li class="toctree-l2"><a class="reference internal" href="#spc-700">14.7. SPC-700</a></li>
<li class="toctree-l2"><a class="reference internal" href="#pocket-voice-gb-z80">14.8. Pocket Voice (GB-Z80)</a></li>
<li class="toctree-l2"><a class="reference internal" href="#gb-z80">14.9. GB-Z80</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="#document-wlaflags">15. WLA Flags</a></li>
<li class="toctree-l1"><a class="reference internal" href="#document-extraflags">16. Extra compile time definitions</a></li>
<li class="toctree-l1"><a class="reference internal" href="#document-goodtoknow">17. Good things to know about WLA</a></li>
<li class="toctree-l1"><a class="reference internal" href="#document-archoverview">18. WLA DX’s architectural overview</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#wla">18.1. WLA</a></li>
<li class="toctree-l2"><a class="reference internal" href="#wlalink">18.2. WLALINK</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="#document-symbols">19. WLA Symbols</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#wla-symbol-version-history">19.1. WLA Symbol Version History</a></li>
<li class="toctree-l2"><a class="reference internal" href="#information-for-emulator-developers">19.2. Information For Emulator Developers</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="#document-legal">20. Legal Note</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="#document-man/wlalink">1. Manpage: WLA-LINK</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#synopsis">1.1. SYNOPSIS</a></li>
<li class="toctree-l2"><a class="reference internal" href="#options">1.2. OPTIONS</a></li>
<li class="toctree-l2"><a class="reference internal" href="#description">1.3. DESCRIPTION</a></li>
<li class="toctree-l2"><a class="reference internal" href="#examples">1.4. EXAMPLES</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="#document-man/wla-cpu">2. Manpage: WLA-CPU</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#synopsis">2.1. SYNOPSIS</a></li>
<li class="toctree-l2"><a class="reference internal" href="#options">2.2. OPTIONS</a></li>
<li class="toctree-l2"><a class="reference internal" href="#description">2.3. DESCRIPTION</a></li>
<li class="toctree-l2"><a class="reference internal" href="#examples">2.4. EXAMPLES</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="#document-man/wlab">3. Manpage: WLAB</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#synopsis">3.1. SYNOPSIS</a></li>
<li class="toctree-l2"><a class="reference internal" href="#options">3.2. OPTIONS</a></li>
<li class="toctree-l2"><a class="reference internal" href="#description">3.3. DESCRIPTION</a></li>
<li class="toctree-l2"><a class="reference internal" href="#examples">3.4. EXAMPLES</a></li>
</ul>
</li>
</ul>
<div class="toctree-wrapper compound">
<span id="document-introduction"></span><section id="introduction">
<h1><span class="section-number">1. </span>Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h1>
<p>The history behind WLA DX, from the original author, Ville Helin:</p>
<blockquote>
<div><p>I wrote this because I had never written an assembler before and I really
needed a macro assembler which could compile the GB-Z80 code I wrote. ;)
Gaelan Griffin needed real Z80 support for his SMS projects so I thought
I could write WLA to be a little more open and nowadays it supports all
the Z80 systems you can think of. You’ll just have to define the memorymap
of the destination machine for your project. After fixing some bugs I thought
I could add support for 6502 systems so all NES-people would get their
share of WLA as well. After finishing that few people said they’d like 65816
support (they had SNES developing in mind) so I added support for that. And
then I thought I should write a 6510 version of WLA as well…</p>
<p>This is my ideal GB-Z80 macro assembler (not in final form, not yet). ;)
Tastes differ. Thus WLA! Notice that WLA was initially made for Game Boy
developers so the GB-Z80 version and the rest differ a little.</p>
</div></blockquote>
<p>Good to know about WLA DX:</p>
<p>Almost all rules that apply to Z80 source code processing with WLA DX
apply also to 6502, 65C02, 65CE02, 65816, 6800, 6801, 6809, 8008, 8080,
HUC6280, SPC-700 and SuperFX.</p>
<p>About the names: WLA DX means all the tools covered in this documentation.
So WLA DX includes WLA GB-Z80/Z80/6502/65C02/65CE02/65816/6800/6801/6809/
8008/8080/HUC6280/SPC-700/SuperFX macro assembler (what a horribly long name), WLAB,
and WLALINK GB-Z80/Z80/6502/65C02/65CE02/65816/6800/6801/6809/8008/8080/
HUC6280/SPC-700/SuperFX linker. We use plain WLA to refer to the macro assembler
in this document.</p>
<p>There was WLAD, an GB-Z80 dissassembler, but it has been discontinued and
removed from the project and the documentation.</p>
<p>Currently WLA can also be used as a patch tool. Just include the original
ROM image into the project with <code class="docutils literal notranslate"><span class="pre">.BACKGROUND</span></code> and insert e.g.,
<code class="docutils literal notranslate"><span class="pre">OVERWRITE</span> <span class="pre">.SECTION</span></code> s to patch the desired areas. Output the data into a new
ROM image and there you have it. 100% readable (asm coded) patches are reality!</p>
<p>Note that you can directly compile only object and library files. You must
use WLALINK to link these (or only one, if you must) into a ROM/program file.</p>
<div class="line-block">
<div class="line">WLA DX’s old homepage: <a class="reference external" href="http://www.villehelin.com/wla.html">http://www.villehelin.com/wla.html</a></div>
<div class="line">WLA DX’s new homepage: <a class="reference external" href="https://github.com/vhelin/wla-dx">https://github.com/vhelin/wla-dx</a></div>
</div>
</section>
<span id="document-asmdiv"></span><section id="assembler-directives">
<h1><span class="section-number">2. </span>Assembler Directives<a class="headerlink" href="#assembler-directives" title="Permalink to this headline">¶</a></h1>
<p>Here’s the order in which the data is placed into the output:</p>
<ol class="arabic simple">
<li><p>Data and group 3 directives outside sections.</p></li>
<li><p>Group 2 directives.</p></li>
<li><p>Data and group 3 directives inside sections.</p></li>
<li><p>Group 1 directives.</p></li>
</ol>
<table class="docutils align-default">
<tbody>
<tr class="row-odd"><td><p>ALL</p></td>
<td><p>All, GB-Z80, Z80, 6502, 65C02, 65CE02, 65816, HUC6280,
SPC-700, 6800, 6801, 6809, 8008, 8080 and SuperFX versions apply.</p></td>
</tr>
<tr class="row-even"><td><p>GB</p></td>
<td><p>Only the GB-Z80 version applies.</p></td>
</tr>
<tr class="row-odd"><td><p>GB8</p></td>
<td><p>Only the GB-Z80 and 65816 versions apply.</p></td>
</tr>
<tr class="row-even"><td><p>Z80</p></td>
<td><p>Only the Z80 version applies.</p></td>
</tr>
<tr class="row-odd"><td><p>658</p></td>
<td><p>Only the 65816 version applies.</p></td>
</tr>
<tr class="row-even"><td><p>680</p></td>
<td><p>Only the 6800, 6801 and 6809 versions apply.</p></td>
</tr>
<tr class="row-odd"><td><p>800</p></td>
<td><p>Only the 8008 version applies.</p></td>
</tr>
<tr class="row-even"><td><p>808</p></td>
<td><p>Only the 8080 version applies.</p></td>
</tr>
<tr class="row-odd"><td><p>SPC</p></td>
<td><p>Only the SPC-700 version applies.</p></td>
</tr>
<tr class="row-even"><td><p>SFX</p></td>
<td><p>Only the SuperFX version applies.</p></td>
</tr>
<tr class="row-odd"><td><p>65x</p></td>
<td><p>Only the 6502, 65C02, 65CE02, 65816 and HUC6280 versions apply.</p></td>
</tr>
<tr class="row-even"><td><p>!GB</p></td>
<td><p>All but the GB-Z80 versions apply.</p></td>
</tr>
</tbody>
</table>
<p>Group 1:</p>
<table class="docutils align-default">
<tbody>
<tr class="row-odd"><td><p>GB</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">.COMPUTEGBCHECKSUM</span></code></p></td>
</tr>
<tr class="row-even"><td><p>Z80</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">.COMPUTESMSCHECKSUM</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>658</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">.COMPUTESNESCHECKSUM</span></code></p></td>
</tr>
<tr class="row-even"><td><p>Z80</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">.SDSCTAG</span> <span class="pre">1.0,</span> <span class="pre">&quot;DUNGEON</span> <span class="pre">MAN&quot;,</span> <span class="pre">&quot;A</span> <span class="pre">wild</span> <span class="pre">dungeon</span> <span class="pre">exploration</span> <span class="pre">game&quot;,</span> <span class="pre">&quot;Ville</span> <span class="pre">Helin&quot;</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>Z80</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">.SMSTAG</span></code></p></td>
</tr>
</tbody>
</table>
<p>Group 2:</p>
<table class="docutils align-default">
<tbody>
<tr class="row-odd"><td><p>GB</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">.CARTRIDGETYPE</span> <span class="pre">1</span></code></p></td>
</tr>
<tr class="row-even"><td><p>GB</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">.COMPUTEGBCOMPLEMENTCHECK</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>GB</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">.COUNTRYCODE</span> <span class="pre">1</span></code></p></td>
</tr>
<tr class="row-even"><td><p>GB</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">.DESTINATIONCODE</span> <span class="pre">1</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>ALL</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">.EMPTYFILL</span> <span class="pre">$C9</span></code></p></td>
</tr>
<tr class="row-even"><td><p>658</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">.ENDEMUVECTOR</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>658</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">.ENDNATIVEVECTOR</span></code></p></td>
</tr>
<tr class="row-even"><td><p>658</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">.ENDSNES</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>658</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">.EXHIROM</span></code></p></td>
</tr>
<tr class="row-even"><td><p>ALL</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">.EXPORT</span> <span class="pre">work_x</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>658</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">.FASTROM</span></code></p></td>
</tr>
<tr class="row-even"><td><p>GB</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">.GBHEADER</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>658</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">.HIROM</span></code></p></td>
</tr>
<tr class="row-even"><td><p>GB</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">.LICENSEECODENEW</span> <span class="pre">&quot;1A&quot;</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>GB</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">.LICENSEECODEOLD</span> <span class="pre">$1A</span></code></p></td>
</tr>
<tr class="row-even"><td><p>658</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">.LOROM</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>GB8</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">.NAME</span> <span class="pre">&quot;NAME</span> <span class="pre">OF</span> <span class="pre">THE</span> <span class="pre">ROM&quot;</span></code></p></td>
</tr>
<tr class="row-even"><td><p>GB</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">.NINTENDOLOGO</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>ALL</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">.OUTNAME</span> <span class="pre">&quot;other.o&quot;</span></code></p></td>
</tr>
<tr class="row-even"><td><p>GB</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">.RAMSIZE</span> <span class="pre">0</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>GB</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">.ROMDMG</span></code></p></td>
</tr>
<tr class="row-even"><td><p>GB</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">.ROMGBC</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>GB</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">.ROMGBCONLY</span></code></p></td>
</tr>
<tr class="row-even"><td><p>GB</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">.ROMSGB</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>GB</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">.ROMSIZE</span> <span class="pre">1</span></code></p></td>
</tr>
<tr class="row-even"><td><p>658</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">.SLOWROM</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>658</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">.SMC</span></code></p></td>
</tr>
<tr class="row-even"><td><p>Z80</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">.SMSHEADER</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>658</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">.SNESEMUVECTOR</span></code></p></td>
</tr>
<tr class="row-even"><td><p>658</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">.SNESHEADER</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>658</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">.SNESNATIVEVECTOR</span></code></p></td>
</tr>
<tr class="row-even"><td><p>GB</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">.VERSION</span> <span class="pre">1</span></code></p></td>
</tr>
</tbody>
</table>
<p>Group 3:</p>
<table class="docutils align-default">
<tbody>
<tr class="row-odd"><td><p>65x</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">.16BIT</span></code></p></td>
</tr>
<tr class="row-even"><td><p>658</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">.24BIT</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>65x</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">.8BIT</span></code></p></td>
</tr>
<tr class="row-even"><td><p>658</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">.ACCU</span> <span class="pre">8</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>ALL</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">.ADDR</span> <span class="pre">16000,</span> <span class="pre">main,</span> <span class="pre">255</span></code></p></td>
</tr>
<tr class="row-even"><td><p>ALL</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">.ARRAYDB</span> <span class="pre">NAME</span> <span class="pre">MyArray</span> <span class="pre">INDICES</span> <span class="pre">'0',</span> <span class="pre">0,</span> <span class="pre">1</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>ALL</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">.ARRAYDD</span> <span class="pre">NAME</span> <span class="pre">MyArray</span> <span class="pre">INDICES</span> <span class="pre">'0',</span> <span class="pre">0,</span> <span class="pre">1</span></code></p></td>
</tr>
<tr class="row-even"><td><p>ALL</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">.ARRAYDEF</span> <span class="pre">NAME</span> <span class="pre">MyArray</span> <span class="pre">SIZE</span> <span class="pre">256</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>ALL</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">.ARRAYDEFINE</span> <span class="pre">NAME</span> <span class="pre">MyArray</span> <span class="pre">SIZE</span> <span class="pre">256</span></code></p></td>
</tr>
<tr class="row-even"><td><p>ALL</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">.ARRAYDL</span> <span class="pre">NAME</span> <span class="pre">MyArray</span> <span class="pre">INDICES</span> <span class="pre">'0',</span> <span class="pre">0,</span> <span class="pre">1</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>ALL</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">.ARRAYDW</span> <span class="pre">NAME</span> <span class="pre">MyArray</span> <span class="pre">INDICES</span> <span class="pre">'0',</span> <span class="pre">0,</span> <span class="pre">1</span></code></p></td>
</tr>
<tr class="row-even"><td><p>ALL</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">.ARRAYIN</span> <span class="pre">NAME</span> <span class="pre">MyArray</span> <span class="pre">INDEX</span> <span class="pre">0</span> <span class="pre">VALUE</span> <span class="pre">10</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>ALL</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">.ARRAYOUT</span> <span class="pre">NAME</span> <span class="pre">MyArray</span> <span class="pre">INDEX</span> <span class="pre">0</span> <span class="pre">DEFINITION</span> <span class="pre">ArrayOut</span></code></p></td>
</tr>
<tr class="row-even"><td><p>ALL</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">.ASC</span> <span class="pre">&quot;HELLO</span> <span class="pre">WORLD!&quot;</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>ALL</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">.ASCIITABLE</span></code></p></td>
</tr>
<tr class="row-even"><td><p>ALL</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">.ASCSTR</span> <span class="pre">&quot;HELLO</span> <span class="pre">WORLD!&quot;,</span> <span class="pre">$A</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>ALL</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">.ASCTABLE</span></code></p></td>
</tr>
<tr class="row-even"><td><p>ALL</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">.ASM</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>ALL</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">.BACKGROUND</span> <span class="pre">&quot;parallax.gb&quot;</span></code></p></td>
</tr>
<tr class="row-even"><td><p>ALL</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">.BANK</span> <span class="pre">0</span> <span class="pre">SLOT</span> <span class="pre">1</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>ALL</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">.BASE</span> <span class="pre">$80</span></code></p></td>
</tr>
<tr class="row-even"><td><p>ALL</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">.BITS</span> <span class="pre">4</span> <span class="pre">DATA</span> <span class="pre">%1011,</span> <span class="pre">%0100,</span> <span class="pre">%1010,</span> <span class="pre">%0101</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>ALL</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">.BLOCK</span> <span class="pre">&quot;Block1&quot;</span></code></p></td>
</tr>
<tr class="row-even"><td><p>ALL</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">.BR</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>ALL</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">.BREAKPOINT</span></code></p></td>
</tr>
<tr class="row-even"><td><p>ALL</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">.BYT</span> <span class="pre">100,</span> <span class="pre">$30,</span> <span class="pre">%1000,</span> <span class="pre">&quot;HELLO</span> <span class="pre">WORLD!&quot;</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>ALL</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">.DATA</span> <span class="pre">$ff00,</span> <span class="pre">2</span></code></p></td>
</tr>
<tr class="row-even"><td><p>ALL</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">.DB</span> <span class="pre">100,</span> <span class="pre">$30,</span> <span class="pre">%1000,</span> <span class="pre">&quot;HELLO</span> <span class="pre">WORLD!&quot;</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>ALL</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">.DBCOS</span> <span class="pre">0.2,</span> <span class="pre">10,</span> <span class="pre">3.2,</span> <span class="pre">120,</span> <span class="pre">1.3</span></code></p></td>
</tr>
<tr class="row-even"><td><p>ALL</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">.DBM</span> <span class="pre">filtermacro</span> <span class="pre">1,</span> <span class="pre">2,</span> <span class="pre">&quot;encrypt</span> <span class="pre">me&quot;</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>ALL</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">.DBRND</span> <span class="pre">20,</span> <span class="pre">0,</span> <span class="pre">10</span></code></p></td>
</tr>
<tr class="row-even"><td><p>ALL</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">.DBSIN</span> <span class="pre">0.2,</span> <span class="pre">10,</span> <span class="pre">3.2,</span> <span class="pre">120,</span> <span class="pre">1.3</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>ALL</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">.DD</span> <span class="pre">$1ffffff,</span> <span class="pre">$2000000</span></code></p></td>
</tr>
<tr class="row-even"><td><p>ALL</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">.DDM</span> <span class="pre">filtermacro</span> <span class="pre">1,</span> <span class="pre">2,</span> <span class="pre">3</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>ALL</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">.DEF</span> <span class="pre">IF</span> <span class="pre">$FF0F</span></code></p></td>
</tr>
<tr class="row-even"><td><p>ALL</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">.DEFINE</span> <span class="pre">IF</span> <span class="pre">$FF0F</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>ALL</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">.DL</span> <span class="pre">$102030,</span> <span class="pre">$405060</span></code></p></td>
</tr>
<tr class="row-even"><td><p>ALL</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">.DLM</span> <span class="pre">filtermacro</span> <span class="pre">1,</span> <span class="pre">2,</span> <span class="pre">3</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>ALL</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">.DS</span> <span class="pre">256,</span> <span class="pre">$10</span></code></p></td>
</tr>
<tr class="row-even"><td><p>ALL</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">.DSB</span> <span class="pre">256,</span> <span class="pre">$10</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>ALL</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">.DSD</span> <span class="pre">256,</span> <span class="pre">$1ffffff</span></code></p></td>
</tr>
<tr class="row-even"><td><p>ALL</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">.DSL</span> <span class="pre">16,</span> <span class="pre">$102030</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>ALL</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">.DSTRUCT</span> <span class="pre">waterdrop</span> <span class="pre">INSTANCEOF</span> <span class="pre">water</span> <span class="pre">DATA</span> <span class="pre">&quot;tingle&quot;,</span> <span class="pre">40,</span> <span class="pre">120</span></code></p></td>
</tr>
<tr class="row-even"><td><p>ALL</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">.DSW</span> <span class="pre">128,</span> <span class="pre">20</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>ALL</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">.DW</span> <span class="pre">16000,</span> <span class="pre">10,</span> <span class="pre">255</span></code></p></td>
</tr>
<tr class="row-even"><td><p>ALL</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">.DWCOS</span> <span class="pre">0.2,</span> <span class="pre">10,</span> <span class="pre">3.2,</span> <span class="pre">1024,</span> <span class="pre">1.3</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>ALL</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">.DWM</span> <span class="pre">filtermacro</span> <span class="pre">1,</span> <span class="pre">2,</span> <span class="pre">3</span></code></p></td>
</tr>
<tr class="row-even"><td><p>ALL</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">.DWRND</span> <span class="pre">20,</span> <span class="pre">0,</span> <span class="pre">10</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>ALL</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">.DWSIN</span> <span class="pre">0.2,</span> <span class="pre">10,</span> <span class="pre">3.2,</span> <span class="pre">1024,</span> <span class="pre">1.3</span></code></p></td>
</tr>
<tr class="row-even"><td><p>ALL</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">.ELIF</span> <span class="pre">defined(DEBUG)</span> <span class="pre">&amp;&amp;</span> <span class="pre">VERSION</span> <span class="pre">&gt;</span> <span class="pre">110</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>ALL</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">.ELSE</span></code></p></td>
</tr>
<tr class="row-even"><td><p>ALL</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">.ENDA</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>ALL</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">.ENDASM</span></code></p></td>
</tr>
<tr class="row-even"><td><p>ALL</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">.ENDB</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>ALL</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">.ENDBITS</span></code></p></td>
</tr>
<tr class="row-even"><td><p>ALL</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">.ENDE</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>ALL</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">.ENDIF</span></code></p></td>
</tr>
<tr class="row-even"><td><p>ALL</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">.ENDM</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>ALL</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">.ENDME</span></code></p></td>
</tr>
<tr class="row-even"><td><p>ALL</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">.ENDR</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>ALL</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">.ENDRO</span></code></p></td>
</tr>
<tr class="row-even"><td><p>ALL</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">.ENDS</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>ALL</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">.ENDST</span></code></p></td>
</tr>
<tr class="row-even"><td><p>ALL</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">.ENDU</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>ALL</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">.ENUM</span> <span class="pre">$C000</span></code></p></td>
</tr>
<tr class="row-even"><td><p>ALL</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">.ENUMID</span> <span class="pre">ID_1</span> <span class="pre">0</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>ALL</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">.EQU</span> <span class="pre">IF</span> <span class="pre">$FF0F</span></code></p></td>
</tr>
<tr class="row-even"><td><p>ALL</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">.FAIL</span> <span class="pre">&quot;THE</span> <span class="pre">EYE</span> <span class="pre">OF</span> <span class="pre">MORDOR</span> <span class="pre">HAS</span> <span class="pre">SEEN</span> <span class="pre">US!&quot;</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>ALL</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">.FARADDR</span> <span class="pre">main,</span> <span class="pre">irq_1</span></code></p></td>
</tr>
<tr class="row-even"><td><p>ALL</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">.FCLOSE</span> <span class="pre">FP_DATABIN</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>ALL</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">.FILTER</span> <span class="pre">filtermacro</span> <span class="pre">1,</span> <span class="pre">2,</span> <span class="pre">&quot;encrypt</span> <span class="pre">me&quot;</span></code></p></td>
</tr>
<tr class="row-even"><td><p>ALL</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">.FOPEN</span> <span class="pre">&quot;data.bin&quot;</span> <span class="pre">FP_DATABIN</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>ALL</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">.FREAD</span> <span class="pre">FP_DATABIN</span> <span class="pre">DATA</span></code></p></td>
</tr>
<tr class="row-even"><td><p>ALL</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">.FSEEK</span> <span class="pre">FP_DATABIN</span> <span class="pre">10</span> <span class="pre">START</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>ALL</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">.FSIZE</span> <span class="pre">FP_DATABIN</span> <span class="pre">SIZE</span></code></p></td>
</tr>
<tr class="row-even"><td><p>ALL</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">.FTELL</span> <span class="pre">FP_DATABIN</span> <span class="pre">POSITION</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>ALL</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">.HEX</span> <span class="pre">&quot;a0A0ffDE&quot;</span></code></p></td>
</tr>
<tr class="row-even"><td><p>ALL</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">.IF</span> <span class="pre">DEBUG</span> <span class="pre">==</span> <span class="pre">2</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>ALL</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">.IFDEF</span> <span class="pre">IF</span></code></p></td>
</tr>
<tr class="row-even"><td><p>ALL</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">.IFDEFM</span> <span class="pre">\2</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>ALL</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">.IFEQ</span> <span class="pre">DEBUG</span> <span class="pre">2</span></code></p></td>
</tr>
<tr class="row-even"><td><p>ALL</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">.IFEXISTS</span> <span class="pre">&quot;main.s&quot;</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>ALL</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">.IFGR</span> <span class="pre">DEBUG</span> <span class="pre">2</span></code></p></td>
</tr>
<tr class="row-even"><td><p>ALL</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">.IFGREQ</span> <span class="pre">DEBUG</span> <span class="pre">1</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>ALL</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">.IFLE</span> <span class="pre">DEBUG</span> <span class="pre">2</span></code></p></td>
</tr>
<tr class="row-even"><td><p>ALL</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">.IFLEEQ</span> <span class="pre">DEBUG</span> <span class="pre">1</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>ALL</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">.IFNDEF</span> <span class="pre">IF</span></code></p></td>
</tr>
<tr class="row-even"><td><p>ALL</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">.IFNDEFM</span> <span class="pre">\2</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>ALL</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">.IFNEQ</span> <span class="pre">DEBUG</span> <span class="pre">2</span></code></p></td>
</tr>
<tr class="row-even"><td><p>ALL</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">.INC</span> <span class="pre">&quot;cgb_hardware.i&quot;</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>ALL</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">.INCBIN</span> <span class="pre">&quot;sorority.bin&quot;</span></code></p></td>
</tr>
<tr class="row-even"><td><p>ALL</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">.INCDIR</span> <span class="pre">&quot;/usr/programming/gb/include/&quot;</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>ALL</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">.INCLUDE</span> <span class="pre">&quot;cgb_hardware.i&quot;</span></code></p></td>
</tr>
<tr class="row-even"><td><p>658</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">.INDEX</span> <span class="pre">8</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>ALL</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">.INPUT</span> <span class="pre">NAME</span></code></p></td>
</tr>
<tr class="row-even"><td><p>ALL</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">.LONG</span> <span class="pre">$102030,</span> <span class="pre">$405060</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>ALL</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">.MACRO</span> <span class="pre">TEST</span></code></p></td>
</tr>
<tr class="row-even"><td><p>ALL</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">.MEMORYMAP</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>ALL</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">.NEXTU</span> <span class="pre">name</span></code></p></td>
</tr>
<tr class="row-even"><td><p>658</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">.NOWDC</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>ALL</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">.ORG</span> <span class="pre">$150</span></code></p></td>
</tr>
<tr class="row-even"><td><p>ALL</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">.ORGA</span> <span class="pre">$150</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>ALL</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">.PRINT</span> <span class="pre">&quot;Numbers</span> <span class="pre">1</span> <span class="pre">and</span> <span class="pre">10:</span> <span class="pre">&quot;,</span> <span class="pre">DEC</span> <span class="pre">1,</span> <span class="pre">&quot;</span> <span class="pre">$&quot;,</span> <span class="pre">HEX</span> <span class="pre">10,</span> <span class="pre">&quot;\n&quot;</span></code></p></td>
</tr>
<tr class="row-even"><td><p>ALL</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">.PRINTT</span> <span class="pre">&quot;Here</span> <span class="pre">we</span> <span class="pre">are...\n&quot;</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>ALL</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">.PRINTV</span> <span class="pre">DEC</span> <span class="pre">DEBUG+1</span></code></p></td>
</tr>
<tr class="row-even"><td><p>ALL</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">.RAMSECTION</span> <span class="pre">&quot;Vars&quot;</span> <span class="pre">BANK</span> <span class="pre">0</span> <span class="pre">SLOT</span> <span class="pre">1</span> <span class="pre">ALIGN</span> <span class="pre">256</span> <span class="pre">OFFSET</span> <span class="pre">32</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>ALL</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">.REDEF</span> <span class="pre">IF</span> <span class="pre">$F</span></code></p></td>
</tr>
<tr class="row-even"><td><p>ALL</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">.REDEFINE</span> <span class="pre">IF</span> <span class="pre">$F</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>ALL</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">.REPEAT</span> <span class="pre">6</span></code></p></td>
</tr>
<tr class="row-even"><td><p>ALL</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">.REPT</span> <span class="pre">6</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>ALL</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">.ROMBANKMAP</span></code></p></td>
</tr>
<tr class="row-even"><td><p>ALL</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">.ROMBANKS</span> <span class="pre">2</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>ALL</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">.ROMBANKSIZE</span> <span class="pre">$4000</span></code></p></td>
</tr>
<tr class="row-even"><td><p>ALL</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">.ROW</span> <span class="pre">$ff00,</span> <span class="pre">1,</span> <span class="pre">&quot;3&quot;</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>ALL</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">.SECTION</span> <span class="pre">&quot;Init&quot;</span> <span class="pre">FORCE</span></code></p></td>
</tr>
<tr class="row-even"><td><p>ALL</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">.SEED</span> <span class="pre">123</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>ALL</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">.SHIFT</span></code></p></td>
</tr>
<tr class="row-even"><td><p>ALL</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">.SLOT</span> <span class="pre">1</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>ALL</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">.STRINGMAP</span> <span class="pre">script</span> <span class="pre">&quot;Hello\n&quot;</span></code></p></td>
</tr>
<tr class="row-even"><td><p>ALL</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">.STRINGMAPTABLE</span> <span class="pre">script</span> <span class="pre">&quot;script.tbl&quot;</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>ALL</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">.STRUCT</span> <span class="pre">enemy_object</span></code></p></td>
</tr>
<tr class="row-even"><td><p>ALL</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">.SYM</span> <span class="pre">SAUSAGE</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>ALL</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">.SYMBOL</span> <span class="pre">SAUSAGE</span></code></p></td>
</tr>
<tr class="row-even"><td><p>ALL</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">.TABLE</span> <span class="pre">byte,</span> <span class="pre">word,</span> <span class="pre">byte</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>ALL</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">.UNBACKGROUND</span> <span class="pre">$1000</span> <span class="pre">$1FFF</span></code></p></td>
</tr>
<tr class="row-even"><td><p>ALL</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">.UNDEF</span> <span class="pre">DEBUG</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>ALL</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">.UNDEFINE</span> <span class="pre">DEBUG</span></code></p></td>
</tr>
<tr class="row-even"><td><p>ALL</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">.UNION</span> <span class="pre">name</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>658</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">.WDC</span></code></p></td>
</tr>
<tr class="row-even"><td><p>ALL</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">.WORD</span> <span class="pre">16000,</span> <span class="pre">10,</span> <span class="pre">255</span></code></p></td>
</tr>
</tbody>
</table>
<p>Descriptions:</p>
<section id="bit">
<h2><span class="section-number">2.1. </span><code class="docutils literal notranslate"><span class="pre">.16BIT</span></code><a class="headerlink" href="#bit" title="Permalink to this headline">¶</a></h2>
<p>Analogous to <code class="docutils literal notranslate"><span class="pre">.8BIT</span></code>. <code class="docutils literal notranslate"><span class="pre">.16BIT</span></code> forces all addresses and immediate values to
be expanded into 16-bit range, when possible, that is:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>LSR 11       ; $46 $0B
</pre></div>
</div>
<p>That would be the case, normally, but after <code class="docutils literal notranslate"><span class="pre">.16BIT</span></code> it becomes:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>LSR 11       ; $4E $0B $00
</pre></div>
</div>
<p>This is not a compulsory directive.</p>
</section>
<section id="id1">
<h2><span class="section-number">2.2. </span><code class="docutils literal notranslate"><span class="pre">.24BIT</span></code><a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h2>
<p>Analogous to <code class="docutils literal notranslate"><span class="pre">.8BIT</span></code> and <code class="docutils literal notranslate"><span class="pre">.16BIT</span></code>. <code class="docutils literal notranslate"><span class="pre">.24BIT</span></code> forces all addresses to
be expanded into 24-bit range, when possible, that is:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>AND $11       ; $25 $11
</pre></div>
</div>
<p>That would be the case, normally, but after <code class="docutils literal notranslate"><span class="pre">.24BIT</span></code> it becomes:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>AND $11       ; $2F $11 $00 $00
</pre></div>
</div>
<p>If it is not possible to expand the address into <code class="docutils literal notranslate"><span class="pre">.24BIT</span></code> range,
then WLA tries to expand it into 16-bit range.</p>
<p>This is not a compulsory directive.</p>
</section>
<section id="id2">
<h2><span class="section-number">2.3. </span><code class="docutils literal notranslate"><span class="pre">.8BIT</span></code><a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h2>
<p>There are a few mnemonics that look identical, but take different sized
arguments. Here’s a list of such 6502 mnemonics:</p>
<p>ADC, AND, ASL, BIT, CMP, CPX, CPY, DEC, EOR, INC, LDA, LDX, LDY, ORA, ROL,
SBC, STA, STX and STY.</p>
<p>For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>LSR 11       ; $46 $0B
LSR $A000    ; $4E $00 $A0
</pre></div>
</div>
<p>The first one could also be:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>LSR 11       ; $4E $0B $00
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">.8BIT</span></code> is here to help WLA to decide to choose which one of the opcodes it
selects. When you give <code class="docutils literal notranslate"><span class="pre">.8BIT</span></code> (default) no 8-bit address/value is expanded
to 16-bits.</p>
<p>By default WLA uses the smallest possible size. This is true also when WLA
finds a computation it can’t solve right away. WLA assumes the result will
be inside the smallest possible bounds, which depends on the type of the
mnemonic.</p>
<p>You can also use the fixed argument size versions of such mnemonics by
giving the size with the operand (i.e., operand hinting). Here are few
examples:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>LSR 11.B   ; $46 $0B
LSR 11.W   ; $4E $0B $00
</pre></div>
</div>
<p>In WLA-65816 <code class="docutils literal notranslate"><span class="pre">.ACCU</span></code>/<code class="docutils literal notranslate"><span class="pre">.INDEX</span></code>/<code class="docutils literal notranslate"><span class="pre">SEP</span></code>/<code class="docutils literal notranslate"><span class="pre">REP</span></code> override
<code class="docutils literal notranslate"><span class="pre">.8BIT</span></code>/<code class="docutils literal notranslate"><span class="pre">.16BIT</span></code>/<code class="docutils literal notranslate"><span class="pre">.24BIT</span></code> when considering the immediate values, so be
careful. Still, operand hints override all of these, so use them to be sure.</p>
<p>This is not a compulsory directive.</p>
</section>
<section id="accu-8">
<h2><span class="section-number">2.4. </span><code class="docutils literal notranslate"><span class="pre">.ACCU</span> <span class="pre">8</span></code><a class="headerlink" href="#accu-8" title="Permalink to this headline">¶</a></h2>
<p>Forces WLA to override the accumulator size given with <code class="docutils literal notranslate"><span class="pre">SEP</span></code>/<code class="docutils literal notranslate"><span class="pre">REP</span></code>.
<code class="docutils literal notranslate"><span class="pre">.ACCU</span></code> doesn’t produce any code, it only affects the way WLA interprets the
immediate values (8 for 8 bit operands, 16 for 16 bit operands) for opcodes
dealing with the accumulator.</p>
<p>So after giving <code class="docutils literal notranslate"><span class="pre">.ACCU</span> <span class="pre">8</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">AND</span> <span class="c1">#6</span>
</pre></div>
</div>
<p>will produce <code class="docutils literal notranslate"><span class="pre">$29</span> <span class="pre">$06</span></code>, and after giving <code class="docutils literal notranslate"><span class="pre">.ACCU</span> <span class="pre">16</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">AND</span> <span class="c1">#6</span>
</pre></div>
</div>
<p>will yield <code class="docutils literal notranslate"><span class="pre">$29</span> <span class="pre">$00</span> <span class="pre">$06</span></code>.</p>
<p>Note that <code class="docutils literal notranslate"><span class="pre">SEP</span></code>/<code class="docutils literal notranslate"><span class="pre">REP</span></code> again will in turn reset the accumulator/index
register size.</p>
<p>This is not a compulsory directive.</p>
</section>
<section id="addr-16000-main-255">
<h2><span class="section-number">2.5. </span><code class="docutils literal notranslate"><span class="pre">.ADDR</span> <span class="pre">16000,</span> <span class="pre">main,</span> <span class="pre">255</span></code><a class="headerlink" href="#addr-16000-main-255" title="Permalink to this headline">¶</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">.ADDR</span></code> is an alias for <code class="docutils literal notranslate"><span class="pre">.DW</span></code>.</p>
<p>This is not a compulsory directive.</p>
</section>
<section id="arraydb-name-myarray-indices-0-0-1">
<h2><span class="section-number">2.6. </span><code class="docutils literal notranslate"><span class="pre">.ARRAYDB</span> <span class="pre">NAME</span> <span class="pre">MyArray</span> <span class="pre">INDICES</span> <span class="pre">'0',</span> <span class="pre">0,</span> <span class="pre">1</span></code><a class="headerlink" href="#arraydb-name-myarray-indices-0-0-1" title="Permalink to this headline">¶</a></h2>
<p>This is the same as <code class="docutils literal notranslate"><span class="pre">.DB</span></code>, but defines bytes by reading indexed values from
the given array. In the example the indices are ‘0’ (48), 0 and 1.</p>
<p><code class="docutils literal notranslate"><span class="pre">NAME</span></code> and <code class="docutils literal notranslate"><span class="pre">INDICES</span></code> are optional so this works also:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">.</span><span class="n">ARRAYDB</span> <span class="n">MyArray</span> <span class="s1">&#39;0&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span>
</pre></div>
</div>
<p>If you supply <code class="docutils literal notranslate"><span class="pre">.ARRAYDB</span></code> a string as indices, each character is used as an index:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">.</span><span class="n">ARRAYDB</span> <span class="n">NAME</span> <span class="n">MyArray</span> <span class="n">INDICES</span> <span class="s2">&quot;MAP THIS!&quot;</span>
</pre></div>
</div>
<p>This is not a compulsory directive.</p>
</section>
<section id="arraydd-name-myarray-indices-0-0-1">
<h2><span class="section-number">2.7. </span><code class="docutils literal notranslate"><span class="pre">.ARRAYDD</span> <span class="pre">NAME</span> <span class="pre">MyArray</span> <span class="pre">INDICES</span> <span class="pre">'0',</span> <span class="pre">0,</span> <span class="pre">1</span></code><a class="headerlink" href="#arraydd-name-myarray-indices-0-0-1" title="Permalink to this headline">¶</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">.ARRAYDD</span></code> works the same way as <code class="docutils literal notranslate"><span class="pre">.ARRAYDB</span></code>, but defines 32-bit double words.</p>
<p>This is not a compulsory directive.</p>
</section>
<section id="arraydef-name-myarray-size-256">
<h2><span class="section-number">2.8. </span><code class="docutils literal notranslate"><span class="pre">.ARRAYDEF</span> <span class="pre">NAME</span> <span class="pre">MyArray</span> <span class="pre">SIZE</span> <span class="pre">256</span></code><a class="headerlink" href="#arraydef-name-myarray-size-256" title="Permalink to this headline">¶</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">.ARRAYDEF</span></code> is an alias for <code class="docutils literal notranslate"><span class="pre">.ARRAYDEFINE</span></code>.</p>
<p>This is not a compulsory directive.</p>
</section>
<section id="arraydefine-name-myarray-size-256">
<h2><span class="section-number">2.9. </span><code class="docutils literal notranslate"><span class="pre">.ARRAYDEFINE</span> <span class="pre">NAME</span> <span class="pre">MyArray</span> <span class="pre">SIZE</span> <span class="pre">256</span></code><a class="headerlink" href="#arraydefine-name-myarray-size-256" title="Permalink to this headline">¶</a></h2>
<p>Defines an array called MyArray, and its initial size is 256 items. Each
item is an ANSI C89 int (32-bit). The array can be written into using
directive <code class="docutils literal notranslate"><span class="pre">.ARRAYIN</span></code> and it can be read from using directive
<code class="docutils literal notranslate"><span class="pre">.ARRAYOUT</span></code>. This array exists only in WLA’s memory and during
assembling, but it can be used for e.g., mapping parts of ASCII table
into e.g., 4 bits:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>// define a too small array for mapping &quot;0123456789&quot; -&gt; 4-bits
// it gets enlarged by out-of-bounds .ARRAYINs later...
.ARRAYDEFINE NAME MyArray SIZE 4

// define the mapping
.ARRAYIN NAME MyArray INDEX &#39;0&#39; VALUE %0000
.ARRAYIN NAME MyArray INDEX &#39;1&#39; VALUE %0001
.ARRAYIN NAME MyArray INDEX &#39;2&#39; VALUE %0010
.ARRAYIN NAME MyArray INDEX &#39;3&#39; VALUE %0011
.ARRAYIN NAME MyArray INDEX &#39;4&#39; VALUE %0100
.ARRAYIN NAME MyArray INDEX &#39;5&#39; VALUE %0101
.ARRAYIN NAME MyArray INDEX &#39;6&#39; VALUE %0110
.ARRAYIN NAME MyArray INDEX &#39;7&#39; VALUE %0111
.ARRAYIN NAME MyArray INDEX &#39;8&#39; VALUE %1000
.ARRAYIN NAME MyArray INDEX &#39;9&#39; VALUE %1001

// map!
.ARRAYOUT NAME MyArray INDEX &#39;6&#39; DEFINITION Mapping
.DB Mapping
.ARRAYOUT NAME MyArray INDEX &#39;6&#39; DEFINITION Mapping
.DB Mapping
.ARRAYOUT NAME MyArray INDEX &#39;8&#39; DEFINITION Mapping
.DB Mapping
.ARRAYOUT NAME MyArray INDEX &#39;2&#39; DEFINITION Mapping
.DB Mapping
.ARRAYOUT NAME MyArray INDEX &#39;7&#39; DEFINITION Mapping
.DB Mapping
.ARRAYOUT NAME MyArray INDEX &#39;5&#39; DEFINITION Mapping
.DB Mapping
</pre></div>
</div>
<p>You can also do the mapping using e.g., <code class="docutils literal notranslate"><span class="pre">.ARRAYDB</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">.</span><span class="n">ARRAYDB</span> <span class="n">NAME</span> <span class="n">MyArray</span> <span class="n">INDICES</span> <span class="s1">&#39;6&#39;</span><span class="p">,</span> <span class="s1">&#39;6&#39;</span><span class="p">,</span> <span class="s1">&#39;8&#39;</span><span class="p">,</span> <span class="s1">&#39;2&#39;</span><span class="p">,</span> <span class="s1">&#39;7&#39;</span><span class="p">,</span> <span class="s1">&#39;5&#39;</span>
<span class="o">.</span><span class="n">ARRAYDB</span> <span class="n">NAME</span> <span class="n">MyArray</span> <span class="n">INDICES</span> <span class="s2">&quot;668275&quot;</span>
</pre></div>
</div>
<p>And create the mapping using only one <code class="docutils literal notranslate"><span class="pre">.ARRAYIN</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">.</span><span class="n">ARRAYIN</span> <span class="n">NAME</span> <span class="n">MyArray</span> <span class="n">INDEX</span> <span class="s1">&#39;0&#39;</span> <span class="n">VALUES</span> <span class="o">%</span><span class="mi">0000</span><span class="p">,</span> <span class="o">%</span><span class="mi">0001</span><span class="p">,</span> \
    <span class="o">%</span><span class="mi">0010</span><span class="p">,</span> <span class="o">%</span><span class="mi">0011</span><span class="p">,</span> <span class="o">%</span><span class="mi">0100</span><span class="p">,</span> <span class="o">%</span><span class="mi">0101</span><span class="p">,</span> <span class="o">%</span><span class="mi">0110</span><span class="p">,</span> <span class="o">%</span><span class="mi">0111</span><span class="p">,</span> <span class="o">%</span><span class="mi">1000</span><span class="p">,</span> \
    <span class="o">%</span><span class="mi">1001</span>
</pre></div>
</div>
<p>Note that keywords NAME and SIZE are optional, so this works also:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">.</span><span class="n">ARRAYDEFINE</span> <span class="n">MyArray</span> <span class="mi">4</span>
</pre></div>
</div>
<p>This is not a compulsory directive.</p>
</section>
<section id="arraydl-name-myarray-indices-0-0-1">
<h2><span class="section-number">2.10. </span><code class="docutils literal notranslate"><span class="pre">.ARRAYDL</span> <span class="pre">NAME</span> <span class="pre">MyArray</span> <span class="pre">INDICES</span> <span class="pre">'0',</span> <span class="pre">0,</span> <span class="pre">1</span></code><a class="headerlink" href="#arraydl-name-myarray-indices-0-0-1" title="Permalink to this headline">¶</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">.ARRAYDL</span></code> works the same way as <code class="docutils literal notranslate"><span class="pre">.ARRAYDB</span></code>, but defines 24-bit long words.</p>
<p>This is not a compulsory directive.</p>
</section>
<section id="arraydw-name-myarray-indices-0-0-1">
<h2><span class="section-number">2.11. </span><code class="docutils literal notranslate"><span class="pre">.ARRAYDW</span> <span class="pre">NAME</span> <span class="pre">MyArray</span> <span class="pre">INDICES</span> <span class="pre">'0',</span> <span class="pre">0,</span> <span class="pre">1</span></code><a class="headerlink" href="#arraydw-name-myarray-indices-0-0-1" title="Permalink to this headline">¶</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">.ARRAYDW</span></code> works the same way as <code class="docutils literal notranslate"><span class="pre">.ARRAYDB</span></code>, but defines 16-bit words.</p>
<p>This is not a compulsory directive.</p>
</section>
<section id="arrayin-name-myarray-index-0-value-10">
<h2><span class="section-number">2.12. </span><code class="docutils literal notranslate"><span class="pre">.ARRAYIN</span> <span class="pre">NAME</span> <span class="pre">MyArray</span> <span class="pre">INDEX</span> <span class="pre">0</span> <span class="pre">VALUE</span> <span class="pre">10</span></code><a class="headerlink" href="#arrayin-name-myarray-index-0-value-10" title="Permalink to this headline">¶</a></h2>
<p>Writes a value into an array defined using <code class="docutils literal notranslate"><span class="pre">.ARRAYDEFINE</span></code>. Check out
<code class="docutils literal notranslate"><span class="pre">.ARRAYDEFINE</span></code> for a nice example. The value needs to be known at the
time the assembler is parsing through the code.</p>
<p>Keywords NAME, INDEX and VALUE are optional so this works also:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">.</span><span class="n">ARRAYIN</span> <span class="n">MyArray</span> <span class="mi">0</span> <span class="mi">10</span>
</pre></div>
</div>
<p>This is not a compulsory directive.</p>
</section>
<section id="arrayout-name-myarray-index-0-definition-arrayout">
<h2><span class="section-number">2.13. </span><code class="docutils literal notranslate"><span class="pre">.ARRAYOUT</span> <span class="pre">NAME</span> <span class="pre">MyArray</span> <span class="pre">INDEX</span> <span class="pre">0</span> <span class="pre">DEFINITION</span> <span class="pre">ArrayOut</span></code><a class="headerlink" href="#arrayout-name-myarray-index-0-definition-arrayout" title="Permalink to this headline">¶</a></h2>
<p>Reads a value from an array defined using <code class="docutils literal notranslate"><span class="pre">.ARRAYDEFINE</span></code>. Check out
<code class="docutils literal notranslate"><span class="pre">.ARRAYDEFINE</span></code> for a nice example. The value is stored in definition
<code class="docutils literal notranslate"><span class="pre">ArrayOut</span></code> in the example.</p>
<p>Keywords NAME, INDEX and DEFINITION are optional so this works also:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">.</span><span class="n">ARRAYOUT</span> <span class="n">MyArray</span> <span class="mi">0</span> <span class="n">ArrayOut</span>
</pre></div>
</div>
<p>This is not a compulsory directive.</p>
</section>
<section id="asc-hello-world">
<h2><span class="section-number">2.14. </span><code class="docutils literal notranslate"><span class="pre">.ASC</span> <span class="pre">&quot;HELLO</span> <span class="pre">WORLD!&quot;</span></code><a class="headerlink" href="#asc-hello-world" title="Permalink to this headline">¶</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">.ASC</span></code> is an alias for <code class="docutils literal notranslate"><span class="pre">.DB</span></code>, but if you use <code class="docutils literal notranslate"><span class="pre">.ASC</span></code> it will remap
the characters using the mapping given via <code class="docutils literal notranslate"><span class="pre">.ASCIITABLE</span></code>.</p>
<p>You can also use ASC(‘?’) to map individual characters in the code</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">.</span><span class="n">DB</span> <span class="n">ASC</span><span class="p">(</span><span class="s1">&#39;A&#39;</span><span class="p">),</span> <span class="n">ASC</span><span class="p">(</span><span class="s1">&#39;B&#39;</span><span class="p">),</span> <span class="n">ASC</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span> <span class="n">ASC</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\r</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>and</p>
<blockquote>
<div><p>LD A, ASC(‘A’)</p>
</div></blockquote>
<p>This is not a compulsory directive.</p>
</section>
<section id="asciitable">
<h2><span class="section-number">2.15. </span><code class="docutils literal notranslate"><span class="pre">.ASCIITABLE</span></code><a class="headerlink" href="#asciitable" title="Permalink to this headline">¶</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">.ASCIITABLE</span></code>’s only purpose is to provide character mapping for <code class="docutils literal notranslate"><span class="pre">.ASC</span></code>
and <code class="docutils literal notranslate"><span class="pre">ASC('?')</span></code>. Take a look at the example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">.</span><span class="n">ASCIITABLE</span>
<span class="n">MAP</span> <span class="s2">&quot;A&quot;</span> <span class="n">TO</span> <span class="s2">&quot;Z&quot;</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">MAP</span> <span class="s2">&quot;!&quot;</span> <span class="o">=</span> <span class="mi">90</span>
<span class="o">.</span><span class="n">ENDA</span>
</pre></div>
</div>
<p>Here we set such a mapping that character <code class="docutils literal notranslate"><span class="pre">A</span></code> is equal to <code class="docutils literal notranslate"><span class="pre">0</span></code>, <code class="docutils literal notranslate"><span class="pre">B</span></code> is
equal to <code class="docutils literal notranslate"><span class="pre">1</span></code>, <code class="docutils literal notranslate"><span class="pre">C</span></code> is equal to <code class="docutils literal notranslate"><span class="pre">2</span></code>, and so on, and <code class="docutils literal notranslate"><span class="pre">!</span></code> is equal
to <code class="docutils literal notranslate"><span class="pre">90</span></code>.</p>
<p>After you’ve given the <code class="docutils literal notranslate"><span class="pre">.ASCIITABLE</span></code>, use <code class="docutils literal notranslate"><span class="pre">.ASC</span></code> to define bytes using
this mapping (<code class="docutils literal notranslate"><span class="pre">.ASC</span></code> is an alias for <code class="docutils literal notranslate"><span class="pre">.DB</span></code>, but with <code class="docutils literal notranslate"><span class="pre">.ASCIITABLE</span></code>
mapping). For example, <code class="docutils literal notranslate"><span class="pre">.ASC</span> <span class="pre">&quot;ABZ&quot;</span></code> would define bytes <code class="docutils literal notranslate"><span class="pre">0</span></code>, <code class="docutils literal notranslate"><span class="pre">1</span></code> and
<code class="docutils literal notranslate"><span class="pre">25</span></code> in our previous example.</p>
<p>Note that the following works as well:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">.</span><span class="n">ASCIITABLE</span>
<span class="n">MAP</span> <span class="s1">&#39;A&#39;</span> <span class="n">TO</span> <span class="s1">&#39;Z&#39;</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">MAP</span> <span class="mi">65</span> <span class="o">=</span> <span class="mi">90</span>          <span class="p">;</span> <span class="mi">65</span> <span class="ow">is</span> <span class="n">the</span> <span class="n">decimal</span> <span class="k">for</span> <span class="n">ASCII</span> <span class="s1">&#39;A&#39;</span>
<span class="o">.</span><span class="n">ENDA</span>
</pre></div>
</div>
<p>Also note that the characters that are not given any mapping in
<code class="docutils literal notranslate"><span class="pre">.ASCIITABLE</span></code> map to themselves (i.e., <code class="docutils literal notranslate"><span class="pre">2</span></code> maps to <code class="docutils literal notranslate"><span class="pre">2</span></code> in our previous
example, etc.).</p>
<p>This is not a compulsory directive.</p>
</section>
<section id="ascstr-hello-world-a">
<h2><span class="section-number">2.16. </span><code class="docutils literal notranslate"><span class="pre">.ASCSTR</span> <span class="pre">&quot;HELLO</span> <span class="pre">WORLD!&quot;,</span> <span class="pre">$A</span></code><a class="headerlink" href="#ascstr-hello-world-a" title="Permalink to this headline">¶</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">.ASCSTR</span></code> is the same as <code class="docutils literal notranslate"><span class="pre">.ASC</span></code>, but it maps only supplied strings. All given
bytes are not touched.:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>.ASCSTR &quot;HELLO WORLD!&quot;, $A
</pre></div>
</div>
<p>In this example the string “HELLO WORLD!” is mapped using the mapping given via
<code class="docutils literal notranslate"><span class="pre">.ASCIITABLE</span></code>, but the last byte $A is left as it is.</p>
<p>This is not a compulsory directive.</p>
</section>
<section id="asctable">
<h2><span class="section-number">2.17. </span><code class="docutils literal notranslate"><span class="pre">.ASCTABLE</span></code><a class="headerlink" href="#asctable" title="Permalink to this headline">¶</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">.ASCTABLE</span></code> is an alias for <code class="docutils literal notranslate"><span class="pre">.ASCIITABLE</span></code>.</p>
<p>This is not a compulsory directive.</p>
</section>
<section id="asm">
<h2><span class="section-number">2.18. </span><code class="docutils literal notranslate"><span class="pre">.ASM</span></code><a class="headerlink" href="#asm" title="Permalink to this headline">¶</a></h2>
<p>Tells WLA to start assembling. Use <code class="docutils literal notranslate"><span class="pre">.ASM</span></code> to continue the work which has been
disabled with <code class="docutils literal notranslate"><span class="pre">.ENDASM</span></code>. <code class="docutils literal notranslate"><span class="pre">.ASM</span></code> and <code class="docutils literal notranslate"><span class="pre">.ENDASM</span></code> can be used to mask away
big blocks of code. This is analogous to the ANSI C -comments (<code class="docutils literal notranslate"><span class="pre">/*...*/</span></code>),
but <code class="docutils literal notranslate"><span class="pre">.ASM</span></code> and <code class="docutils literal notranslate"><span class="pre">.ENDASM</span></code> can be nested, unlike the ANSI C -counterpart.</p>
<p>This is not a compulsory directive.</p>
</section>
<section id="background-parallax-gb">
<h2><span class="section-number">2.19. </span><code class="docutils literal notranslate"><span class="pre">.BACKGROUND</span> <span class="pre">&quot;parallax.gb&quot;</span></code><a class="headerlink" href="#background-parallax-gb" title="Permalink to this headline">¶</a></h2>
<p>This chooses an existing ROM image (<code class="docutils literal notranslate"><span class="pre">parallax.gb</span></code> in this case) as a
background data for the project. You can overwrite the data with <code class="docutils literal notranslate"><span class="pre">OVERWRITE</span></code>
sections only, unless you first clear memory blocks with <code class="docutils literal notranslate"><span class="pre">.UNBACKGROUND</span></code>
after which there’s room for other sections as well.</p>
<p>Note that <code class="docutils literal notranslate"><span class="pre">.BACKGROUND</span></code> can be used only when compiling an object file.</p>
<p><code class="docutils literal notranslate"><span class="pre">.BACKGROUND</span></code> is useful if you wish to patch an existing ROM image with
new code or data.</p>
<p>This is not a compulsory directive.</p>
</section>
<section id="bank-0-slot-1">
<h2><span class="section-number">2.20. </span><code class="docutils literal notranslate"><span class="pre">.BANK</span> <span class="pre">0</span> <span class="pre">SLOT</span> <span class="pre">1</span></code><a class="headerlink" href="#bank-0-slot-1" title="Permalink to this headline">¶</a></h2>
<p>Defines the ROM bank and the slot it is inserted into in the memory. You
can also type the following:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">.</span><span class="n">BANK</span> <span class="mi">0</span>
</pre></div>
</div>
<p>This tells WLA to move into BANK 0 which will be put into the <code class="docutils literal notranslate"><span class="pre">DEFAULTSLOT</span></code>
of <code class="docutils literal notranslate"><span class="pre">.MEMORYMAP</span></code>.</p>
<p>Every time you use <code class="docutils literal notranslate"><span class="pre">.BANK</span></code>, supply <code class="docutils literal notranslate"><span class="pre">.ORG</span></code>/<code class="docutils literal notranslate"><span class="pre">.ORGA</span></code> as well, just to make
sure WLA calculates addresses correctly.</p>
<p>This is a compulsory directive.</p>
</section>
<section id="base-80">
<h2><span class="section-number">2.21. </span><code class="docutils literal notranslate"><span class="pre">.BASE</span> <span class="pre">$80</span></code><a class="headerlink" href="#base-80" title="Permalink to this headline">¶</a></h2>
<p>Defines the base value for the bank number (used only in 24-bit addresses and
when getting a label’s bank number with <code class="docutils literal notranslate"><span class="pre">:</span></code>). Here are few examples of how
to use <code class="docutils literal notranslate"><span class="pre">.BASE</span></code> (both examples assume the label resides in the first ROM
bank):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>.BASE $00
label1:
.BASE $80
label2:

  JSL label1   ; if label1 address is $1234, this will assemble into
               ; JSL $001234
  JSL label2   ; label2 is also $1234, but this time the result will be
               ; JSL $801234
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">.BASE</span></code> defaults to <code class="docutils literal notranslate"><span class="pre">$00</span></code>. Note that the address of the label will also
contribute to the bank number (bank number == <code class="docutils literal notranslate"><span class="pre">.BASE</span></code> + ROM bank of the
label).</p>
<p>On 65816, use <code class="docutils literal notranslate"><span class="pre">.LOROM</span></code>, <code class="docutils literal notranslate"><span class="pre">.HIROM</span></code> or <code class="docutils literal notranslate"><span class="pre">.EXHIROM</span></code> to define the ROM mode.</p>
<p>This is not a compulsory directive.</p>
</section>
<section id="bits-4-data-1011-0100-1010-0101">
<h2><span class="section-number">2.22. </span><code class="docutils literal notranslate"><span class="pre">.BITS</span> <span class="pre">4</span> <span class="pre">DATA</span> <span class="pre">%1011,</span> <span class="pre">%0100,</span> <span class="pre">%1010,</span> <span class="pre">%0101</span></code><a class="headerlink" href="#bits-4-data-1011-0100-1010-0101" title="Permalink to this headline">¶</a></h2>
<p>This is the same as <code class="docutils literal notranslate"><span class="pre">.DB</span></code>, but defines bits (1-32). Consecutive <code class="docutils literal notranslate"><span class="pre">.BITS</span></code>
will supply bits to the same bitstream, so don’t do any stream breaking
<code class="docutils literal notranslate"><span class="pre">.DB</span></code> calls or anything that defines data. <code class="docutils literal notranslate"><span class="pre">DATA</span></code> is optional. Give</p>
<blockquote>
<div><p>.BITS START</p>
</div></blockquote>
<p>to start a new bitstream.</p>
<p>Here’s an example of how to define two bytes worth of bits:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">.</span><span class="n">BITS</span> <span class="mi">6</span> <span class="n">CABBAGE</span><span class="p">,</span> <span class="o">%</span><span class="mi">011110</span>    <span class="p">;</span> <span class="n">CABBAGE</span> <span class="o">==</span> <span class="o">%</span><span class="mi">110011</span>
<span class="o">.</span><span class="n">BITS</span> <span class="mi">4</span> <span class="mi">8</span><span class="o">+</span><span class="mi">2</span>                 <span class="p">;</span> <span class="mi">8</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">==</span> <span class="o">%</span><span class="mi">1010</span>
<span class="o">.</span><span class="n">BITS</span> <span class="mi">4</span> <span class="o">%</span><span class="mi">1011</span>
<span class="o">.</span><span class="n">ENDBITS</span>                    <span class="p">;</span> <span class="n">writes</span> <span class="n">the</span> <span class="n">final</span> <span class="n">byte</span> <span class="ow">in</span> <span class="n">the</span> <span class="n">bitstream</span>
                            <span class="p">;</span> <span class="ow">and</span> <span class="n">resets</span> <span class="n">the</span> <span class="n">counters</span>
</pre></div>
</div>
<p>If your <code class="docutils literal notranslate"><span class="pre">.BITS</span></code> bitstream doesn’t define exactly a multiple of 8 bits,
the remaining bits are set to zero. Remember to issue <code class="docutils literal notranslate"><span class="pre">.ENDBITS</span></code> after
the last <code class="docutils literal notranslate"><span class="pre">.BITS</span></code>.</p>
<p>Currently the bits are written from most significant bit to the least
significant bit, so our previous example would give us (consecutive) bytes
%11001101, %11101010 and %10110000 ($CD, $EA and $B0).</p>
<p>This is not a compulsory directive.</p>
</section>
<section id="block-block1">
<h2><span class="section-number">2.23. </span><code class="docutils literal notranslate"><span class="pre">.BLOCK</span> <span class="pre">&quot;Block1&quot;</span></code><a class="headerlink" href="#block-block1" title="Permalink to this headline">¶</a></h2>
<p>Begins a block (called <code class="docutils literal notranslate"><span class="pre">Block1</span></code> in the example). These blocks have only
one function: to display the number of bytes they contain. When you
embed such a block into your code, WLA displays its size when it assembles
the source file.</p>
<p>Use <code class="docutils literal notranslate"><span class="pre">.ENDB</span></code> to terminate a <code class="docutils literal notranslate"><span class="pre">.BLOCK</span></code>. Note that you can nest <code class="docutils literal notranslate"><span class="pre">.BLOCK</span></code> s.</p>
<p>This is not a compulsory directive.</p>
</section>
<section id="breakpoint">
<h2><span class="section-number">2.24. </span><code class="docutils literal notranslate"><span class="pre">.BREAKPOINT</span></code><a class="headerlink" href="#breakpoint" title="Permalink to this headline">¶</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">.BREAKPOINT</span></code> is an alias for <code class="docutils literal notranslate"><span class="pre">.BR</span></code>.</p>
<p>This is not a compulsory directive.</p>
</section>
<section id="br">
<h2><span class="section-number">2.25. </span><code class="docutils literal notranslate"><span class="pre">.BR</span></code><a class="headerlink" href="#br" title="Permalink to this headline">¶</a></h2>
<p>Inserts a breakpoint that behaves like a <code class="docutils literal notranslate"><span class="pre">.SYM</span></code> without a name. Breakpoints
can only be seen in WLALINK’s symbol file.</p>
<p>This is not a compulsory directive.</p>
</section>
<section id="byt-100-30-1000-hello-world">
<h2><span class="section-number">2.26. </span><code class="docutils literal notranslate"><span class="pre">.BYT</span> <span class="pre">100,</span> <span class="pre">$30,</span> <span class="pre">%1000,</span> <span class="pre">&quot;HELLO</span> <span class="pre">WORLD!&quot;</span></code><a class="headerlink" href="#byt-100-30-1000-hello-world" title="Permalink to this headline">¶</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">.BYT</span></code> is an alias for <code class="docutils literal notranslate"><span class="pre">.DB</span></code>.</p>
<p>This is not a compulsory directive.</p>
</section>
<section id="cartridgetype-1">
<h2><span class="section-number">2.27. </span><code class="docutils literal notranslate"><span class="pre">.CARTRIDGETYPE</span> <span class="pre">1</span></code><a class="headerlink" href="#cartridgetype-1" title="Permalink to this headline">¶</a></h2>
<p>Indicates the type of the cartridge (mapper and so on). This is a standard
Gameboy cartridge type indicator value found at <code class="docutils literal notranslate"><span class="pre">$147</span></code> in a Gameboy ROM, and
there this one is put to also.</p>
<p>This is not a compulsory directive.</p>
</section>
<section id="computegbchecksum">
<h2><span class="section-number">2.28. </span><code class="docutils literal notranslate"><span class="pre">.COMPUTEGBCHECKSUM</span></code><a class="headerlink" href="#computegbchecksum" title="Permalink to this headline">¶</a></h2>
<p>When this directive is used WLA computes the ROM checksum found at <code class="docutils literal notranslate"><span class="pre">$14E</span></code> and
<code class="docutils literal notranslate"><span class="pre">$14F</span></code> in a Gameboy ROM. Note that this directive can only be used with
WLA-GB.</p>
<p>Note that you can also write <code class="docutils literal notranslate"><span class="pre">.COMPUTECHECKSUM</span></code> (the old name for this
directive), but it’s not recommended.</p>
<p>This is not a compulsory directive.</p>
</section>
<section id="computegbcomplementcheck">
<h2><span class="section-number">2.29. </span><code class="docutils literal notranslate"><span class="pre">.COMPUTEGBCOMPLEMENTCHECK</span></code><a class="headerlink" href="#computegbcomplementcheck" title="Permalink to this headline">¶</a></h2>
<p>When this directive is used WLA computes the ROM complement check found at
<code class="docutils literal notranslate"><span class="pre">$14D</span></code> in a Gameboy ROM.</p>
<p>Note that you can still use <code class="docutils literal notranslate"><span class="pre">.COMPUTECOMPLEMENTCHECK</span></code> (the old name for this
directive), but it’s not recommended.</p>
<p>This is not a compulsory directive.</p>
</section>
<section id="computesmschecksum">
<h2><span class="section-number">2.30. </span><code class="docutils literal notranslate"><span class="pre">.COMPUTESMSCHECKSUM</span></code><a class="headerlink" href="#computesmschecksum" title="Permalink to this headline">¶</a></h2>
<p>When this directive is used WLA computes the ROM checksum found at <code class="docutils literal notranslate"><span class="pre">$7FFA</span></code>
and <code class="docutils literal notranslate"><span class="pre">$7FFB</span></code> (or <code class="docutils literal notranslate"><span class="pre">$3FFA</span></code> - <code class="docutils literal notranslate"><span class="pre">$3FFB</span></code> is the ROM is 16KBs, or
<code class="docutils literal notranslate"><span class="pre">$1FFA</span></code> - <code class="docutils literal notranslate"><span class="pre">$1FFB</span></code> for 8KB ROMs) in a SMS/GG ROM. Note that this directive
can only be used with WLA-z80. Also note that the ROM size must be at least
8KBs. The checksum is calculated using bytes
<code class="docutils literal notranslate"><span class="pre">0x0000</span></code> - <code class="docutils literal notranslate"><span class="pre">0x1FEF</span></code>/<code class="docutils literal notranslate"><span class="pre">0x3FEF</span></code>/<code class="docutils literal notranslate"><span class="pre">0x7FEF</span></code>.</p>
<p>This is not a compulsory directive.</p>
</section>
<section id="computesneschecksum">
<h2><span class="section-number">2.31. </span><code class="docutils literal notranslate"><span class="pre">.COMPUTESNESCHECKSUM</span></code><a class="headerlink" href="#computesneschecksum" title="Permalink to this headline">¶</a></h2>
<p>When this directive is used WLA computes the SNES ROM checksum and
inverse checksum found at <code class="docutils literal notranslate"><span class="pre">$7FDC</span></code> - <code class="docutils literal notranslate"><span class="pre">$7FDF</span></code> (LoROM), <code class="docutils literal notranslate"><span class="pre">$FFDC</span></code> - <code class="docutils literal notranslate"><span class="pre">$FFDF</span></code>
(HiROM) or <code class="docutils literal notranslate"><span class="pre">$40FFDC</span></code> - <code class="docutils literal notranslate"><span class="pre">$40FFDF</span></code> and <code class="docutils literal notranslate"><span class="pre">$FFDC</span></code> - <code class="docutils literal notranslate"><span class="pre">$FFDF</span></code> (ExHiROM).
Note that this directive can only be used with WLA-65816. Also note
that the ROM size must be at least 32KB for LoROM images, 64KB for
HiROM images and 32.5MBit for ExHiROM.</p>
<p><code class="docutils literal notranslate"><span class="pre">.LOROM</span></code>, <code class="docutils literal notranslate"><span class="pre">.HIROM</span></code> or <code class="docutils literal notranslate"><span class="pre">.EXHIROM</span></code> must be issued before <code class="docutils literal notranslate"><span class="pre">.COMPUTESNESCHECKSUM</span></code>.</p>
<p>This is not a compulsory directive.</p>
</section>
<section id="countrycode-1">
<h2><span class="section-number">2.32. </span><code class="docutils literal notranslate"><span class="pre">.COUNTRYCODE</span> <span class="pre">1</span></code><a class="headerlink" href="#countrycode-1" title="Permalink to this headline">¶</a></h2>
<p>Indicates the country code located at <code class="docutils literal notranslate"><span class="pre">$14A</span></code> of a Gameboy ROM.</p>
<p>This is not a compulsory directive.</p>
</section>
<section id="data-ff00-2">
<h2><span class="section-number">2.33. </span><code class="docutils literal notranslate"><span class="pre">.DATA</span> <span class="pre">$ff00,</span> <span class="pre">2</span></code><a class="headerlink" href="#data-ff00-2" title="Permalink to this headline">¶</a></h2>
<p>Defines bytes after a .TABLE has been used to define the format.
An alternative way of defining bytes to .DB/.DW.</p>
<p>Note that when you use .DATA you can give as many items .TABLE
defines. The next time you’ll use .DATA you’ll continue from
the point the previous .DATA ended.</p>
<p>Examples:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">.</span><span class="n">TABLE</span> <span class="n">dsw</span> <span class="mi">2</span><span class="p">,</span> <span class="n">dsb</span> <span class="mi">2</span>
</pre></div>
</div>
<p>This defines two rows worth of bytes:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>.DATA $ff00, $aabb, $10, $20, $1020, $3040, $50, $60
</pre></div>
</div>
<p>This does the same:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>.DATA $ff00, $aabb
.DATA $10, $20
.DATA $1020, $3040
.DATA $50, $60
</pre></div>
</div>
<p>This is not a compulsory directive.</p>
</section>
<section id="db-100-30-1000-hello-world">
<h2><span class="section-number">2.34. </span><code class="docutils literal notranslate"><span class="pre">.DB</span> <span class="pre">100,</span> <span class="pre">$30,</span> <span class="pre">%1000,</span> <span class="pre">&quot;HELLO</span> <span class="pre">WORLD!&quot;</span></code><a class="headerlink" href="#db-100-30-1000-hello-world" title="Permalink to this headline">¶</a></h2>
<p>Defines bytes.</p>
<p>This is not a compulsory directive.</p>
</section>
<section id="dbcos-0-2-10-3-2-120-1-3">
<h2><span class="section-number">2.35. </span><code class="docutils literal notranslate"><span class="pre">.DBCOS</span> <span class="pre">0.2,</span> <span class="pre">10,</span> <span class="pre">3.2,</span> <span class="pre">120,</span> <span class="pre">1.3</span></code><a class="headerlink" href="#dbcos-0-2-10-3-2-120-1-3" title="Permalink to this headline">¶</a></h2>
<p>Defines bytes just like <code class="docutils literal notranslate"><span class="pre">.DSB</span></code> does, only this time they are filled with
cosine data. <code class="docutils literal notranslate"><span class="pre">.DBCOS</span></code> takes five arguments.</p>
<p>The first argument is the starting angle. Angle value ranges from <code class="docutils literal notranslate"><span class="pre">0</span></code> to
<code class="docutils literal notranslate"><span class="pre">359.999</span></code>…, but you can supply WLA with values that are out of the range -
WLA fixes them ok. The value can be integer or float.</p>
<p>The second argument descibes the amount of additional angles. The example
will define 11 angles.</p>
<p>The third argument is the adder value which is added to the angle value when
next angle is calculated. The value can be integer or float.</p>
<p>The fourth and fifth arguments can be seen from the pseudo code below, which
also describes how <code class="docutils literal notranslate"><span class="pre">.DBCOS</span></code> works. The values can be integer or float.</p>
<p>Remember that <code class="docutils literal notranslate"><span class="pre">cos</span></code> (and <code class="docutils literal notranslate"><span class="pre">sin</span></code>) here returns values ranging from
<code class="docutils literal notranslate"><span class="pre">-1</span></code> to <code class="docutils literal notranslate"><span class="pre">1</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">.</span><span class="n">DBCOS</span> <span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">C</span><span class="p">,</span> <span class="n">D</span><span class="p">,</span> <span class="n">E</span>

<span class="k">for</span> <span class="p">(</span><span class="n">B</span><span class="o">++</span><span class="p">;</span> <span class="n">B</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">;</span> <span class="n">B</span><span class="o">--</span><span class="p">)</span> <span class="p">{</span>
  <span class="n">output_data</span><span class="p">((</span><span class="n">D</span> <span class="o">*</span> <span class="n">cos</span><span class="p">(</span><span class="n">A</span><span class="p">))</span> <span class="o">+</span> <span class="n">E</span><span class="p">)</span>
  <span class="n">A</span> <span class="o">=</span> <span class="n">keep_in_range</span><span class="p">(</span><span class="n">A</span> <span class="o">+</span> <span class="n">C</span><span class="p">)</span>
<span class="p">}</span>
</pre></div>
</div>
<p>This is not a compulsory directive.</p>
</section>
<section id="dbm-filtermacro-1-2-encrypt-me">
<h2><span class="section-number">2.36. </span><code class="docutils literal notranslate"><span class="pre">.DBM</span> <span class="pre">filtermacro</span> <span class="pre">1,</span> <span class="pre">2,</span> <span class="pre">&quot;encrypt</span> <span class="pre">me&quot;</span></code><a class="headerlink" href="#dbm-filtermacro-1-2-encrypt-me" title="Permalink to this headline">¶</a></h2>
<p>Defines bytes using a filter macro. All the data is passed to <code class="docutils literal notranslate"><span class="pre">filtermacro</span></code>
in the first argument, one byte at a time, and the byte that actually gets
defined is the value of definition <code class="docutils literal notranslate"><span class="pre">_OUT</span></code> (<code class="docutils literal notranslate"><span class="pre">_out</span></code> works as well). The
second macro argument holds the offset from the beginning (the first byte) in
bytes (the series being <code class="docutils literal notranslate"><span class="pre">0</span></code>, <code class="docutils literal notranslate"><span class="pre">1</span></code>, <code class="docutils literal notranslate"><span class="pre">2</span></code>, <code class="docutils literal notranslate"><span class="pre">3</span></code>, …).</p>
<p>Here’s an example of a filter macro that increments all the bytes by one:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">.</span><span class="n">macro</span> <span class="n">increment</span>
<span class="o">.</span><span class="n">redefine</span> <span class="n">_out</span> \<span class="mi">1</span><span class="o">+</span><span class="mi">1</span>
<span class="o">.</span><span class="n">endm</span>
</pre></div>
</div>
<p>This is not a compulsory directive.</p>
</section>
<section id="dbrnd-20-0-10">
<h2><span class="section-number">2.37. </span><code class="docutils literal notranslate"><span class="pre">.DBRND</span> <span class="pre">20,</span> <span class="pre">0,</span> <span class="pre">10</span></code><a class="headerlink" href="#dbrnd-20-0-10" title="Permalink to this headline">¶</a></h2>
<p>Defines bytes, just like <code class="docutils literal notranslate"><span class="pre">.DSB</span></code> does, only this time they are filled with
(pseudo) random numbers. We use the integrated Mersenne Twister to generate
the random numbers. If you want to seed the random number generator,
use <code class="docutils literal notranslate"><span class="pre">.SEED</span></code>.</p>
<p>The first parameter (<code class="docutils literal notranslate"><span class="pre">20</span></code> in the example) defines the number of random
numbers we want to generate. The next two tell the range of the random
numbers, i.e. min and max.</p>
<p>Here’s how it works:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">.</span><span class="n">DBRND</span> <span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">C</span>

<span class="k">for</span> <span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">A</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span>
  <span class="n">output_data</span><span class="p">((</span><span class="n">rand</span><span class="p">()</span> <span class="o">%</span> <span class="p">(</span><span class="n">C</span><span class="o">-</span><span class="n">B</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span> <span class="o">+</span> <span class="n">B</span><span class="p">);</span>
</pre></div>
</div>
<p>This is not a compulsory directive.</p>
</section>
<section id="dbsin-0-2-10-3-2-120-1-3">
<h2><span class="section-number">2.38. </span><code class="docutils literal notranslate"><span class="pre">.DBSIN</span> <span class="pre">0.2,</span> <span class="pre">10,</span> <span class="pre">3.2,</span> <span class="pre">120,</span> <span class="pre">1.3</span></code><a class="headerlink" href="#dbsin-0-2-10-3-2-120-1-3" title="Permalink to this headline">¶</a></h2>
<p>Analogous to <code class="docutils literal notranslate"><span class="pre">.DBCOS</span></code>, but does <code class="docutils literal notranslate"><span class="pre">sin()</span></code> instead of <code class="docutils literal notranslate"><span class="pre">cos()</span></code>.</p>
<p>This is not a compulsory directive.</p>
</section>
<section id="dd-1ffffff-2000000">
<h2><span class="section-number">2.39. </span><code class="docutils literal notranslate"><span class="pre">.DD</span> <span class="pre">$1ffffff,</span> <span class="pre">$2000000</span></code><a class="headerlink" href="#dd-1ffffff-2000000" title="Permalink to this headline">¶</a></h2>
<p>Defines double words (four bytes each). <code class="docutils literal notranslate"><span class="pre">.DD</span></code> takes only numbers, labels and
characters as input, not strings.</p>
<p>This is not a compulsory directive.</p>
</section>
<section id="ddm-filtermacro-1-2-3">
<h2><span class="section-number">2.40. </span><code class="docutils literal notranslate"><span class="pre">.DDM</span> <span class="pre">filtermacro</span> <span class="pre">1,</span> <span class="pre">2,</span> <span class="pre">3</span></code><a class="headerlink" href="#ddm-filtermacro-1-2-3" title="Permalink to this headline">¶</a></h2>
<p>Defines 32-bit words using a filter macro. Works just like <code class="docutils literal notranslate"><span class="pre">.DBM</span></code>, <code class="docutils literal notranslate"><span class="pre">.DWM</span></code> and <code class="docutils literal notranslate"><span class="pre">.DLM</span></code>.</p>
<p>This is not a compulsory directive.</p>
</section>
<section id="def-if-ff0f">
<h2><span class="section-number">2.41. </span><code class="docutils literal notranslate"><span class="pre">.DEF</span> <span class="pre">IF</span> <span class="pre">$FF0F</span></code><a class="headerlink" href="#def-if-ff0f" title="Permalink to this headline">¶</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">.DEF</span></code> is an alias for <code class="docutils literal notranslate"><span class="pre">.DEFINE</span></code>.</p>
<p>This is not a compulsory directive.</p>
</section>
<section id="define-if-ff0f">
<h2><span class="section-number">2.42. </span><code class="docutils literal notranslate"><span class="pre">.DEFINE</span> <span class="pre">IF</span> <span class="pre">$FF0F</span></code><a class="headerlink" href="#define-if-ff0f" title="Permalink to this headline">¶</a></h2>
<p>Assigns a number or a string to a definition label.</p>
<p>By default all defines are local to the file where they are
presented. If you want to make the definition visible to all the
files in the project, use <code class="docutils literal notranslate"><span class="pre">.EXPORT</span></code> or add EXPORT to the end of .DEFINE:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">.</span><span class="n">DEFINE</span> <span class="n">ID_0</span> <span class="mi">0</span> <span class="n">EXPORT</span>
</pre></div>
</div>
<p>WARNING: Please declare your definition lexically before using it as otherwise
the assembler might make incorrect assumptions about its value and size and
choose e.g. wrong opcodes and generate binary that doesn’t run properly.</p>
<p>Here are some examples:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">.</span><span class="n">DEFINE</span> <span class="n">X</span> <span class="mi">1000</span>
<span class="o">.</span><span class="n">DEFINE</span> <span class="n">FILE</span> <span class="s2">&quot;level01.bin&quot;</span>
<span class="o">.</span><span class="n">DEFINE</span> <span class="n">TXT1</span> <span class="s2">&quot;hello and welcome&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;to a new world...&quot;</span><span class="p">,</span> <span class="mi">0</span>
<span class="o">.</span><span class="n">DEFINE</span> <span class="n">BYTES</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span>
<span class="o">.</span><span class="n">DEFINE</span> <span class="n">COMPUTATION</span> <span class="n">X</span><span class="o">+</span><span class="mi">1</span>
<span class="o">.</span><span class="n">DEFINE</span> <span class="n">DEFAULTV</span>
</pre></div>
</div>
<p>All definitions with multiple values are marked as data strings,
and <code class="docutils literal notranslate"><span class="pre">.DB</span></code> is about the only place where you can later on use them:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">.</span><span class="n">DEFINE</span> <span class="n">BYTES</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span>
<span class="o">.</span><span class="n">DB</span> <span class="mi">0</span><span class="p">,</span> <span class="n">BYTES</span><span class="p">,</span> <span class="mi">6</span>
</pre></div>
</div>
<p>is the same as:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">.</span><span class="n">DB</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span>
</pre></div>
</div>
<p>If you omit the definition value (in our example <code class="docutils literal notranslate"><span class="pre">DEFAULTV</span></code>), WLA
will default to <code class="docutils literal notranslate"><span class="pre">0</span></code>.</p>
<p>Note that you must do your definition before you use it, otherwise
WLA will use the final value of the definition. Here’s an example
of this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">.</span><span class="n">DEFINE</span> <span class="n">AAA</span> <span class="mi">10</span>
<span class="o">.</span><span class="n">DB</span> <span class="n">AAA</span>            <span class="p">;</span> <span class="n">will</span> <span class="n">be</span> <span class="mf">10.</span>
<span class="o">.</span><span class="n">REDEFINE</span> <span class="n">AAA</span> <span class="mi">11</span>
</pre></div>
</div>
<p>but:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">.</span><span class="n">DB</span> <span class="n">AAA</span>            <span class="p">;</span> <span class="n">will</span> <span class="n">be</span> <span class="mf">11.</span>
<span class="o">.</span><span class="n">DEFINE</span> <span class="n">AAA</span> <span class="mi">10</span>
<span class="o">.</span><span class="n">REDEFINE</span> <span class="n">AAA</span> <span class="mi">11</span>
</pre></div>
</div>
<p>You can also create definitions on the command line. Here’s an
example of this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>wla-gb -vl -DMOON -DNAME=john -DPRICE=100 -DADDRESS=$100 math.s
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">MOON</span></code>’s value will be <code class="docutils literal notranslate"><span class="pre">0</span></code>, <code class="docutils literal notranslate"><span class="pre">NAME</span></code> is a string definition with value
<code class="docutils literal notranslate"><span class="pre">john</span></code>, <code class="docutils literal notranslate"><span class="pre">PRICE</span></code>’s value will be <code class="docutils literal notranslate"><span class="pre">100</span></code>, and <code class="docutils literal notranslate"><span class="pre">ADDRESS</span></code>’s value will be
<code class="docutils literal notranslate"><span class="pre">$100</span></code>.</p>
<p>Note that:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">.</span><span class="n">DEFINE</span> <span class="n">AAA</span> <span class="o">=</span> <span class="mi">10</span>   <span class="p">;</span> <span class="n">the</span> <span class="n">same</span> <span class="k">as</span> <span class="s2">&quot;.DEFINE AAA 10&quot;</span><span class="o">.</span>
</pre></div>
</div>
<p>works as well. And this works also:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">AAA</span> <span class="o">=</span> <span class="mi">10</span>
</pre></div>
</div>
<p>This is not a compulsory directive.</p>
</section>
<section id="destinationcode-1">
<h2><span class="section-number">2.43. </span><code class="docutils literal notranslate"><span class="pre">.DESTINATIONCODE</span> <span class="pre">1</span></code><a class="headerlink" href="#destinationcode-1" title="Permalink to this headline">¶</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">.DESTINATIONCODE</span></code> is an alias for <code class="docutils literal notranslate"><span class="pre">.COUNTRYCODE</span></code>.</p>
<p>This is not a compulsory directive.</p>
</section>
<section id="dl-102030-405060">
<h2><span class="section-number">2.44. </span><code class="docutils literal notranslate"><span class="pre">.DL</span> <span class="pre">$102030,</span> <span class="pre">$405060</span></code><a class="headerlink" href="#dl-102030-405060" title="Permalink to this headline">¶</a></h2>
<p>Defines long words (three bytes each). <code class="docutils literal notranslate"><span class="pre">.DL</span></code> takes only numbers, labels and
characters as input, not strings.</p>
<p>This is not a compulsory directive.</p>
</section>
<section id="dlm-filtermacro-1-2-3">
<h2><span class="section-number">2.45. </span><code class="docutils literal notranslate"><span class="pre">.DLM</span> <span class="pre">filtermacro</span> <span class="pre">1,</span> <span class="pre">2,</span> <span class="pre">3</span></code><a class="headerlink" href="#dlm-filtermacro-1-2-3" title="Permalink to this headline">¶</a></h2>
<p>Defines 24-bit words using a filter macro. Works just like <code class="docutils literal notranslate"><span class="pre">.DBM</span></code>, <code class="docutils literal notranslate"><span class="pre">.DWM</span></code> and <code class="docutils literal notranslate"><span class="pre">.DDM</span></code>.</p>
<p>This is not a compulsory directive.</p>
</section>
<section id="ds-256-10">
<h2><span class="section-number">2.46. </span><code class="docutils literal notranslate"><span class="pre">.DS</span> <span class="pre">256,</span> <span class="pre">$10</span></code><a class="headerlink" href="#ds-256-10" title="Permalink to this headline">¶</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">.DS</span></code> is an alias for <code class="docutils literal notranslate"><span class="pre">.DSB</span></code>.</p>
<p>This is not a compulsory directive.</p>
</section>
<section id="dsb-256-10">
<h2><span class="section-number">2.47. </span><code class="docutils literal notranslate"><span class="pre">.DSB</span> <span class="pre">256,</span> <span class="pre">$10</span></code><a class="headerlink" href="#dsb-256-10" title="Permalink to this headline">¶</a></h2>
<p>Defines <code class="docutils literal notranslate"><span class="pre">256</span></code> bytes of <code class="docutils literal notranslate"><span class="pre">$10</span></code>.</p>
<p>This is not a compulsory directive.</p>
</section>
<section id="dsd-256-1ffffff">
<h2><span class="section-number">2.48. </span><code class="docutils literal notranslate"><span class="pre">.DSD</span> <span class="pre">256,</span> <span class="pre">$1ffffff</span></code><a class="headerlink" href="#dsd-256-1ffffff" title="Permalink to this headline">¶</a></h2>
<p>Defines <code class="docutils literal notranslate"><span class="pre">256</span></code> double words (four bytes) of <code class="docutils literal notranslate"><span class="pre">$1ffffff</span></code>.</p>
<p>This is not a compulsory directive.</p>
</section>
<section id="dsl-16-102030">
<h2><span class="section-number">2.49. </span><code class="docutils literal notranslate"><span class="pre">.DSL</span> <span class="pre">16,</span> <span class="pre">$102030</span></code><a class="headerlink" href="#dsl-16-102030" title="Permalink to this headline">¶</a></h2>
<p>Defines <code class="docutils literal notranslate"><span class="pre">16</span></code> long words (three bytes) of <code class="docutils literal notranslate"><span class="pre">$102030</span></code>.</p>
<p>This is not a compulsory directive.</p>
</section>
<section id="dstruct-waterdrop-instanceof-water-values">
<h2><span class="section-number">2.50. </span><code class="docutils literal notranslate"><span class="pre">.DSTRUCT</span> <span class="pre">waterdrop</span> <span class="pre">INSTANCEOF</span> <span class="pre">water</span> <span class="pre">VALUES</span></code><a class="headerlink" href="#dstruct-waterdrop-instanceof-water-values" title="Permalink to this headline">¶</a></h2>
<p>Defines an instance of <code class="docutils literal notranslate"><span class="pre">.STRUCT</span></code> water, called waterdrop, and fills
it with the given data. Before calling <code class="docutils literal notranslate"><span class="pre">.DSTRUCT</span></code> we must have defined
the structure, and in this example it could be like:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">.</span><span class="n">STRUCT</span> <span class="n">water</span>
    <span class="n">name</span>   <span class="n">ds</span> <span class="mi">8</span>
    <span class="n">age</span>    <span class="n">db</span>
    <span class="n">weight</span> <span class="n">dw</span>
<span class="o">.</span><span class="n">ENDST</span>
</pre></div>
</div>
<p>There are two syntaxes for <code class="docutils literal notranslate"><span class="pre">.DSTRUCT</span></code>; the new and legacy versions. To use
the new syntax, put the keyword <code class="docutils literal notranslate"><span class="pre">VALUES</span></code> at the end of the first line.
The old syntax uses the keyword <code class="docutils literal notranslate"><span class="pre">DATA</span></code> or none at all.</p>
<p>The new syntax looks like this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">.</span><span class="n">DSTRUCT</span> <span class="n">waterdrop</span> <span class="n">INSTANCEOF</span> <span class="n">water</span> <span class="n">VALUES</span>
    <span class="n">name</span><span class="p">:</span>   <span class="o">.</span><span class="n">db</span> <span class="s2">&quot;tingle&quot;</span>
    <span class="n">age</span><span class="p">:</span>    <span class="o">.</span><span class="n">db</span> <span class="mi">40</span>
    <span class="n">weight</span><span class="p">:</span> <span class="o">.</span><span class="n">dw</span> <span class="mi">120</span>
<span class="o">.</span><span class="n">ENDST</span>
</pre></div>
</div>
<p>The fields can be put in any order. Any omitted fields are set to the
<code class="docutils literal notranslate"><span class="pre">.EMPTYFILL</span></code> value (<code class="docutils literal notranslate"><span class="pre">$00</span></code> by default). Any data-defining directive
can be used within <code class="docutils literal notranslate"><span class="pre">.DSTRUCT</span></code>, as long as it does not exceed the size of
the data it is being defined for. The only exception is <code class="docutils literal notranslate"><span class="pre">.DSTRUCT</span></code> itself,
which cannot be nested.</p>
<p>The old syntax looks like this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">.</span><span class="n">DSTRUCT</span> <span class="n">waterdrop</span> <span class="n">INSTANCEOF</span> <span class="n">water</span> <span class="n">DATA</span> <span class="s2">&quot;tingle&quot;</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">120</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">DATA</span></code> and <code class="docutils literal notranslate"><span class="pre">INSTANCEOF</span></code> keywords are optional. This will assign
data for each field of the struct in the order they were defined.</p>
<p>In either example you would get the following labels:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">waterdrop</span>
<span class="n">waterdrop</span><span class="o">.</span><span class="n">name</span>
<span class="n">waterdrop</span><span class="o">.</span><span class="n">age</span>
<span class="n">waterdrop</span><span class="o">.</span><span class="n">weight</span>
<span class="n">_sizeof_waterdrop</span>        <span class="o">=</span> <span class="mi">11</span>
<span class="n">_sizeof_waterdrop</span><span class="o">.</span><span class="n">name</span>   <span class="o">=</span> <span class="mi">8</span>
<span class="n">_sizeof_waterdrop</span><span class="o">.</span><span class="n">age</span>    <span class="o">=</span> <span class="mi">1</span>
<span class="n">_sizeof_waterdrop</span><span class="o">.</span><span class="n">weight</span> <span class="o">=</span> <span class="mi">2</span>
</pre></div>
</div>
<p>The legacy syntax does not support unions; it will give an error if you
attempt to define data for a union.</p>
<p>For the new syntax, nested structs are supported like so (assume the
<code class="docutils literal notranslate"><span class="pre">water</span></code> struct is also defined:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">.</span><span class="n">STRUCT</span> <span class="n">drop_pair</span>
    <span class="n">waterdrops</span><span class="p">:</span> <span class="n">instanceof</span> <span class="n">water</span> <span class="mi">2</span>
<span class="o">.</span><span class="n">ENDST</span>

<span class="o">.</span><span class="n">DSTRUCT</span> <span class="n">drops</span> <span class="n">INSTANCEOF</span> <span class="n">drop_pair</span> <span class="n">VALUES</span>
    <span class="n">waterdrops</span><span class="mf">.1</span><span class="p">:</span>        <span class="o">.</span><span class="n">db</span> <span class="s2">&quot;qwertyui&quot;</span> <span class="mi">40</span>
                         <span class="o">.</span><span class="n">dw</span> <span class="mi">120</span>
    <span class="n">waterdrops</span><span class="mf">.2</span><span class="o">.</span><span class="n">name</span><span class="p">:</span>   <span class="o">.</span><span class="n">db</span> <span class="s2">&quot;tingle&quot;</span>
    <span class="n">waterdrops</span><span class="mf">.2</span><span class="o">.</span><span class="n">age</span><span class="p">:</span>    <span class="o">.</span><span class="n">db</span> <span class="mi">40</span>
    <span class="n">waterdrops</span><span class="mf">.2</span><span class="o">.</span><span class="n">weight</span><span class="p">:</span> <span class="o">.</span><span class="n">dw</span> <span class="mi">12</span>
<span class="o">.</span><span class="n">ENDST</span>
</pre></div>
</div>
<p>In this case, the properties of <code class="docutils literal notranslate"><span class="pre">waterdrops.1</span></code> were defined
implicitly; 8 bytes for the name, followed by a byte for the age,
followed by a word for the weight. The values for <code class="docutils literal notranslate"><span class="pre">waterdrops.2</span></code> were
defined in a more clear way.</p>
<p>In this case, <code class="docutils literal notranslate"><span class="pre">waterdrops</span></code> and <code class="docutils literal notranslate"><span class="pre">waterdrops.1</span></code> are equivalent.
<code class="docutils literal notranslate"><span class="pre">waterdrops.1.name</span></code> is different, even though its address is the same,
because it has a size of 8. If you attempted to do this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">.</span><span class="n">DSTRUCT</span> <span class="n">drops</span> <span class="n">INSTANCEOF</span> <span class="n">drop_pair</span> <span class="n">VALUES</span>
    <span class="n">waterdrops</span><span class="mf">.1</span><span class="o">.</span><span class="n">name</span><span class="p">:</span>   <span class="o">.</span><span class="n">db</span> <span class="s2">&quot;qwertyui&quot;</span> <span class="mi">40</span>
                         <span class="o">.</span><span class="n">dw</span> <span class="mi">120</span>
<span class="o">.</span><span class="n">ENDST</span>
</pre></div>
</div>
<p>It would fail, because only the 8 name bytes are available to be defined
in this context, as opposed to the 11 bytes for the entire
<code class="docutils literal notranslate"><span class="pre">waterdrops.1</span></code> structure.</p>
<p>Named unions can be assigned to in a similar way, by writing its full
name with a <code class="docutils literal notranslate"><span class="pre">.</span></code> separating the union name and the field name.</p>
<p>The struct can be defined namelessly:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">.</span><span class="n">DSTRUCT</span> <span class="n">INSTANCEOF</span> <span class="n">drop_pair</span> <span class="n">VALUES</span>
    <span class="o">...</span>
<span class="o">.</span><span class="n">ENDST</span>
</pre></div>
</div>
<p>You can use <code class="docutils literal notranslate"><span class="pre">SIZE</span></code> to specify the size of the instance. The additional
bytes are filled with <code class="docutils literal notranslate"><span class="pre">.EMPTYFILL</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">.</span><span class="n">DSTRUCT</span> <span class="n">INSTANCEOF</span> <span class="n">drop_pair</span> <span class="n">SIZE</span> <span class="mi">128</span> <span class="n">VALUES</span>
    <span class="o">...</span>
<span class="o">.</span><span class="n">ENDST</span>
</pre></div>
</div>
<p>If you don’t want to generate labels use <code class="docutils literal notranslate"><span class="pre">NOLABELS</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">.</span><span class="n">DSTRUCT</span> <span class="n">INSTANCEOF</span> <span class="n">drop_pair</span> <span class="n">NOLABELS</span> <span class="n">VALUES</span>
    <span class="o">...</span>
<span class="o">.</span><span class="n">ENDST</span>
</pre></div>
</div>
<p>Here’s another example using the legacy syntax:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">.</span><span class="n">DSTRUCT</span> <span class="n">INSTANCEOF</span> <span class="n">water</span> <span class="n">SIZE</span> <span class="mi">32</span> <span class="n">NOLABELS</span> <span class="n">DATA</span> <span class="s2">&quot;Ocean&quot;</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">16384</span>
</pre></div>
</div>
<p>This is not a compulsory directive.</p>
</section>
<section id="dsw-128-20">
<h2><span class="section-number">2.51. </span><code class="docutils literal notranslate"><span class="pre">.DSW</span> <span class="pre">128,</span> <span class="pre">20</span></code><a class="headerlink" href="#dsw-128-20" title="Permalink to this headline">¶</a></h2>
<p>Defines <code class="docutils literal notranslate"><span class="pre">128</span></code> words (two bytes) of <code class="docutils literal notranslate"><span class="pre">20</span></code>.</p>
<p>This is not a compulsory directive.</p>
</section>
<section id="dw-16000-10-255">
<h2><span class="section-number">2.52. </span><code class="docutils literal notranslate"><span class="pre">.DW</span> <span class="pre">16000,</span> <span class="pre">10,</span> <span class="pre">255</span></code><a class="headerlink" href="#dw-16000-10-255" title="Permalink to this headline">¶</a></h2>
<p>Defines words (two bytes each). <code class="docutils literal notranslate"><span class="pre">.DW</span></code> takes only numbers, labels and
characters as input, not strings.</p>
<p>This is not a compulsory directive.</p>
</section>
<section id="dwcos-0-2-10-3-2-1024-1-3">
<h2><span class="section-number">2.53. </span><code class="docutils literal notranslate"><span class="pre">.DWCOS</span> <span class="pre">0.2,</span> <span class="pre">10,</span> <span class="pre">3.2,</span> <span class="pre">1024,</span> <span class="pre">1.3</span></code><a class="headerlink" href="#dwcos-0-2-10-3-2-1024-1-3" title="Permalink to this headline">¶</a></h2>
<p>Analogous to <code class="docutils literal notranslate"><span class="pre">.DBCOS</span></code> (but defines 16-bit words).</p>
<p>This is not a compulsory directive.</p>
</section>
<section id="dwm-filtermacro-1-2-3">
<h2><span class="section-number">2.54. </span><code class="docutils literal notranslate"><span class="pre">.DWM</span> <span class="pre">filtermacro</span> <span class="pre">1,</span> <span class="pre">2,</span> <span class="pre">3</span></code><a class="headerlink" href="#dwm-filtermacro-1-2-3" title="Permalink to this headline">¶</a></h2>
<p>Defines 16-bit words using a filter macro. Works just like <code class="docutils literal notranslate"><span class="pre">.DBM</span></code>, <code class="docutils literal notranslate"><span class="pre">.DLM</span></code> and  <code class="docutils literal notranslate"><span class="pre">.DDM</span></code>.</p>
<p>This is not a compulsory directive.</p>
</section>
<section id="dwrnd-20-0-10">
<h2><span class="section-number">2.55. </span><code class="docutils literal notranslate"><span class="pre">.DWRND</span> <span class="pre">20,</span> <span class="pre">0,</span> <span class="pre">10</span></code><a class="headerlink" href="#dwrnd-20-0-10" title="Permalink to this headline">¶</a></h2>
<p>Analogous to <code class="docutils literal notranslate"><span class="pre">.DBRND</span></code> (but defines words).</p>
<p>This is not a compulsory directive.</p>
</section>
<section id="dwsin-0-2-10-3-2-1024-1-3">
<h2><span class="section-number">2.56. </span><code class="docutils literal notranslate"><span class="pre">.DWSIN</span> <span class="pre">0.2,</span> <span class="pre">10,</span> <span class="pre">3.2,</span> <span class="pre">1024,</span> <span class="pre">1.3</span></code><a class="headerlink" href="#dwsin-0-2-10-3-2-1024-1-3" title="Permalink to this headline">¶</a></h2>
<p>Analogous to <code class="docutils literal notranslate"><span class="pre">.DBCOS</span></code> (but defines 16-bit words and does <code class="docutils literal notranslate"><span class="pre">sin()</span></code> instead of
<code class="docutils literal notranslate"><span class="pre">cos()</span></code>).</p>
<p>This is not a compulsory directive.</p>
</section>
<section id="elif-defined-debug-version-110">
<h2><span class="section-number">2.57. </span><code class="docutils literal notranslate"><span class="pre">.ELIF</span> <span class="pre">defined(DEBUG)</span> <span class="pre">&amp;&amp;</span> <span class="pre">VERSION</span> <span class="pre">&gt;</span> <span class="pre">110</span></code><a class="headerlink" href="#elif-defined-debug-version-110" title="Permalink to this headline">¶</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">.ELIF</span></code> means <code class="docutils literal notranslate"><span class="pre">ELSE</span> <span class="pre">IF</span></code>. Can be used after an <code class="docutils literal notranslate"><span class="pre">.IF</span></code> and the likes in
following fashion</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>.IF VERSION == 101
  .db 1
.ELIF VERSION == 102
  .db 2
.ELIF VERSION == 103
  .db 3
.ELSE
  .db $ff
.ENDIF
</pre></div>
</div>
<p>This is not a compulsory directive.</p>
</section>
<section id="else">
<h2><span class="section-number">2.58. </span><code class="docutils literal notranslate"><span class="pre">.ELSE</span></code><a class="headerlink" href="#else" title="Permalink to this headline">¶</a></h2>
<p>If the previous <code class="docutils literal notranslate"><span class="pre">.IFxxx</span></code> failed then the following text until
<code class="docutils literal notranslate"><span class="pre">.ENDIF</span></code> is acknowledged.</p>
<p>This is not a compulsory directive.</p>
</section>
<section id="emptyfill-c9">
<h2><span class="section-number">2.59. </span><code class="docutils literal notranslate"><span class="pre">.EMPTYFILL</span> <span class="pre">$C9</span></code><a class="headerlink" href="#emptyfill-c9" title="Permalink to this headline">¶</a></h2>
<p>This byte is used in filling the unused areas of the ROM file. <code class="docutils literal notranslate"><span class="pre">EMPTYFILL</span></code>
defaults to <code class="docutils literal notranslate"><span class="pre">$00</span></code>.</p>
<p>This is not a compulsory directive.</p>
</section>
<section id="endasm">
<h2><span class="section-number">2.60. </span><code class="docutils literal notranslate"><span class="pre">.ENDASM</span></code><a class="headerlink" href="#endasm" title="Permalink to this headline">¶</a></h2>
<p>Tells WLA to stop assembling. Use <code class="docutils literal notranslate"><span class="pre">.ASM</span></code> to continue the work.</p>
<p>This is not a compulsory directive.</p>
</section>
<section id="enda">
<h2><span class="section-number">2.61. </span><code class="docutils literal notranslate"><span class="pre">.ENDA</span></code><a class="headerlink" href="#enda" title="Permalink to this headline">¶</a></h2>
<p>Ends the ASCII table.</p>
<p>This is not a compulsory directive, but when <code class="docutils literal notranslate"><span class="pre">.ASCIITABLE</span></code> or <code class="docutils literal notranslate"><span class="pre">.ASCTABLE</span></code>
are used this one is required to terminate them.</p>
</section>
<section id="endb">
<h2><span class="section-number">2.62. </span><code class="docutils literal notranslate"><span class="pre">.ENDB</span></code><a class="headerlink" href="#endb" title="Permalink to this headline">¶</a></h2>
<p>Terminates <code class="docutils literal notranslate"><span class="pre">.BLOCK</span></code>.</p>
<p>This is not a compulsory directive, but when <code class="docutils literal notranslate"><span class="pre">.BLOCK</span></code> is used this one is
required to terminate it.</p>
</section>
<section id="endbits">
<h2><span class="section-number">2.63. </span><code class="docutils literal notranslate"><span class="pre">.ENDBITS</span></code><a class="headerlink" href="#endbits" title="Permalink to this headline">¶</a></h2>
<p>Terminates <code class="docutils literal notranslate"><span class="pre">.BITS</span></code>.</p>
<p>This is not a compulsory directive, but when <code class="docutils literal notranslate"><span class="pre">.BITS</span></code> is used this one is
required to terminate it.</p>
</section>
<section id="endemuvector">
<h2><span class="section-number">2.64. </span><code class="docutils literal notranslate"><span class="pre">.ENDEMUVECTOR</span></code><a class="headerlink" href="#endemuvector" title="Permalink to this headline">¶</a></h2>
<p>Ends definition of the emulation mode interrupt vector table.</p>
<p>This is not a compulsory directive, but when <code class="docutils literal notranslate"><span class="pre">.SNESEMUVECTOR</span></code>
is used this one is required to terminate it.</p>
</section>
<section id="ende">
<h2><span class="section-number">2.65. </span><code class="docutils literal notranslate"><span class="pre">.ENDE</span></code><a class="headerlink" href="#ende" title="Permalink to this headline">¶</a></h2>
<p>Ends the enumeration.</p>
<p>This is not a compulsory directive, but when <code class="docutils literal notranslate"><span class="pre">.ENUM</span></code> is used this one is
required to terminate it.</p>
</section>
<section id="endif">
<h2><span class="section-number">2.66. </span><code class="docutils literal notranslate"><span class="pre">.ENDIF</span></code><a class="headerlink" href="#endif" title="Permalink to this headline">¶</a></h2>
<p>This terminates any <code class="docutils literal notranslate"><span class="pre">.IFxxx</span></code> directive.</p>
<p>This is not a compulsory directive, but if you use any <code class="docutils literal notranslate"><span class="pre">.IFxxx</span></code> then
you need also to apply this.</p>
</section>
<section id="endme">
<h2><span class="section-number">2.67. </span><code class="docutils literal notranslate"><span class="pre">.ENDME</span></code><a class="headerlink" href="#endme" title="Permalink to this headline">¶</a></h2>
<p>Terminates <code class="docutils literal notranslate"><span class="pre">.MEMORYMAP</span></code>.</p>
<p>This is not a compulsory directive, but when <code class="docutils literal notranslate"><span class="pre">.MEMORYMAP</span></code> is used this one
is required to terminate it.</p>
</section>
<section id="endm">
<h2><span class="section-number">2.68. </span><code class="docutils literal notranslate"><span class="pre">.ENDM</span></code><a class="headerlink" href="#endm" title="Permalink to this headline">¶</a></h2>
<p>Ends a <code class="docutils literal notranslate"><span class="pre">.MACRO</span></code>.</p>
<p>This is not a compulsory directive, but when <code class="docutils literal notranslate"><span class="pre">.MACRO</span></code> is used this one is
required to terminate it.</p>
</section>
<section id="endnativevector">
<h2><span class="section-number">2.69. </span><code class="docutils literal notranslate"><span class="pre">.ENDNATIVEVECTOR</span></code><a class="headerlink" href="#endnativevector" title="Permalink to this headline">¶</a></h2>
<p>Ends definition of the native mode interrupt vector table.</p>
<p>This is not a compulsory directive, but when <code class="docutils literal notranslate"><span class="pre">.SNESNATIVEVECTOR</span></code>
is used this one is required to terminate it.</p>
</section>
<section id="endro">
<h2><span class="section-number">2.70. </span><code class="docutils literal notranslate"><span class="pre">.ENDRO</span></code><a class="headerlink" href="#endro" title="Permalink to this headline">¶</a></h2>
<p>Ends the rom bank map.</p>
<p>This is not a compulsory directive, but when <code class="docutils literal notranslate"><span class="pre">.ROMBANKMAP</span></code> is used this
one is required to terminate it.</p>
</section>
<section id="endr">
<h2><span class="section-number">2.71. </span><code class="docutils literal notranslate"><span class="pre">.ENDR</span></code><a class="headerlink" href="#endr" title="Permalink to this headline">¶</a></h2>
<p>Ends the repetition.</p>
<p>This is not a compulsory directive, but when <code class="docutils literal notranslate"><span class="pre">.REPEAT</span></code> is used this one is
required to terminate it.</p>
</section>
<section id="endsnes">
<h2><span class="section-number">2.72. </span><code class="docutils literal notranslate"><span class="pre">.ENDSNES</span></code><a class="headerlink" href="#endsnes" title="Permalink to this headline">¶</a></h2>
<p>This ends the SNES header definition.</p>
<p>This is not a compulsory directive, but when <code class="docutils literal notranslate"><span class="pre">.SNESHEADER</span></code> is used this
one is required to terminate it.</p>
</section>
<section id="endst">
<h2><span class="section-number">2.73. </span><code class="docutils literal notranslate"><span class="pre">.ENDST</span></code><a class="headerlink" href="#endst" title="Permalink to this headline">¶</a></h2>
<p>Ends the structure definition.</p>
<p>This is not a compulsory directive, but when <code class="docutils literal notranslate"><span class="pre">.STRUCT</span></code> is used this one is
required to terminate it.</p>
</section>
<section id="ends">
<h2><span class="section-number">2.74. </span><code class="docutils literal notranslate"><span class="pre">.ENDS</span></code><a class="headerlink" href="#ends" title="Permalink to this headline">¶</a></h2>
<p>Ends the section.</p>
<p>This is not a compulsory directive, but when <code class="docutils literal notranslate"><span class="pre">.SECTION</span></code> or <code class="docutils literal notranslate"><span class="pre">.RAMSECTION</span></code>
is used this one is required to terminate it.</p>
</section>
<section id="endu">
<h2><span class="section-number">2.75. </span><code class="docutils literal notranslate"><span class="pre">.ENDU</span></code><a class="headerlink" href="#endu" title="Permalink to this headline">¶</a></h2>
<p>Ends the current union.</p>
</section>
<section id="enum-c000">
<h2><span class="section-number">2.76. </span><code class="docutils literal notranslate"><span class="pre">.ENUM</span> <span class="pre">$C000</span></code><a class="headerlink" href="#enum-c000" title="Permalink to this headline">¶</a></h2>
<p>Starts enumeration from <code class="docutils literal notranslate"><span class="pre">$C000</span></code>. Very useful for defining variables.</p>
<p>To start a descending enumeration, put <code class="docutils literal notranslate"><span class="pre">DESC</span></code> after the starting
value. WLA defaults to <code class="docutils literal notranslate"><span class="pre">ASC</span></code> (ascending enumeration).</p>
<p>You can also add <code class="docutils literal notranslate"><span class="pre">EXPORT</span></code> after these if you want to export all
the generated definitions automatically.</p>
<p>Here’s an example of <code class="docutils literal notranslate"><span class="pre">.ENUM</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>.STRUCT mon                ; check out the documentation on
name ds 2                  ; .STRUCT
age  db
.ENDST

.ENUM $A000
_scroll_x DB               ; db  - define byte (byt and byte work also)
_scroll_y DB
player_x: DW               ; dw  - define word (word works also)
player_y: DW
map_01:   DS  16           ; ds  - define size (bytes)
map_02    DSB 16           ; dsb - define size (bytes)
map_03    DSW  8           ; dsw - define size (words)
monster   INSTANCEOF mon 3 ; three instances of structure mon
dragon    INSTANCEOF mon   ; one mon
.ENDE
</pre></div>
</div>
<p>Previous example transforms into following definitions:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>.DEFINE _scroll_x      $A000
.DEFINE _scroll_y      $A001
.DEFINE player_x       $A002
.DEFINE player_y       $A004
.DEFINE map_01         $A006
.DEFINE map_02         $A016
.DEFINE map_03         $A026
.DEFINE monster        $A036
.DEFINE monster.1      $A036
.DEFINE monster.1.name $A036
.DEFINE monster.1.age  $A038
.DEFINE monster.2      $A039
.DEFINE monster.2.name $A039
.DEFINE monster.2.age  $A03B
.DEFINE monster.3      $A03C
.DEFINE monster.3.name $A03C
.DEFINE monster.3.age  $A03E
.DEFINE dragon         $A03F
.DEFINE dragon.name    $A03F
.DEFINE dragon.age     $A041
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">DB</span></code>, <code class="docutils literal notranslate"><span class="pre">DW</span></code>, <code class="docutils literal notranslate"><span class="pre">DS</span></code>, <code class="docutils literal notranslate"><span class="pre">DSB</span></code>, <code class="docutils literal notranslate"><span class="pre">DSW</span></code> and <code class="docutils literal notranslate"><span class="pre">INSTANCEOF</span></code> can also be in
lowercase. You can also use a dotted version of the symbols, but it doesn’t
advance the memory address. Here’s an example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>.ENUM $C000 DESC EXPORT
bigapple_h db
bigapple_l db
bigapple:  .dw
.ENDE
</pre></div>
</div>
<p>And this is what is generated:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>.DEFINE bigapple_h $BFFF
.DEFINE bigapple_l $BFFE
.DEFINE bigapple   $BFFE
.EXPORT bigapple, bigapple_l, bigapple_h
</pre></div>
</div>
<p>This way you can generate a 16-bit variable address along with pointers
to its parts.</p>
<p>Here’s another example with a nameless INSTANCEOF:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>.STRUCT position_t
pos_x  DW
pos_y  DW
.ENDST

.STRUCT enemy_t
id     DW
       INSTANCEOF position_t ; here we import fields from position_t
health DW
.ENDST

.ENUM $A000
nemesis INSTANCEOF enemy_t
.ENDE
</pre></div>
</div>
<p>Regarding nemesis, you’ll get these definitions:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>.DEFINE nemesis        $A000
.DEFINE nemesis.id     $A000
.DEFINE nemesis.pos_x  $A002
.DEFINE nemesis.pos_y  $A004
.DEFINE nemesis.health $A006
</pre></div>
</div>
<p>If you want more flexible variable positioning, take a look at
<code class="docutils literal notranslate"><span class="pre">.RAMSECTION</span></code> s.</p>
<p>You can also specify the size of an instantiated struct (padding added at the end)
using the keyword <code class="docutils literal notranslate"><span class="pre">SIZE</span></code>. Also use keyword <code class="docutils literal notranslate"><span class="pre">COUNT</span></code> to make things more clear:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>.STRUCT mon                            ; the size of this .STRUCT is 3 (bytes)
name ds 2
age  db
.ENDST

.ENUM $A000
monsters INSTANCEOF mon SIZE 4 COUNT 2 ; two instances of structure mon.
.ENDE                                  ; each instance is padded to 4 bytes.
</pre></div>
</div>
<p>Note that in the previous example we’ll also get extra definitions</p>
<blockquote>
<div><p>_paddingof_monsters.1   (== 1)
_paddingof_monsters.2   (== 1)</p>
</div></blockquote>
<p>This is not a compulsory directive.</p>
</section>
<section id="enumid-id-1-0">
<h2><span class="section-number">2.77. </span><code class="docutils literal notranslate"><span class="pre">.ENUMID</span> <span class="pre">ID_1</span> <span class="pre">0</span></code><a class="headerlink" href="#enumid-id-1-0" title="Permalink to this headline">¶</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">.ENUMID</span></code> will create definitions with an autoincrementing value.
For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">.</span><span class="n">ENUMID</span> <span class="mi">0</span>
<span class="o">.</span><span class="n">ENUMID</span> <span class="n">ID_1</span>
<span class="o">.</span><span class="n">ENUMID</span> <span class="n">ID_2</span>
<span class="o">.</span><span class="n">ENUMID</span> <span class="n">ID_3</span>
</pre></div>
</div>
<p>… will create the following definitions:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ID_1</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">ID_2</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">ID_3</span> <span class="o">=</span> <span class="mi">2</span>
</pre></div>
</div>
<p>You can also specify the adder:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">.</span><span class="n">ENUMID</span> <span class="mi">0</span> <span class="n">STEP</span> <span class="mi">2</span>
<span class="o">.</span><span class="n">ENUMID</span> <span class="n">MONSTER_ID_1</span>
<span class="o">.</span><span class="n">ENUMID</span> <span class="n">MONSTER_ID_2</span>
<span class="o">.</span><span class="n">ENUMID</span> <span class="n">MONSTER_ID_3</span>
</pre></div>
</div>
<p>… to create definitions:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">MONSTER_ID_1</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">MONSTER_ID_2</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">MONSTER_ID_3</span> <span class="o">=</span> <span class="mi">4</span>
</pre></div>
</div>
<p>If you wish to export the definitions automatically, use EXPORT:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">.</span><span class="n">ENUMID</span> <span class="mi">16</span> <span class="n">STEP</span> <span class="mi">2</span> <span class="n">EXPORT</span>
<span class="o">.</span><span class="n">ENUMID</span> <span class="n">MUSIC_1</span>
<span class="o">.</span><span class="n">ENUMID</span> <span class="n">MUSIC_2</span>
<span class="o">.</span><span class="n">ENUMID</span> <span class="n">MUSIC_3</span>
</pre></div>
</div>
<p>… will create the following definitions and export them all:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">MUSIC_1</span> <span class="o">=</span> <span class="mi">16</span>
<span class="n">MUSIC_2</span> <span class="o">=</span> <span class="mi">18</span>
<span class="n">MUSIC_3</span> <span class="o">=</span> <span class="mi">20</span>
</pre></div>
</div>
<p>This is not a compulsory directive.</p>
</section>
<section id="equ-if-ff0f">
<h2><span class="section-number">2.78. </span><code class="docutils literal notranslate"><span class="pre">.EQU</span> <span class="pre">IF</span> <span class="pre">$FF0F</span></code><a class="headerlink" href="#equ-if-ff0f" title="Permalink to this headline">¶</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">.EQU</span></code> is an alias for <code class="docutils literal notranslate"><span class="pre">.DEFINE</span></code>.</p>
<p>This is not a compulsory directive.</p>
</section>
<section id="exhirom">
<h2><span class="section-number">2.79. </span><code class="docutils literal notranslate"><span class="pre">.EXHIROM</span></code><a class="headerlink" href="#exhirom" title="Permalink to this headline">¶</a></h2>
<p>With this directive you can define the SNES ROM mode to be ExHiROM.
Issuing <code class="docutils literal notranslate"><span class="pre">.EXHIROM</span></code> will override the user’s ROM bank map when
WLALINK computes 24-bit addresses and bank references. If no
<code class="docutils literal notranslate"><span class="pre">.HIROM</span></code>, <code class="docutils literal notranslate"><span class="pre">.LOROM</span></code> or <code class="docutils literal notranslate"><span class="pre">.EXHIROM</span></code> are given then WLALINK obeys the
banking defined in <code class="docutils literal notranslate"><span class="pre">.ROMBANKMAP</span></code>.</p>
<p><code class="docutils literal notranslate"><span class="pre">.EXHIROM</span></code> also sets the ROM mode bit in <code class="docutils literal notranslate"><span class="pre">$40FFD5</span></code> (mirrored in
<code class="docutils literal notranslate"><span class="pre">$FFD5</span></code>).</p>
<p>This is not a compulsory directive.</p>
</section>
<section id="export-work-x">
<h2><span class="section-number">2.80. </span><code class="docutils literal notranslate"><span class="pre">.EXPORT</span> <span class="pre">work_x</span></code><a class="headerlink" href="#export-work-x" title="Permalink to this headline">¶</a></h2>
<p>Exports the definition <code class="docutils literal notranslate"><span class="pre">work_x</span></code> to outside world. Exported definitions are
visible to all object files and libraries in the linking procedure. Note
that you can only export value definitions, not string definitions.</p>
<p>You can export as many definitions as you wish with one <code class="docutils literal notranslate"><span class="pre">.EXPORT</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">.</span><span class="n">EXPORT</span> <span class="n">NUMBER</span><span class="p">,</span> <span class="n">NAME</span><span class="p">,</span> <span class="n">ADDRESS</span><span class="p">,</span> <span class="n">COUNTRY</span>
<span class="o">.</span><span class="n">EXPORT</span> <span class="n">NAME</span><span class="p">,</span> <span class="n">AGE</span>
</pre></div>
</div>
<p>This is not a compulsory directive.</p>
</section>
<section id="fail-the-eye-of-mordor-has-seen-us">
<h2><span class="section-number">2.81. </span><code class="docutils literal notranslate"><span class="pre">.FAIL</span> <span class="pre">&quot;THE</span> <span class="pre">EYE</span> <span class="pre">OF</span> <span class="pre">MORDOR</span> <span class="pre">HAS</span> <span class="pre">SEEN</span> <span class="pre">US!&quot;</span></code><a class="headerlink" href="#fail-the-eye-of-mordor-has-seen-us" title="Permalink to this headline">¶</a></h2>
<p>Terminates the compiling process. You can also specify the error code:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">.</span><span class="n">FAIL</span> <span class="mi">2</span>
</pre></div>
</div>
<p>These work as well:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">.</span><span class="n">FAIL</span>
<span class="o">.</span><span class="n">FAIL</span> <span class="s2">&quot;EXIT CODE IS 1&quot;</span>
<span class="o">.</span><span class="n">FAIL</span> <span class="s2">&quot;UH OH...&quot;</span> <span class="mi">3</span>
</pre></div>
</div>
<p>By default, if you don’t specify the error code, it’ll be 1.</p>
<p>This is not a compulsory directive.</p>
</section>
<section id="faraddr-main-irq-1">
<h2><span class="section-number">2.82. </span><code class="docutils literal notranslate"><span class="pre">.FARADDR</span> <span class="pre">main,</span> <span class="pre">irq_1</span></code><a class="headerlink" href="#faraddr-main-irq-1" title="Permalink to this headline">¶</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">.FARADDR</span></code> is an alias for <code class="docutils literal notranslate"><span class="pre">.DL</span></code>.</p>
<p>This is not a compulsory directive.</p>
</section>
<section id="fastrom">
<h2><span class="section-number">2.83. </span><code class="docutils literal notranslate"><span class="pre">.FASTROM</span></code><a class="headerlink" href="#fastrom" title="Permalink to this headline">¶</a></h2>
<p>Sets the ROM memory speed bit in <code class="docutils literal notranslate"><span class="pre">$FFD5</span></code> (<code class="docutils literal notranslate"><span class="pre">.HIROM</span></code>), <code class="docutils literal notranslate"><span class="pre">$7FD5</span></code> (<code class="docutils literal notranslate"><span class="pre">.LOROM</span></code>)
or <code class="docutils literal notranslate"><span class="pre">$FFD5</span></code> and <code class="docutils literal notranslate"><span class="pre">$40FFD5</span></code> (<code class="docutils literal notranslate"><span class="pre">.EXHIROM</span></code>) to indicate that the SNES ROM chips
are 120ns chips.</p>
<p>This is not a compulsory directive.</p>
</section>
<section id="fclose-fp-databin">
<h2><span class="section-number">2.84. </span><code class="docutils literal notranslate"><span class="pre">.FCLOSE</span> <span class="pre">FP_DATABIN</span></code><a class="headerlink" href="#fclose-fp-databin" title="Permalink to this headline">¶</a></h2>
<p>Closes the filehandle <code class="docutils literal notranslate"><span class="pre">FP_DATABIN</span></code>.</p>
<p>This is not a compulsory directive.</p>
</section>
<section id="filter-filtermacro-1-2-encrypt-me">
<h2><span class="section-number">2.85. </span><code class="docutils literal notranslate"><span class="pre">.FILTER</span> <span class="pre">filtermacro</span> <span class="pre">1,</span> <span class="pre">2,</span> <span class="pre">&quot;encrypt</span> <span class="pre">me&quot;</span></code><a class="headerlink" href="#filter-filtermacro-1-2-encrypt-me" title="Permalink to this headline">¶</a></h2>
<p>Runs the supplied data, in bytes, through a filter macro. All the data is
passed to <code class="docutils literal notranslate"><span class="pre">filtermacro</span></code> in the first argument, one byte at a time. The
second macro argument holds the offset from the beginning (the first byte) in
bytes (the series being <code class="docutils literal notranslate"><span class="pre">0</span></code>, <code class="docutils literal notranslate"><span class="pre">1</span></code>, <code class="docutils literal notranslate"><span class="pre">2</span></code>, <code class="docutils literal notranslate"><span class="pre">3</span></code>, …).</p>
<p>Here’s an example of a filter macro that defines bits (four per byte):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">.</span><span class="n">macro</span> <span class="n">increment</span>
<span class="o">.</span><span class="n">bits</span> <span class="mi">4</span> \<span class="mi">1</span>
<span class="o">.</span><span class="n">endm</span>
</pre></div>
</div>
<p>Here’s a bigger example where we map some ASCII characters into 4 bits per char:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">//</span> <span class="n">define</span> <span class="n">an</span> <span class="n">array</span> <span class="k">for</span> <span class="n">mapping</span> <span class="n">ASCII</span> <span class="n">values</span> <span class="n">into</span> <span class="n">less</span> <span class="n">bits</span>
<span class="o">.</span><span class="n">ARRAYDEFINE</span> <span class="n">NAME</span> <span class="n">MapArray</span> <span class="n">SIZE</span> <span class="mi">4</span>

<span class="o">.</span><span class="n">ARRAYIN</span> <span class="n">NAME</span> <span class="n">MapArray</span> <span class="n">INDEX</span> <span class="s1">&#39;A&#39;</span> <span class="n">VALUES</span> <span class="o">%</span><span class="mi">0000</span><span class="p">,</span> <span class="o">%</span><span class="mi">0001</span><span class="p">,</span> <span class="o">%</span><span class="mi">0010</span><span class="p">,</span> \
    <span class="o">%</span><span class="mi">0011</span><span class="p">,</span> <span class="o">%</span><span class="mi">0100</span><span class="p">,</span> <span class="o">%</span><span class="mi">0101</span><span class="p">,</span> <span class="o">%</span><span class="mi">0110</span> <span class="o">//</span> <span class="n">defines</span> <span class="n">mappings</span> <span class="k">for</span> <span class="n">A</span><span class="o">-</span><span class="n">G</span>
<span class="o">.</span><span class="n">ARRAYIN</span> <span class="n">NAME</span> <span class="n">MapArray</span> <span class="n">INDEX</span>  <span class="mi">0</span>  <span class="n">VALUE</span> <span class="o">%</span><span class="mi">1111</span>

<span class="o">.</span><span class="n">MACRO</span> <span class="n">MapInto4Bits</span>
<span class="o">.</span><span class="n">ARRAYOUT</span> <span class="n">NAME</span> <span class="n">MapArray</span> <span class="n">INDEX</span> \<span class="mi">1</span> <span class="n">DEFINITION</span> <span class="n">MAPPING</span>
<span class="o">.</span><span class="n">BITS</span> <span class="mi">4</span> <span class="n">MAPPING</span>
<span class="o">.</span><span class="n">IF</span> \<span class="mi">1</span> <span class="o">==</span> <span class="mi">0</span>
    <span class="o">.</span><span class="n">ENDBITS</span>
<span class="o">.</span><span class="n">ENDIF</span>
<span class="o">.</span><span class="n">ENDM</span>

<span class="o">.</span><span class="n">FILTER</span> <span class="n">MapInto4Bits</span> <span class="s2">&quot;BAGED&quot;</span><span class="p">,</span> <span class="mi">0</span>
</pre></div>
</div>
<p>This is not a compulsory directive.</p>
</section>
<section id="fopen-data-bin-fp-databin">
<h2><span class="section-number">2.86. </span><code class="docutils literal notranslate"><span class="pre">.FOPEN</span> <span class="pre">&quot;data.bin&quot;</span> <span class="pre">FP_DATABIN</span></code><a class="headerlink" href="#fopen-data-bin-fp-databin" title="Permalink to this headline">¶</a></h2>
<p>Opens the file <code class="docutils literal notranslate"><span class="pre">data.bin</span></code> for reading and associates the filehandle with
name <code class="docutils literal notranslate"><span class="pre">FP_DATABIN</span></code>.</p>
<p>This is not a compulsory directive.</p>
</section>
<section id="fread-fp-databin-data">
<h2><span class="section-number">2.87. </span><code class="docutils literal notranslate"><span class="pre">.FREAD</span> <span class="pre">FP_DATABIN</span> <span class="pre">DATA</span></code><a class="headerlink" href="#fread-fp-databin-data" title="Permalink to this headline">¶</a></h2>
<p>Reads one byte from <code class="docutils literal notranslate"><span class="pre">FP_DATABIN</span></code> and creates a definition called
<code class="docutils literal notranslate"><span class="pre">DATA</span></code> to hold it. <code class="docutils literal notranslate"><span class="pre">DATA</span></code> is an ordinary definition label, so you can
<code class="docutils literal notranslate"><span class="pre">.UNDEFINE</span></code> it.</p>
<p>Here’s an example on how to use <code class="docutils literal notranslate"><span class="pre">.FREAD</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">.</span><span class="n">fopen</span> <span class="s2">&quot;data.bin&quot;</span> <span class="n">fp</span>
<span class="o">.</span><span class="n">fsize</span> <span class="n">fp</span> <span class="n">t</span>
<span class="o">.</span><span class="n">repeat</span> <span class="n">t</span>
<span class="o">.</span><span class="n">fread</span> <span class="n">fp</span> <span class="n">d</span>
<span class="o">.</span><span class="n">db</span> <span class="n">d</span><span class="o">+</span><span class="mi">26</span>
<span class="o">.</span><span class="n">endr</span>
<span class="o">.</span><span class="n">undefine</span> <span class="n">t</span><span class="p">,</span> <span class="n">d</span>
</pre></div>
</div>
<p>This is not a compulsory directive.</p>
</section>
<section id="fseek-fp-databin-10-start">
<h2><span class="section-number">2.88. </span><code class="docutils literal notranslate"><span class="pre">.FSEEK</span> <span class="pre">FP_DATABIN</span> <span class="pre">10</span> <span class="pre">START</span></code><a class="headerlink" href="#fseek-fp-databin-10-start" title="Permalink to this headline">¶</a></h2>
<p>Sets the file position of the given file pointer. There are three modes:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">.</span><span class="n">FSEEK</span> <span class="n">FP_DATABIN</span> <span class="mi">10</span> <span class="n">START</span>   <span class="p">;</span> <span class="mi">10</span> <span class="nb">bytes</span> <span class="kn">from</span> <span class="nn">the</span> <span class="n">beginning</span> <span class="n">of</span> <span class="n">the</span> <span class="n">file</span>
<span class="o">.</span><span class="n">FSEEK</span> <span class="n">FP_DATABIN</span> <span class="o">-</span><span class="mi">10</span> <span class="n">END</span>    <span class="p">;</span> <span class="mi">10</span> <span class="nb">bytes</span> <span class="n">before</span> <span class="n">the</span> <span class="n">end</span> <span class="n">of</span> <span class="n">the</span> <span class="n">file</span>
<span class="o">.</span><span class="n">FSEEK</span> <span class="n">FP_DATABIN</span> <span class="mi">10</span> <span class="n">CURRENT</span> <span class="p">;</span> <span class="mi">10</span> <span class="nb">bytes</span> <span class="n">forward</span> <span class="kn">from</span> <span class="nn">the</span> <span class="n">current</span>
                             <span class="p">;</span> <span class="n">position</span>
</pre></div>
</div>
<p>This is not a compulsory directive.</p>
</section>
<section id="fsize-fp-databin-size">
<h2><span class="section-number">2.89. </span><code class="docutils literal notranslate"><span class="pre">.FSIZE</span> <span class="pre">FP_DATABIN</span> <span class="pre">SIZE</span></code><a class="headerlink" href="#fsize-fp-databin-size" title="Permalink to this headline">¶</a></h2>
<p>Creates a definition called <code class="docutils literal notranslate"><span class="pre">SIZE</span></code>, which holds the size of the file
associated with the filehandle <code class="docutils literal notranslate"><span class="pre">FP_DATABIN</span></code>. <code class="docutils literal notranslate"><span class="pre">SIZE</span></code> is an ordinary
definition label, so you can <code class="docutils literal notranslate"><span class="pre">.UNDEFINE</span></code> it.</p>
<p>This is not a compulsory directive.</p>
</section>
<section id="ftell-fp-databin-position">
<h2><span class="section-number">2.90. </span><code class="docutils literal notranslate"><span class="pre">.FTELL</span> <span class="pre">FP_DATABIN</span> <span class="pre">POSITION</span></code><a class="headerlink" href="#ftell-fp-databin-position" title="Permalink to this headline">¶</a></h2>
<p>Creates a definition called <code class="docutils literal notranslate"><span class="pre">POSITION</span></code>, which holds the file position
of the file associated with the filehandle <code class="docutils literal notranslate"><span class="pre">FP_DATABIN</span></code>. <code class="docutils literal notranslate"><span class="pre">POSITION</span></code>
is an ordinary definition label, so you can <code class="docutils literal notranslate"><span class="pre">.UNDEFINE</span></code> it.</p>
<p>This is not a compulsory directive.</p>
</section>
<section id="gbheader">
<h2><span class="section-number">2.91. </span><code class="docutils literal notranslate"><span class="pre">.GBHEADER</span></code><a class="headerlink" href="#gbheader" title="Permalink to this headline">¶</a></h2>
<p>This begins the GB header definition, and automatically defines
<code class="docutils literal notranslate"><span class="pre">.COMPUTEGBCHECKSUM</span></code>. End the header definition with .ENDGB.
Here’s an example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>.GBHEADER
    NAME &quot;TANKBOMBPANIC&quot;  ; identical to a freestanding .NAME.
    LICENSEECODEOLD $34   ; identical to a freestanding .LICENSEECODEOLD.
    LICENSEECODENEW &quot;HI&quot;  ; identical to a freestanding .LICENSEECODENEW.
    CARTRIDGETYPE $00     ; identical to a freestanding .CARTRIDGETYPE.
    RAMSIZE $09           ; identical to a freestanding .RAMSIZE.
    ROMSIZE               ; identical to a freestanding .ROMSIZE.
    COUNTRYCODE $01       ; identical to a freestanding .COUNTRYCODE/DESTINATIONCODE.
    DESTINATIONCODE $01   ; identical to a freestanding .DESTINATIONCODE/COUNTRYCODE.
    NINTENDOLOGO          ; identical to a freestanding .NINTENDOLOGO.
    VERSION $01           ; identical to a freestanding .VERSION.
    ROMDMG                ; identical to a freestanding .ROMDMG.
                          ; Alternatively, ROMGBC or ROMGBCONLY can be used
.ENDGB
</pre></div>
</div>
<p>This is not a compulsory directive.</p>
</section>
<section id="hex-a0a0ffde">
<h2><span class="section-number">2.92. </span><code class="docutils literal notranslate"><span class="pre">.HEX</span> <span class="pre">&quot;a0A0ffDE&quot;</span></code><a class="headerlink" href="#hex-a0a0ffde" title="Permalink to this headline">¶</a></h2>
<p>Defines bytes using the supplied string that contains the bytes in
hexadecimal format. For example, the same result can be obtained
using <code class="docutils literal notranslate"><span class="pre">.DB</span></code></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>.DB $a0, $A0, $ff, $DE
</pre></div>
</div>
<p>This is not a compulsory directive.</p>
</section>
<section id="hirom">
<h2><span class="section-number">2.93. </span><code class="docutils literal notranslate"><span class="pre">.HIROM</span></code><a class="headerlink" href="#hirom" title="Permalink to this headline">¶</a></h2>
<p>With this directive you can define the SNES ROM mode to be HiROM.
Issuing <code class="docutils literal notranslate"><span class="pre">.HIROM</span></code> will override the user’s ROM bank map when
WLALINK computes 24-bit addresses and bank references. If no
<code class="docutils literal notranslate"><span class="pre">.HIROM</span></code>, <code class="docutils literal notranslate"><span class="pre">.LOROM</span></code> or <code class="docutils literal notranslate"><span class="pre">.EXHIROM</span></code> are given then WLALINK obeys the
banking defined in <code class="docutils literal notranslate"><span class="pre">.ROMBANKMAP</span></code>.</p>
<p><code class="docutils literal notranslate"><span class="pre">.HIROM</span></code> also sets the ROM mode bit in <code class="docutils literal notranslate"><span class="pre">$FFD5</span></code>.</p>
<p>This is not a compulsory directive.</p>
</section>
<section id="if-debug-2">
<h2><span class="section-number">2.94. </span><code class="docutils literal notranslate"><span class="pre">.IF</span> <span class="pre">DEBUG</span> <span class="pre">==</span> <span class="pre">2</span></code><a class="headerlink" href="#if-debug-2" title="Permalink to this headline">¶</a></h2>
<p>If the condition is fulfilled the following piece of code is
acknowledged until <code class="docutils literal notranslate"><span class="pre">.ENDIF</span></code>/<code class="docutils literal notranslate"><span class="pre">.ELSE</span></code>/<code class="docutils literal notranslate"><span class="pre">.ELIF</span></code> occurs in the text,
otherwise it is skipped. Operands must be immediate values or strings.</p>
<p>The following operators are supported:</p>
<table class="docutils align-default">
<tbody>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">!</span></code></p></td>
<td><p>not</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">&lt;</span></code></p></td>
<td><p>less than</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">&lt;=</span></code></p></td>
<td><p>less or equal to</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">&gt;</span></code></p></td>
<td><p>greater than</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">&gt;=</span></code></p></td>
<td><p>greater or equal to</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">==</span></code></p></td>
<td><p>equals to</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">!=</span></code></p></td>
<td><p>doesn’t equal to</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">||</span></code></p></td>
<td><p>logical or</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">&amp;&amp;</span></code></p></td>
<td><p>logical and</p></td>
</tr>
</tbody>
</table>
<p>All <code class="docutils literal notranslate"><span class="pre">IF</span></code> directives (yes, including <code class="docutils literal notranslate"><span class="pre">.IFDEF</span></code>, <code class="docutils literal notranslate"><span class="pre">.IFNDEF</span></code>, etc) can be
nested. They can also be used within <code class="docutils literal notranslate"><span class="pre">ENUM</span></code> s, <code class="docutils literal notranslate"><span class="pre">RAMSECTION</span></code> s,
<code class="docutils literal notranslate"><span class="pre">STRUCT</span></code> s, <code class="docutils literal notranslate"><span class="pre">ROMBANKMAP</span></code> s, and most other directives that occupy multiple
lines.</p>
<p>Note that complex conditions are also possible</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">.</span><span class="n">IF</span> <span class="n">DEBUG</span> <span class="o">==</span> <span class="mi">2</span> <span class="o">&amp;&amp;</span> <span class="n">defined</span><span class="p">(</span><span class="n">HELLO</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="n">exists</span><span class="p">(</span><span class="s2">&quot;main.s&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Here defined() and exists() both return 1 of they are true, and 0 if false. In
fact in conditions 0 is false and anything else is considered to be true.</p>
<p>This is not a compulsory directive.</p>
</section>
<section id="ifdef-if">
<h2><span class="section-number">2.95. </span><code class="docutils literal notranslate"><span class="pre">.IFDEF</span> <span class="pre">IF</span></code><a class="headerlink" href="#ifdef-if" title="Permalink to this headline">¶</a></h2>
<p>If <code class="docutils literal notranslate"><span class="pre">IF</span></code> is defined, then the following piece of code is acknowledged
until <code class="docutils literal notranslate"><span class="pre">.ENDIF</span></code>/<code class="docutils literal notranslate"><span class="pre">.ELSE</span></code> occurs in the text, otherwise it is skipped.</p>
<p>This is not a compulsory directive.</p>
</section>
<section id="ifdefm-2">
<h2><span class="section-number">2.96. </span><code class="docutils literal notranslate"><span class="pre">.IFDEFM</span> <span class="pre">\2</span></code><a class="headerlink" href="#ifdefm-2" title="Permalink to this headline">¶</a></h2>
<p>If the specified argument is defined (argument number two, in the example),
then the following piece of code is acknowledged until <code class="docutils literal notranslate"><span class="pre">.ENDIF</span></code>/<code class="docutils literal notranslate"><span class="pre">.ELSE</span></code>
occurs in the macro, otherwise it is skipped.</p>
<p>This is not a compulsory directive. <code class="docutils literal notranslate"><span class="pre">.IFDEFM</span></code> works only inside a macro.</p>
</section>
<section id="ifeq-debug-2">
<h2><span class="section-number">2.97. </span><code class="docutils literal notranslate"><span class="pre">.IFEQ</span> <span class="pre">DEBUG</span> <span class="pre">2</span></code><a class="headerlink" href="#ifeq-debug-2" title="Permalink to this headline">¶</a></h2>
<p>If the value of <code class="docutils literal notranslate"><span class="pre">DEBUG</span></code> equals to <code class="docutils literal notranslate"><span class="pre">2</span></code>, then the following piece of code is
acknowledged until <code class="docutils literal notranslate"><span class="pre">.ENDIF</span></code>/<code class="docutils literal notranslate"><span class="pre">.ELSE</span></code> occurs in the text, otherwise it is
skipped. Both arguments can be computations, defines or immediate values.</p>
<p>This is not a compulsory directive.</p>
</section>
<section id="ifexists-main-s">
<h2><span class="section-number">2.98. </span><code class="docutils literal notranslate"><span class="pre">.IFEXISTS</span> <span class="pre">&quot;main.s&quot;</span></code><a class="headerlink" href="#ifexists-main-s" title="Permalink to this headline">¶</a></h2>
<p>If <code class="docutils literal notranslate"><span class="pre">main.s</span></code> file can be found, then the following piece of code is
acknowledged until <code class="docutils literal notranslate"><span class="pre">.ENDIF</span></code>/<code class="docutils literal notranslate"><span class="pre">.LESE</span></code> occurs in the text, otherwise it is
skipped.</p>
<p>By writing the following few lines you can include a file if it exists
without breaking the compiling loop if it doesn’t exist:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">.</span><span class="n">IFEXISTS</span> <span class="n">FILE</span>
<span class="o">.</span><span class="n">INCLUDE</span> <span class="n">FILE</span>
<span class="o">.</span><span class="n">ENDIF</span>
</pre></div>
</div>
<p>This is not a compulsory directive.</p>
</section>
<section id="ifgr-debug-2">
<h2><span class="section-number">2.99. </span><code class="docutils literal notranslate"><span class="pre">.IFGR</span> <span class="pre">DEBUG</span> <span class="pre">2</span></code><a class="headerlink" href="#ifgr-debug-2" title="Permalink to this headline">¶</a></h2>
<p>If the value of <code class="docutils literal notranslate"><span class="pre">DEBUG</span></code> is greater than <code class="docutils literal notranslate"><span class="pre">2</span></code>, then the following piece of
code is acknowledged until <code class="docutils literal notranslate"><span class="pre">.ENDIF</span></code>/<code class="docutils literal notranslate"><span class="pre">.ELSE</span></code> occurs in the text, otherwise
it is skipped. Both arguments can be computations, defines or immediate values.</p>
<p>This is not a compulsory directive.</p>
</section>
<section id="ifgreq-debug-2">
<h2><span class="section-number">2.100. </span><code class="docutils literal notranslate"><span class="pre">.IFGREQ</span> <span class="pre">DEBUG</span> <span class="pre">2</span></code><a class="headerlink" href="#ifgreq-debug-2" title="Permalink to this headline">¶</a></h2>
<p>If the value of <code class="docutils literal notranslate"><span class="pre">DEBUG</span></code> is greater or equal to <code class="docutils literal notranslate"><span class="pre">2</span></code>, then the following
pieceof code is acknowledged until <code class="docutils literal notranslate"><span class="pre">.ENDIF</span></code>/<code class="docutils literal notranslate"><span class="pre">.ELSE</span></code> occurs in the text,
otherwise it is skipped. Both arguments can be computations, defines or
immediate values.</p>
<p>This is not a compulsory directive.</p>
</section>
<section id="ifle-debug-2">
<h2><span class="section-number">2.101. </span><code class="docutils literal notranslate"><span class="pre">.IFLE</span> <span class="pre">DEBUG</span> <span class="pre">2</span></code><a class="headerlink" href="#ifle-debug-2" title="Permalink to this headline">¶</a></h2>
<p>If the value of <code class="docutils literal notranslate"><span class="pre">DEBUG</span></code> is less than <code class="docutils literal notranslate"><span class="pre">2</span></code>, then the following piece of code
is acknowledged until <code class="docutils literal notranslate"><span class="pre">.ENDIF</span></code>/<code class="docutils literal notranslate"><span class="pre">.ELSE</span></code> occurs in the text, otherwise it is
skipped. Both arguments can be computations, defines or immediate values.</p>
<p>This is not a compulsory directive.</p>
</section>
<section id="ifleeq-debug-2">
<h2><span class="section-number">2.102. </span><code class="docutils literal notranslate"><span class="pre">.IFLEEQ</span> <span class="pre">DEBUG</span> <span class="pre">2</span></code><a class="headerlink" href="#ifleeq-debug-2" title="Permalink to this headline">¶</a></h2>
<p>If the value of <code class="docutils literal notranslate"><span class="pre">DEBUG</span></code> is less or equal to <code class="docutils literal notranslate"><span class="pre">2</span></code>, then the following piece of
code is acknowledged until <code class="docutils literal notranslate"><span class="pre">.ENDIF</span></code>/<code class="docutils literal notranslate"><span class="pre">.ELSE</span></code> occurs in the text, otherwise
it is skipped. Both arguments can be computations, defines or immediate values.</p>
<p>This is not a compulsory directive.</p>
</section>
<section id="ifndef-if">
<h2><span class="section-number">2.103. </span><code class="docutils literal notranslate"><span class="pre">.IFNDEF</span> <span class="pre">IF</span></code><a class="headerlink" href="#ifndef-if" title="Permalink to this headline">¶</a></h2>
<p>If <code class="docutils literal notranslate"><span class="pre">IF</span></code> is not defined, then the following piece of code is acknowledged
until <code class="docutils literal notranslate"><span class="pre">.ENDIF</span></code>/<code class="docutils literal notranslate"><span class="pre">.ELSE</span></code> occurs in the text, otherwise it is skipped.</p>
<p>This is not a compulsory directive.</p>
</section>
<section id="ifndefm-2">
<h2><span class="section-number">2.104. </span><code class="docutils literal notranslate"><span class="pre">.IFNDEFM</span> <span class="pre">\2</span></code><a class="headerlink" href="#ifndefm-2" title="Permalink to this headline">¶</a></h2>
<p>If the specified argument is not defined, then the following piece of
code is acknowledged until <code class="docutils literal notranslate"><span class="pre">.ENDIF</span></code>/<code class="docutils literal notranslate"><span class="pre">.ELSE</span></code> occurs in the macro, otherwise
it is skipped.</p>
<p>This is not a compulsory directive. <code class="docutils literal notranslate"><span class="pre">.IFNDEFM</span></code> works only inside a macro.</p>
</section>
<section id="ifneq-debug-2">
<h2><span class="section-number">2.105. </span><code class="docutils literal notranslate"><span class="pre">.IFNEQ</span> <span class="pre">DEBUG</span> <span class="pre">2</span></code><a class="headerlink" href="#ifneq-debug-2" title="Permalink to this headline">¶</a></h2>
<p>If the value of <code class="docutils literal notranslate"><span class="pre">DEBUG</span></code> doesn’t equal to <code class="docutils literal notranslate"><span class="pre">2</span></code>, then the following piece of
code is acknowledged until <code class="docutils literal notranslate"><span class="pre">.ENDIF</span></code>/<code class="docutils literal notranslate"><span class="pre">.ELSE</span></code> occurs in the text, otherwise
it is skipped. Both arguments can be computations, defines or immediate values.</p>
<p>This is not a compulsory directive.</p>
</section>
<section id="inc-cgb-hardware-i">
<h2><span class="section-number">2.106. </span><code class="docutils literal notranslate"><span class="pre">.INC</span> <span class="pre">&quot;cgb_hardware.i&quot;</span></code><a class="headerlink" href="#inc-cgb-hardware-i" title="Permalink to this headline">¶</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">INC</span></code> is an alias for <code class="docutils literal notranslate"><span class="pre">INCLUDE</span></code>.</p>
<p>This is not a compulsory directive.</p>
</section>
<section id="incbin-sorority-bin">
<h2><span class="section-number">2.107. </span><code class="docutils literal notranslate"><span class="pre">.INCBIN</span> <span class="pre">&quot;sorority.bin&quot;</span></code><a class="headerlink" href="#incbin-sorority-bin" title="Permalink to this headline">¶</a></h2>
<p>Includes the specified data file into the source file. <code class="docutils literal notranslate"><span class="pre">.INCBIN</span></code> caches
all files into memory, so you can <code class="docutils literal notranslate"><span class="pre">.INCBIN</span></code> any data file millions of
times, but it is loaded from hard drive only once.</p>
<p>You can optionally use <code class="docutils literal notranslate"><span class="pre">SWAP</span></code> after the file name, e.g.,</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">.</span><span class="n">INCBIN</span> <span class="s2">&quot;kitten.bin&quot;</span> <span class="n">SWAP</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">.INCBIN</span></code> data is divided into blocks of two bytes, and inside every block
the bytes are exchanged (like <code class="docutils literal notranslate"><span class="pre">SWAP</span> <span class="pre">r</span></code> does to nibbles). This requires that
the size of the file is even.</p>
<p>You can also force WLA to skip n bytes from the beginning of the file
by writing for example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">.</span><span class="n">INCBIN</span> <span class="s2">&quot;kitten.bin&quot;</span> <span class="n">SKIP</span> <span class="mi">4</span>
</pre></div>
</div>
<p>Four bytes are skipped from the beginning of <code class="docutils literal notranslate"><span class="pre">kitten.bin</span></code> and the rest
is incbinned.</p>
<p>It is also possible to incbin only n bytes from a file:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">.</span><span class="n">INCBIN</span> <span class="s2">&quot;kitten.bin&quot;</span> <span class="n">READ</span> <span class="mi">10</span>
</pre></div>
</div>
<p>Will read ten bytes from the beginning of <code class="docutils literal notranslate"><span class="pre">kitten.bin</span></code>.</p>
<p>You can also force WLA to create a definition holding the size
of the file:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">.</span><span class="n">INCBIN</span> <span class="s2">&quot;kitten.bin&quot;</span> <span class="n">FSIZE</span> <span class="n">size_of_kitten</span>
</pre></div>
</div>
<p>Want to circulate all the included bytes through a filter macro? Do this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">.</span><span class="n">INCBIN</span> <span class="s2">&quot;kitten.bin&quot;</span> <span class="n">FILTER</span> <span class="n">filtermacro</span>
</pre></div>
</div>
<p>The filter macro is executed for each byte of the included data, data
byte being the first argument, and offset from the beginning being the
second parameter, just like in the case of <code class="docutils literal notranslate"><span class="pre">.DBM</span></code>, <code class="docutils literal notranslate"><span class="pre">.DWM</span></code>, <code class="docutils literal notranslate"><span class="pre">.DLM</span></code> and <code class="docutils literal notranslate"><span class="pre">.DDM</span></code>.</p>
<p>And you can combine all these four commands:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">.</span><span class="n">INCBIN</span> <span class="s2">&quot;kitten.bin&quot;</span> <span class="n">SKIP</span> <span class="mi">10</span> <span class="n">READ</span> <span class="mi">8</span> <span class="n">SWAP</span> <span class="n">FSIZE</span> <span class="n">size_of_kitten</span> <span class="n">FILTER</span> <span class="n">filtermacro</span>
</pre></div>
</div>
<p>This example shows how to incbin eight bytes (swapped) after skipping
10 bytes from the beginning of file <code class="docutils literal notranslate"><span class="pre">kitten.bin</span></code>, and how to get the
size of the file into a definition label <code class="docutils literal notranslate"><span class="pre">size_of_kitten</span></code>. All the data bytes
are circulated through a filter macro.</p>
<p>Here’s an example of a filter macro that increments all the bytes by one:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">.</span><span class="n">macro</span> <span class="n">filtermacro</span>    <span class="p">;</span> <span class="n">the</span> <span class="nb">input</span> <span class="n">byte</span> <span class="ow">is</span> \<span class="mi">1</span><span class="p">,</span> <span class="n">the</span> <span class="n">output</span> <span class="n">byte</span> <span class="ow">is</span> <span class="ow">in</span> <span class="s2">&quot;_out&quot;</span>
<span class="o">.</span><span class="n">redefine</span> <span class="n">_out</span> \<span class="mi">1</span><span class="o">+</span><span class="mi">1</span>
<span class="o">.</span><span class="n">endm</span>
</pre></div>
</div>
<p>Note that the order of the extra commands is important.</p>
<p>If the file’s not found in the <code class="docutils literal notranslate"><span class="pre">.INCDIR</span></code> directory, WLA tries to find it
in the current working directory. If the <code class="docutils literal notranslate"><span class="pre">INCDIR</span></code> is specified in the command
line, WLA will first search for the file in that directory. If not found, it
will then proceed as aforementioned.</p>
<p>This is not a compulsory directive.</p>
</section>
<section id="incdir-usr-programming-gb-include">
<h2><span class="section-number">2.108. </span><code class="docutils literal notranslate"><span class="pre">.INCDIR</span> <span class="pre">&quot;/usr/programming/gb/include/&quot;</span></code><a class="headerlink" href="#incdir-usr-programming-gb-include" title="Permalink to this headline">¶</a></h2>
<p>Changes the current include root directory. Use this to specify main
directory for the following <code class="docutils literal notranslate"><span class="pre">.INCLUDE</span></code> and <code class="docutils literal notranslate"><span class="pre">.INCBIN</span></code> directives.
If you want to change to the current working directory (WLA also defaults
to this), use:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">.</span><span class="n">INCDIR</span> <span class="s2">&quot;&quot;</span>
</pre></div>
</div>
<p>If the <code class="docutils literal notranslate"><span class="pre">INCDIR</span></code> is specified in the command line, that directory will be
searched before the <code class="docutils literal notranslate"><span class="pre">.INCDIR</span></code> in the file. If the file is not found, WLA
will then silently search the specified <code class="docutils literal notranslate"><span class="pre">.INCDIR</span></code>.</p>
<p>This is not a compulsory directive.</p>
</section>
<section id="include-cgb-hardware-i">
<h2><span class="section-number">2.109. </span><code class="docutils literal notranslate"><span class="pre">.INCLUDE</span> <span class="pre">&quot;cgb_hardware.i&quot;</span></code><a class="headerlink" href="#include-cgb-hardware-i" title="Permalink to this headline">¶</a></h2>
<p>Includes the specified file to the source file. If the file’s not found
in the <code class="docutils literal notranslate"><span class="pre">.INCDIR</span></code> directory, WLA tries to find it in the current working
directory. If the <code class="docutils literal notranslate"><span class="pre">INCDIR</span></code> is specified in the command line, WLA will first
try to find the file specified in that directory. Then proceed as mentioned
before if it is not found.</p>
<p>If you want to prefix all labels inside the included file with something, use:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">.</span><span class="n">INCLUDE</span> <span class="s2">&quot;music_player.s&quot;</span> <span class="n">NAMESPACE</span> <span class="s2">&quot;musicplayer&quot;</span>
</pre></div>
</div>
<p>In the case of this example, all sections, macros, labels and references to
those labels inside the included file are prefixed with “musicplayer.”, though
there are a couple of exceptions. If a <code class="docutils literal notranslate"><span class="pre">.SECTION</span></code> inside the included file has
its own namespace, the <code class="docutils literal notranslate"><span class="pre">.INCLUDE</span></code> ‘s namespace doesn’t affect it. If a <code class="docutils literal notranslate"><span class="pre">.SECTION</span></code>
inside the included file uses <code class="docutils literal notranslate"><span class="pre">APPENDTO</span></code> with a section name that starts with
<code class="docutils literal notranslate"><span class="pre">&quot;*:&quot;</span></code>, that <code class="docutils literal notranslate"><span class="pre">APPENDTO</span></code> is considered to belong to the global namespace and we
won’t prefix it with the <code class="docutils literal notranslate"><span class="pre">.INCLUDE</span></code> ‘s namespace.</p>
<p>Note that you can create the file name from pieces:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">.</span><span class="n">INCLUDE</span> <span class="n">ROOTDIR</span><span class="p">,</span> <span class="n">SUBDIR</span><span class="p">,</span> <span class="s2">&quot;cthulhu.s&quot;</span> <span class="n">NAMESPACE</span> <span class="s2">&quot;cthulhu&quot;</span>
</pre></div>
</div>
<p>This might end up looking for a file “root/subdir/cthulhu.s”, depending on the
definitions.</p>
<p>If you are using the <code class="docutils literal notranslate"><span class="pre">.INCLUDE</span></code> inside a <code class="docutils literal notranslate"><span class="pre">.MACRO</span></code> and want to have the file
included only once, use the keyword <code class="docutils literal notranslate"><span class="pre">ONCE</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">.</span><span class="n">INCLUDE</span> <span class="s2">&quot;include_one.s&quot;</span> <span class="n">NAMESPACE</span> <span class="s2">&quot;once&quot;</span> <span class="n">ONCE</span>
</pre></div>
</div>
<p>This is not a compulsory directive.</p>
</section>
<section id="index-8">
<h2><span class="section-number">2.110. </span><code class="docutils literal notranslate"><span class="pre">.INDEX</span> <span class="pre">8</span></code><a class="headerlink" href="#index-8" title="Permalink to this headline">¶</a></h2>
<p>Forces WLA to override the index (<code class="docutils literal notranslate"><span class="pre">X</span></code>/<code class="docutils literal notranslate"><span class="pre">Y</span></code>) register size given with
<code class="docutils literal notranslate"><span class="pre">SEP</span></code>/<code class="docutils literal notranslate"><span class="pre">REP</span></code>. <code class="docutils literal notranslate"><span class="pre">.INDEX</span></code> doesn’t produce any code, it only affects the way
WLA interprets the immediate values (<code class="docutils literal notranslate"><span class="pre">8</span></code> for 8 bit operands, <code class="docutils literal notranslate"><span class="pre">16</span></code> for 16
bit operands) for opcodes dealing with the index registers.</p>
<p>So after giving <code class="docutils literal notranslate"><span class="pre">.INDEX</span> <span class="pre">8</span></code></p>
<blockquote>
<div><p>CPX #10</p>
</div></blockquote>
<p>will produce <code class="docutils literal notranslate"><span class="pre">$E0</span> <span class="pre">$A0</span></code>, and after giving <code class="docutils literal notranslate"><span class="pre">.INDEX</span> <span class="pre">16</span></code></p>
<blockquote>
<div><p>CPX #10</p>
</div></blockquote>
<p>will yield <code class="docutils literal notranslate"><span class="pre">$E0</span> <span class="pre">$00</span> <span class="pre">$A0</span></code>.</p>
<p>Note that <code class="docutils literal notranslate"><span class="pre">SEP</span></code>/<code class="docutils literal notranslate"><span class="pre">REP</span></code> again will in turn reset the accumulator/index
register size.</p>
<p>This is not a compulsory directive.</p>
</section>
<section id="input-name">
<h2><span class="section-number">2.111. </span><code class="docutils literal notranslate"><span class="pre">.INPUT</span> <span class="pre">NAME</span></code><a class="headerlink" href="#input-name" title="Permalink to this headline">¶</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">.INPUT</span></code> is much like any Basic-language input: <code class="docutils literal notranslate"><span class="pre">.INPUT</span></code> asks the user
for a value or string. After <code class="docutils literal notranslate"><span class="pre">.INPUT</span></code> is the variable name used to store
the data.</p>
<p><code class="docutils literal notranslate"><span class="pre">.INPUT</span></code> works like <code class="docutils literal notranslate"><span class="pre">.REDEFINE</span></code>, but the user gets to type in the data.</p>
<p>Here are few examples how to use input:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">.</span><span class="n">PRINTT</span> <span class="s2">&quot;The name of the ROM? &quot;</span>
<span class="o">.</span><span class="n">INPUT</span> <span class="n">NAME</span>
<span class="o">.</span><span class="n">NAME</span> <span class="n">NAME</span>

<span class="o">...</span>

<span class="o">.</span><span class="n">PRINTT</span> <span class="s2">&quot;Give the .DB amount.</span><span class="se">\n</span><span class="s2">&quot;</span>
<span class="o">.</span><span class="n">INPUT</span> <span class="n">S</span>
<span class="o">.</span><span class="n">PRINTT</span> <span class="s2">&quot;Give .DB data one at a time.</span><span class="se">\n</span><span class="s2">&quot;</span>
<span class="o">.</span><span class="n">REPEAT</span> <span class="n">S</span>
  <span class="o">.</span><span class="n">INPUT</span> <span class="n">B</span>
  <span class="o">.</span><span class="n">DB</span> <span class="n">B</span>
<span class="o">.</span><span class="n">ENDR</span>

<span class="o">...</span>
</pre></div>
</div>
<p>This is not a compulsory directive.</p>
</section>
<section id="licenseecodenew-1a">
<h2><span class="section-number">2.112. </span><code class="docutils literal notranslate"><span class="pre">.LICENSEECODENEW</span> <span class="pre">&quot;1A&quot;</span></code><a class="headerlink" href="#licenseecodenew-1a" title="Permalink to this headline">¶</a></h2>
<p>This is a standard new licensee code found at <code class="docutils literal notranslate"><span class="pre">$144</span></code> and <code class="docutils literal notranslate"><span class="pre">$145</span></code> in a
Gameboy ROM, and there this one is put to also. <code class="docutils literal notranslate"><span class="pre">.LICENSEECODENEW</span></code> cannot be
defined with .LICENSEECODEOLD. <code class="docutils literal notranslate"><span class="pre">$33</span></code> is inserted into <code class="docutils literal notranslate"><span class="pre">$14B</span></code>, as well.</p>
<p>This is not a compulsory directive.</p>
</section>
<section id="licenseecodeold-1a">
<h2><span class="section-number">2.113. </span><code class="docutils literal notranslate"><span class="pre">.LICENSEECODEOLD</span> <span class="pre">$1A</span></code><a class="headerlink" href="#licenseecodeold-1a" title="Permalink to this headline">¶</a></h2>
<p>This is a standard old licensee code found at <code class="docutils literal notranslate"><span class="pre">$14B</span></code> in a Gameboy ROM, and there
this one is put to also. <code class="docutils literal notranslate"><span class="pre">.LICENSEECODEOLD</span></code> cannot be defined with
<code class="docutils literal notranslate"><span class="pre">.LICENSEECODENEW</span></code>.</p>
<p>This is not a compulsory directive.</p>
</section>
<section id="long-102030-405060">
<h2><span class="section-number">2.114. </span><code class="docutils literal notranslate"><span class="pre">.LONG</span> <span class="pre">$102030,</span> <span class="pre">$405060</span></code><a class="headerlink" href="#long-102030-405060" title="Permalink to this headline">¶</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">.LONG</span></code> is an alias for <code class="docutils literal notranslate"><span class="pre">.DL</span></code>.</p>
<p>This is not a compulsory directive.</p>
</section>
<section id="lorom">
<h2><span class="section-number">2.115. </span><code class="docutils literal notranslate"><span class="pre">.LOROM</span></code><a class="headerlink" href="#lorom" title="Permalink to this headline">¶</a></h2>
<p>With this directive you can define the SNES ROM mode to be LoROM.
Issuing <code class="docutils literal notranslate"><span class="pre">.LOROM</span></code> will override the user’s ROM bank map when
WLALINK computes 24-bit addresses and bank references. If no
<code class="docutils literal notranslate"><span class="pre">.HIROM</span></code>, <code class="docutils literal notranslate"><span class="pre">.LOROM</span></code> or <code class="docutils literal notranslate"><span class="pre">.EXHIROM</span></code> are given then WLALINK obeys the
banking defined in <code class="docutils literal notranslate"><span class="pre">.ROMBANKMAP</span></code>.</p>
<p>WLA defaults to <code class="docutils literal notranslate"><span class="pre">.LOROM</span></code>.</p>
<p>This is not a compulsory directive.</p>
</section>
<section id="macro-test">
<h2><span class="section-number">2.116. </span><code class="docutils literal notranslate"><span class="pre">.MACRO</span> <span class="pre">TEST</span></code><a class="headerlink" href="#macro-test" title="Permalink to this headline">¶</a></h2>
<p>Begins a macro called <code class="docutils literal notranslate"><span class="pre">TEST</span></code>.</p>
<p>You can use <code class="docutils literal notranslate"><span class="pre">\&#64;</span></code> inside a macro to e.g., separate a label from the other
macro <code class="docutils literal notranslate"><span class="pre">TEST</span></code> occurrences. <code class="docutils literal notranslate"><span class="pre">\&#64;</span></code> is replaced with an integer number
indicating the amount of times the macro has been called previously so
it is unique to every macro call. <code class="docutils literal notranslate"><span class="pre">\&#64;</span></code> can also be used inside strings
inside a macro or just as a plain value. Look at the following examples
for more information.</p>
<p>You can also type <code class="docutils literal notranslate"><span class="pre">\!</span></code> to get the name of the source file currently being
parsed. <code class="docutils literal notranslate"><span class="pre">\.</span></code> can be used the same way to get the name of the macro.</p>
<p>Also, if you want to use macro arguments in e.g., calculation, you can
type <code class="docutils literal notranslate"><span class="pre">\X</span></code> where <code class="docutils literal notranslate"><span class="pre">X</span></code> is the number of the argument. Another way to refer
to the arguments is to use their names given in the definition of the
macro (see the examples for this).</p>
<p>Remember to use <code class="docutils literal notranslate"><span class="pre">.ENDM</span></code> to finish the macro definition. Note that you
cannot use <code class="docutils literal notranslate"><span class="pre">.INCLUDE</span></code> inside a macro. Note that WLA’s macros are in fact
more like procedures than real macros, because WLA doesn’t substitute
macro calls with macro data. Instead WLA jumps to the macro when it
encounters a macro call at compile time.</p>
<p>You can call macros from inside a macro. Note that the preprocessor
does not expand the macros. WLA traverses through the code according to
the macro calls.</p>
<p>Here are some examples:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">.</span><span class="n">MACRO</span> <span class="n">NOPMONSTER</span>
    <span class="o">.</span><span class="n">REPT</span> <span class="mi">32</span>         <span class="p">;</span> <span class="n">gives</span> <span class="n">us</span> <span class="mi">32</span> <span class="n">NOPs</span>
    <span class="n">NOP</span>
    <span class="o">.</span><span class="n">ENDR</span>
<span class="o">.</span><span class="n">ENDM</span>

<span class="o">.</span><span class="n">MACRO</span> <span class="n">LOAD_ABCD</span>
    <span class="n">LD</span> <span class="n">A</span><span class="p">,</span> \<span class="mi">1</span>
    <span class="n">LD</span> <span class="n">B</span><span class="p">,</span> \<span class="mi">2</span>
    <span class="n">LD</span> <span class="n">C</span><span class="p">,</span> \<span class="mi">3</span>
    <span class="n">LD</span> <span class="n">D</span><span class="p">,</span> <span class="p">:</span>\<span class="mi">4</span>        <span class="p">;</span> <span class="n">load</span> <span class="n">the</span> <span class="n">bank</span> <span class="n">number</span> <span class="n">of</span> \<span class="mi">4</span> <span class="n">into</span> <span class="n">register</span> <span class="n">D</span><span class="o">.</span>
    <span class="n">NOPMONSTER</span>       <span class="p">;</span> <span class="n">note</span> <span class="n">that</span> \<span class="mi">4</span> <span class="n">must</span> <span class="n">be</span> <span class="n">a</span> <span class="n">label</span> <span class="ow">or</span> <span class="n">ROM</span> <span class="n">address</span>
    <span class="n">LD</span> <span class="n">HL</span><span class="p">,</span> <span class="mi">1</span><span class="o">&lt;&lt;</span>\<span class="mi">1</span>     <span class="p">;</span> <span class="k">for</span> <span class="n">this</span> <span class="n">to</span> <span class="n">work</span><span class="o">...</span>
<span class="o">.</span><span class="n">INCBIN</span> \<span class="mi">5</span>
<span class="o">.</span><span class="n">ENDM</span>

<span class="o">.</span><span class="n">MACRO</span> <span class="n">QUEEN</span>

<span class="n">QUEEN</span>\<span class="o">@</span><span class="p">:</span>
    <span class="n">LD</span>   <span class="n">A</span><span class="p">,</span> \<span class="mi">1</span>
    <span class="n">LD</span>   <span class="n">B</span><span class="p">,</span> \<span class="mi">1</span>
    <span class="n">CALL</span> <span class="n">QUEEN</span>\<span class="o">@</span>

    <span class="o">.</span><span class="n">DB</span>  <span class="s2">&quot;\@&quot;</span><span class="p">,</span> <span class="mi">0</span>     <span class="p">;</span> <span class="n">will</span> <span class="n">translate</span> <span class="n">into</span> <span class="n">a</span> <span class="n">zero</span> <span class="n">terminated</span> <span class="n">string</span>
                     <span class="p">;</span> <span class="n">holding</span> <span class="n">the</span> <span class="n">amount</span> <span class="n">of</span> <span class="n">macro</span> <span class="n">QUEEN</span> <span class="n">calls</span><span class="o">.</span>
    <span class="o">.</span><span class="n">DB</span>  <span class="s2">&quot;</span><span class="se">\\</span><span class="s2">@&quot;</span><span class="p">,</span> <span class="mi">0</span>    <span class="p">;</span> <span class="n">will</span> <span class="n">translate</span> <span class="n">into</span> <span class="n">a</span> <span class="n">string</span> <span class="n">containing</span>
                     <span class="p">;</span> \<span class="o">@.</span>
    <span class="o">.</span><span class="n">DB</span>  \<span class="o">@</span>          <span class="p">;</span> <span class="n">will</span> <span class="n">translate</span> <span class="n">into</span> <span class="n">a</span> <span class="n">number</span> <span class="n">indicating</span>
                     <span class="p">;</span> <span class="n">the</span> <span class="n">amount</span> <span class="n">of</span> <span class="n">macro</span> <span class="n">QUEEN</span> <span class="n">calls</span><span class="o">.</span>

<span class="o">.</span><span class="n">ENDM</span>

<span class="o">.</span><span class="n">MACRO</span> <span class="n">LOAD_ABCD_2</span> <span class="n">ARGS</span> <span class="n">ONE</span><span class="p">,</span> <span class="n">TWO</span><span class="p">,</span> <span class="n">THREE</span><span class="p">,</span> <span class="n">FOUR</span><span class="p">,</span> <span class="n">FIVE</span>
    <span class="n">LD</span> <span class="n">A</span><span class="p">,</span> <span class="n">ONE</span>
    <span class="n">LD</span> <span class="n">B</span><span class="p">,</span> <span class="n">TWO</span>
    <span class="n">LD</span> <span class="n">C</span><span class="p">,</span> <span class="n">THREE</span>
    <span class="n">LD</span> <span class="n">D</span><span class="p">,</span> <span class="n">FOUR</span>
    <span class="n">NOPMONSTER</span>
    <span class="n">LD</span> <span class="n">HL</span><span class="p">,</span> <span class="mi">1</span><span class="o">&lt;&lt;</span><span class="n">ONE</span>
<span class="o">.</span><span class="n">INCBIN</span> <span class="n">FIVE</span>
<span class="o">.</span><span class="n">ENDM</span>
</pre></div>
</div>
<p>And here’s how they can be used:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>NOPMONSTER
LOAD_ABCD $10, $20, $30, XYZ, &quot;merman.bin&quot;
QUEEN 123
LOAD_ABCD_2 $10, $20, $30, XYZ, &quot;merman.bin&quot;
</pre></div>
</div>
<p>Note that you must separate the arguments with commas.</p>
<p>Note that the following works as well:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>.DEF prev_test $0000

.MACRO .test ARGS str
__\._{\@+1}:                   ; this will become __.test_1 during
    .PRINT __\._{\@+1}, &quot;\n&quot;   ; the first call, __.test_2 during the
    .WORD  prev_test           ; second call...
    .REDEF prev_test __\._{\@+1}
    .BYTE  str.length, str, 0
.ENDM
</pre></div>
</div>
<p>If you want to give names to the macro’s arguments you can do that
by listing them in order after supplying ARGS after the macro’s name.</p>
<p>Every time a macro is called a definition <code class="docutils literal notranslate"><span class="pre">NARGS</span></code> is created. It shows
only inside the macro and holds the number of arguments the macro
was called with. So don’t have your own definition called <code class="docutils literal notranslate"><span class="pre">NARGS</span></code>.
Here’s an example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">.</span><span class="n">MACRO</span> <span class="n">LUPIN</span>
  <span class="o">.</span><span class="n">IF</span> <span class="n">NARGS</span> <span class="o">!=</span> <span class="mi">1</span>
    <span class="o">.</span><span class="n">FAIL</span>
  <span class="o">.</span><span class="n">ENDIF</span>

  <span class="o">.</span><span class="n">PRINTT</span> <span class="s2">&quot;Totsan! Ogenki ka?</span><span class="se">\n</span><span class="s2">&quot;</span>
<span class="o">.</span><span class="n">ENDM</span>
</pre></div>
</div>
<p>You can also use <code class="docutils literal notranslate"><span class="pre">\?</span></code> to ask for the type of the argument in the
following fashion:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>.macro .differentThings
  .if \?1 == ARG_IMMEDIATE
    .db \1
  .elif \?1 == ARG_NUMBER
    .db 1
  .elif \?1 == ARG_STRING
    .db 2
  .elif \?1 == ARG_LABEL
    .db 3
  .elif \?1 == ARG_PENDING_CALCULATION
    .db 4
  .endif
.endm

.section &quot;TestingDifferentThings&quot;
TDT1:
    .differentThings 100
    .differentThings &quot;HELLO&quot;
    .differentThings TDT1
    .differentThings TDT1+1
    .differentThings #0
.ends
</pre></div>
</div>
<p>The previous example will result in .db 1, 2, 3, 4, 0</p>
<p>Here’s another useful example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>.DEFINE DEFINITION_A 1

.MACRO REDEFINER
.REDEFINE \1 = ?1 + 1      ; \1 here is the definition&#39;s name,
.ENDM                      ; and ?1 is its value.

REDEFINER &amp;DEFINITION_A    ; here we feed the definition&#39;s name
                           ; as first argument, not it&#39;s value
</pre></div>
</div>
<p>Another useful example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">.</span><span class="n">MACRO</span> <span class="n">LOOP</span> <span class="n">ISOLATED</span>
   <span class="n">LD</span> <span class="n">A</span><span class="p">,</span> <span class="mi">10</span>
<span class="o">-</span>  <span class="n">DEC</span> <span class="n">A</span>                   <span class="p">;</span> <span class="n">B</span>
   <span class="n">JP</span> <span class="n">NZ</span><span class="p">,</span> <span class="o">-</span>
<span class="o">.</span><span class="n">ENDM</span>

<span class="o">...</span>
   <span class="n">LD</span> <span class="n">B</span><span class="p">,</span> <span class="mi">20</span>
<span class="o">-</span>  <span class="n">LOOP</span>                    <span class="p">;</span> <span class="n">C</span>
   <span class="n">DEC</span> <span class="n">B</span>
   <span class="n">JP</span> <span class="n">NZ</span><span class="p">,</span> <span class="o">-</span>                <span class="p">;</span> <span class="n">A</span>
<span class="o">...</span>
</pre></div>
</div>
<p>Here we use the keyword <code class="docutils literal notranslate"><span class="pre">ISOLATED</span></code> to make un-named labels inside the
macro to be isolated from the outside world. Without it the jump in A
would jump to B, but now it jumps to C.</p>
<p>Using the keyword <code class="docutils literal notranslate"><span class="pre">ISOLATED</span></code> we would also make the macro to have its own
child label stack:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>        <span class="o">.</span><span class="n">macro</span> <span class="n">MACROM</span>
<span class="n">AA03</span><span class="p">:</span>   <span class="o">.</span><span class="n">db</span> <span class="mi">0</span>
<span class="nd">@child</span><span class="p">:</span> <span class="o">.</span><span class="n">db</span> <span class="mi">1</span>          <span class="p">;</span> <span class="n">A</span>
        <span class="o">.</span><span class="n">dw</span> <span class="nd">@child</span>     <span class="p">;</span> <span class="n">B</span>
        <span class="o">.</span><span class="n">endm</span>

<span class="n">AA00</span><span class="p">:</span>   <span class="o">.</span><span class="n">db</span> <span class="s2">&quot;25&gt;&quot;</span>
<span class="nd">@child</span><span class="p">:</span> <span class="n">MACROM</span>         <span class="p">;</span> <span class="n">C</span>
        <span class="o">.</span><span class="n">dw</span> <span class="nd">@child</span>     <span class="p">;</span> <span class="n">D</span>
        <span class="o">.</span><span class="n">db</span> <span class="s2">&quot;&lt;25&quot;</span>
</pre></div>
</div>
<p>In this case B points to A and D points to A. If you add keyword <code class="docutils literal notranslate"><span class="pre">ISOLATED</span></code>
to <code class="docutils literal notranslate"><span class="pre">.MACRO</span></code> MACROM then B still points to A, but A doesn’t bleed out of MACROM
and D points to C. Exiting a <code class="docutils literal notranslate"><span class="pre">.MACRO</span></code> that uses keyword <code class="docutils literal notranslate"><span class="pre">ISOLATED</span></code> restores
the child label stack.</p>
<p>One example more, but this time with local labels:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>        <span class="o">.</span><span class="n">macro</span> <span class="n">LOCALS</span> <span class="n">isolated</span>
<span class="n">_hello</span><span class="p">:</span> <span class="o">.</span><span class="n">db</span> <span class="mi">0</span>            <span class="p">;</span> <span class="n">A</span>
        <span class="o">.</span><span class="n">dw</span> <span class="n">_hello</span> <span class="o">+</span> <span class="mi">1</span>   <span class="p">;</span> <span class="n">B</span>
        <span class="o">.</span><span class="n">endm</span>

<span class="n">_hello</span><span class="p">:</span> <span class="o">.</span><span class="n">db</span> <span class="s2">&quot;27&gt;&quot;</span>        <span class="p">;</span> <span class="n">C</span>
        <span class="o">.</span><span class="n">db</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span>
        <span class="n">LOCALS</span>
        <span class="o">.</span><span class="n">dw</span> <span class="n">_hello</span> <span class="o">+</span> <span class="mi">2</span>   <span class="p">;</span> <span class="n">D</span>
        <span class="o">.</span><span class="n">db</span> <span class="s2">&quot;&lt;27&quot;</span>
</pre></div>
</div>
<p>Normally this would create the local label <code class="docutils literal notranslate"><span class="pre">_hello</span></code> twice and it would not
work. Adding the keyword <code class="docutils literal notranslate"><span class="pre">ISOLATED</span></code> to <code class="docutils literal notranslate"><span class="pre">.MACRO</span></code> makes the local labels
unique and D points to C and B points to A.</p>
<p>To enable only local label isolation use the keyword <code class="docutils literal notranslate"><span class="pre">ISOLATELOCAL</span></code> instead of
<code class="docutils literal notranslate"><span class="pre">ISOLATED</span></code> and to enable only the isolation of un-named labels use the keyword
<code class="docutils literal notranslate"><span class="pre">ISOLATEUNNAMED</span></code>.</p>
<p>This is not a compulsory directive.</p>
</section>
<section id="memorymap">
<h2><span class="section-number">2.117. </span><code class="docutils literal notranslate"><span class="pre">.MEMORYMAP</span></code><a class="headerlink" href="#memorymap" title="Permalink to this headline">¶</a></h2>
<p>Begins the memory map definition. Using <code class="docutils literal notranslate"><span class="pre">.MEMORYMAP</span></code> you must first
describe the target system’s memory architecture to WLA before it
can start to compile the code. <code class="docutils literal notranslate"><span class="pre">.MEMORYMAP</span></code> gives you the freedom to
use WLA to compile data for numerous different real systems.</p>
<p>Examples:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>.MEMORYMAP
DEFAULTSLOT 0
SLOTSIZE $4000
SLOT 0 $0000
SLOT 1 $4000
.ENDME

.MEMORYMAP
DEFAULTSLOT 0
SLOT 0 $0000 $4000 &quot;ROMSlot&quot;
SLOT 1 $4000 $4000 &quot;RAMSlot&quot;
.ENDME

.MEMORYMAP
DEFAULTSLOT 0
SLOT 0 START $0000 SIZE $4000 NAME &quot;ROMSlot&quot;
SLOT 1 START $4000 SIZE $4000 NAME &quot;RAMSlot&quot;
.ENDME

.MEMORYMAP
DEFAULTSLOT 1
SLOTSIZE $6000
SLOT 0 $0000
SLOTSIZE $2000
SLOT 1 $6000
SLOT 2 $8000
.ENDME
</pre></div>
</div>
<p>Here’s a real life example from Adam Klotblixt. It should be interesting
for all the ZX81 coders:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>...

.MEMORYMAP
DEFAULTSLOT 1
SLOTSIZE $2000
SLOT 0 $0000
SLOTSIZE $6000
SLOT 1 $2000
.ENDME

.ROMBANKMAP
BANKSTOTAL 2
BANKSIZE $2000
BANKS 1
BANKSIZE $6000
BANKS 1
.ENDRO

.BANK 1 SLOT 1
.ORGA $2000

...
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">SLOTSIZE</span></code> defines the size of the following slots, unless you explicitly
specify the size of the slot, like in the second and third examples. You
can redefine <code class="docutils literal notranslate"><span class="pre">SLOTSIZE</span></code> as many times as you wish.</p>
<p><code class="docutils literal notranslate"><span class="pre">DEFAULTSLOT</span></code> describes the default slot for banks which aren’t explicitly
inserted anywhere. Check <code class="docutils literal notranslate"><span class="pre">.BANK</span></code> definition for more information.</p>
<p><code class="docutils literal notranslate"><span class="pre">SLOT</span></code> defines a slot and its starting address. <code class="docutils literal notranslate"><span class="pre">SLOT</span></code> numbering starts at
<code class="docutils literal notranslate"><span class="pre">0</span></code> and ends to <code class="docutils literal notranslate"><span class="pre">255</span></code> so you have 256 slots at your disposal.</p>
<p>This is a compulsory directive, and make sure all the object files share
the same <code class="docutils literal notranslate"><span class="pre">.MEMORYMAP</span></code> or you can’t link them together.</p>
</section>
<section id="name-name-of-the-rom">
<h2><span class="section-number">2.118. </span><code class="docutils literal notranslate"><span class="pre">.NAME</span> <span class="pre">&quot;NAME</span> <span class="pre">OF</span> <span class="pre">THE</span> <span class="pre">ROM&quot;</span></code><a class="headerlink" href="#name-name-of-the-rom" title="Permalink to this headline">¶</a></h2>
<p>If <code class="docutils literal notranslate"><span class="pre">.NAME</span></code> is used with WLA-GB then the 16 bytes ranging from <code class="docutils literal notranslate"><span class="pre">$0134</span></code>
to <code class="docutils literal notranslate"><span class="pre">$0143</span></code> are filled with the provided string. WLA-65816 fills
the 21 bytes from <code class="docutils literal notranslate"><span class="pre">$FFC0</span></code> to <code class="docutils literal notranslate"><span class="pre">$FFD4</span></code> in HiROM and from <code class="docutils literal notranslate"><span class="pre">$7FC0</span></code> to
<code class="docutils literal notranslate"><span class="pre">$7FD4</span></code> in LoROM mode with the name string (SNES ROM title). For ExHiROM
the ranges are from <code class="docutils literal notranslate"><span class="pre">$40FFC0</span></code> to <code class="docutils literal notranslate"><span class="pre">$40FFD4</span></code> and from <code class="docutils literal notranslate"><span class="pre">$FFC0</span></code> to <code class="docutils literal notranslate"><span class="pre">$FFD4</span></code>
(mirrored).</p>
<p>If the string is shorter than 16/21 bytes the remaining space is
filled with <code class="docutils literal notranslate"><span class="pre">$00</span></code>.</p>
<p>This is not a compulsory directive.</p>
</section>
<section id="nextu-name">
<h2><span class="section-number">2.119. </span><code class="docutils literal notranslate"><span class="pre">.NEXTU</span> <span class="pre">name</span></code><a class="headerlink" href="#nextu-name" title="Permalink to this headline">¶</a></h2>
<p>Proceeds to the next entry in a union.</p>
</section>
<section id="nintendologo">
<h2><span class="section-number">2.120. </span><code class="docutils literal notranslate"><span class="pre">.NINTENDOLOGO</span></code><a class="headerlink" href="#nintendologo" title="Permalink to this headline">¶</a></h2>
<p>Places the required Nintendo logo into the Gameboy ROM at <code class="docutils literal notranslate"><span class="pre">$104</span></code>.</p>
<p>This is not a compulsory directive.</p>
</section>
<section id="nowdc">
<h2><span class="section-number">2.121. </span><code class="docutils literal notranslate"><span class="pre">.NOWDC</span></code><a class="headerlink" href="#nowdc" title="Permalink to this headline">¶</a></h2>
<p>Turns WLA-65816 into a mode where it accepts its default syntax assembly
code, which doesn’t support WDC standard. This is the default mode for
WLA-65816.</p>
<p>This is not a compulsory directive.</p>
</section>
<section id="org-150">
<h2><span class="section-number">2.122. </span><code class="docutils literal notranslate"><span class="pre">.ORG</span> <span class="pre">$150</span></code><a class="headerlink" href="#org-150" title="Permalink to this headline">¶</a></h2>
<p>Defines the starting address. The value supplied here is relative to the
ROM bank given with <code class="docutils literal notranslate"><span class="pre">.BANK</span></code>.</p>
<p>When WLA starts to parse a source file, <code class="docutils literal notranslate"><span class="pre">.ORG</span></code> is set to <code class="docutils literal notranslate"><span class="pre">$0</span></code>, but it’s
always a good idea to explicitly use <code class="docutils literal notranslate"><span class="pre">.ORG</span></code>, for clarity.</p>
<p>This is a compulsory directive.</p>
</section>
<section id="orga-150">
<h2><span class="section-number">2.123. </span><code class="docutils literal notranslate"><span class="pre">.ORGA</span> <span class="pre">$150</span></code><a class="headerlink" href="#orga-150" title="Permalink to this headline">¶</a></h2>
<p>Defines the starting address. The value supplied here is absolute and used
directly in address computations. WLA computes the right position in
ROM file. By using <code class="docutils literal notranslate"><span class="pre">.ORGA</span></code> you can instantly see from the source file where
the following code is located in the 16-bit memory.</p>
<p>Here’s an example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>.MEMORYMAP
SLOTSIZE $4000
DEFAULTSLOT 0
SLOT 0 $0000
SLOT 1 $4000
.ENDME

.ROMBANKMAP
BANKSTOTAL 2
BANKSIZE $4000
BANKS 2
.ENDRO

.BANK 0 SLOT 1
.ORGA $4000

MAIN:       JP      MAIN
</pre></div>
</div>
<p>Here <code class="docutils literal notranslate"><span class="pre">MAIN</span></code> is at <code class="docutils literal notranslate"><span class="pre">$0000</span></code> in the ROM file, but the address for label
<code class="docutils literal notranslate"><span class="pre">MAIN</span></code> is <code class="docutils literal notranslate"><span class="pre">$4000</span></code>. By using <code class="docutils literal notranslate"><span class="pre">.ORGA</span></code> instead of <code class="docutils literal notranslate"><span class="pre">.ORG</span></code>, you can directly
see from the value the address where you want the code to be as <code class="docutils literal notranslate"><span class="pre">.ORG</span></code> is
just an offset to the <code class="docutils literal notranslate"><span class="pre">SLOT</span></code>.</p>
</section>
<section id="outname-other-o">
<h2><span class="section-number">2.124. </span><code class="docutils literal notranslate"><span class="pre">.OUTNAME</span> <span class="pre">&quot;other.o&quot;</span></code><a class="headerlink" href="#outname-other-o" title="Permalink to this headline">¶</a></h2>
<p>Changes the name of the output file. Here’s an example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">wla</span><span class="o">-</span><span class="n">gb</span> <span class="o">-</span><span class="n">o</span> <span class="n">test</span><span class="o">.</span><span class="n">o</span> <span class="n">test</span><span class="o">.</span><span class="n">s</span>
</pre></div>
</div>
<p>would normally output <code class="docutils literal notranslate"><span class="pre">test.o</span></code>, but if you had written:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">.</span><span class="n">OUTNAME</span> <span class="s2">&quot;new.o&quot;</span>
</pre></div>
</div>
<p>somewhere in the code WLA would write the output to <code class="docutils literal notranslate"><span class="pre">new.o</span></code> instead.</p>
<p>This is not a compulsory directive.</p>
</section>
<section id="print-numbers-1-and-10-dec-1-hex-10-n">
<h2><span class="section-number">2.125. </span><code class="docutils literal notranslate"><span class="pre">.PRINT</span> <span class="pre">&quot;Numbers</span> <span class="pre">1</span> <span class="pre">and</span> <span class="pre">10:</span> <span class="pre">&quot;,</span> <span class="pre">DEC</span> <span class="pre">1,</span> <span class="pre">&quot;</span> <span class="pre">$&quot;,</span> <span class="pre">HEX</span> <span class="pre">10,</span> <span class="pre">&quot;\n&quot;</span></code><a class="headerlink" href="#print-numbers-1-and-10-dec-1-hex-10-n" title="Permalink to this headline">¶</a></h2>
<p>Prints strings and numbers to stdout. A combination and a more usable version
of .PRINTT and .PRINTV. Useful for debugging.</p>
<p>Optional: Give <code class="docutils literal notranslate"><span class="pre">DEC</span></code> (decimal) or <code class="docutils literal notranslate"><span class="pre">HEX</span></code> (hexadecimal) before the value you
want to print.</p>
<p>This is not a compulsory directive.</p>
</section>
<section id="printt-here-we-are-n">
<h2><span class="section-number">2.126. </span><code class="docutils literal notranslate"><span class="pre">.PRINTT</span> <span class="pre">&quot;Here</span> <span class="pre">we</span> <span class="pre">are...\n&quot;</span></code><a class="headerlink" href="#printt-here-we-are-n" title="Permalink to this headline">¶</a></h2>
<p>Prints the given text into stdout. Good for debugging stuff. <code class="docutils literal notranslate"><span class="pre">PRINTT</span></code> takes
only a string as argument, and the only supported formatting symbol is <code class="docutils literal notranslate"><span class="pre">\n</span></code>
(line feed).</p>
<p>This is not a compulsory directive.</p>
</section>
<section id="printv-dec-debug-1">
<h2><span class="section-number">2.127. </span><code class="docutils literal notranslate"><span class="pre">.PRINTV</span> <span class="pre">DEC</span> <span class="pre">DEBUG+1</span></code><a class="headerlink" href="#printv-dec-debug-1" title="Permalink to this headline">¶</a></h2>
<p>Prints the value of the supplied definition or computation into stdout.
Computation must be solvable at the time of printing (just like definitions
values). <code class="docutils literal notranslate"><span class="pre">PRINTV</span></code> takes max two parameters. The first describes the type of the
print output. <code class="docutils literal notranslate"><span class="pre">DEC</span></code> means decimal, <code class="docutils literal notranslate"><span class="pre">HEX</span></code> means hexadecimal. This is optional.
Default is <code class="docutils literal notranslate"><span class="pre">DEC</span></code>.</p>
<p>Use <code class="docutils literal notranslate"><span class="pre">PRINTV</span></code> with <code class="docutils literal notranslate"><span class="pre">PRINTT</span></code> as <code class="docutils literal notranslate"><span class="pre">PRINTV</span></code> doesn’t print linefeeds, only the
result. Here’s an example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">.</span><span class="n">PRINTT</span> <span class="s2">&quot;Value of </span><span class="se">\&quot;</span><span class="s2">DEBUG</span><span class="se">\&quot;</span><span class="s2"> = $&quot;</span>
<span class="o">.</span><span class="n">PRINTV</span> <span class="n">HEX</span> <span class="n">DEBUG</span>
<span class="o">.</span><span class="n">PRINTT</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>
</pre></div>
</div>
<p>This is not a compulsory directive.</p>
</section>
<section id="ramsection-vars-bank-0-slot-1-align-256-offset-32">
<h2><span class="section-number">2.128. </span><code class="docutils literal notranslate"><span class="pre">.RAMSECTION</span> <span class="pre">&quot;Vars&quot;</span> <span class="pre">BANK</span> <span class="pre">0</span> <span class="pre">SLOT</span> <span class="pre">1</span> <span class="pre">ALIGN</span> <span class="pre">256</span> <span class="pre">OFFSET</span> <span class="pre">32</span></code><a class="headerlink" href="#ramsection-vars-bank-0-slot-1-align-256-offset-32" title="Permalink to this headline">¶</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">RAMSECTION</span></code> s accept only variable labels and variable sizes, and the
syntax to define these is identical to <code class="docutils literal notranslate"><span class="pre">.ENUM</span></code> (all the syntax rules that
apply to <code class="docutils literal notranslate"><span class="pre">.ENUM</span></code> apply also to <code class="docutils literal notranslate"><span class="pre">.RAMSECTION</span></code>). Additionally you can embed
structures (<code class="docutils literal notranslate"><span class="pre">.STRUCT</span></code>) into a <code class="docutils literal notranslate"><span class="pre">RAMSECTION</span></code>. Here’s an example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">.</span><span class="n">RAMSECTION</span> <span class="s2">&quot;Some of my variables&quot;</span> <span class="n">BANK</span> <span class="mi">0</span> <span class="n">SLOT</span> <span class="mi">1</span> <span class="n">RETURNORG</span> <span class="n">PRIORITY</span> <span class="mi">100</span>
<span class="n">vbi_counter</span><span class="p">:</span>   <span class="n">db</span>
<span class="n">player_lives</span><span class="p">:</span>  <span class="n">db</span>
<span class="o">.</span><span class="n">ENDS</span>
</pre></div>
</div>
<p>By default <code class="docutils literal notranslate"><span class="pre">RAMSECTION</span></code> s behave like <code class="docutils literal notranslate"><span class="pre">FREE</span></code> sections, but instead of
filling any banks RAM sections will occupy RAM banks inside slots. You can
fill different slots with different variable labels. It’s recommend that
you create separate slots for holding variables (as ROM and RAM don’t
usually overlap).</p>
<p>If you want that WLA returns the <code class="docutils literal notranslate"><span class="pre">ORG</span></code> to what it was before issuing
the <code class="docutils literal notranslate"><span class="pre">RAMSECTION</span></code>, use the keyword <code class="docutils literal notranslate"><span class="pre">RETURNORG</span></code>.</p>
<p>Keyword <code class="docutils literal notranslate"><span class="pre">PRIORITY</span></code> means just the same as <code class="docutils literal notranslate"><span class="pre">PRIORITY</span></code> of a <code class="docutils literal notranslate"><span class="pre">.SECTION</span></code>,
it is used to prioritize some sections when placing them in the output ROM/PRG.
The <code class="docutils literal notranslate"><span class="pre">RAMSECTION</span></code> s with higher <code class="docutils literal notranslate"><span class="pre">PRIORITY</span></code> are placed first in the output,
and if the priorities match, then bigger <code class="docutils literal notranslate"><span class="pre">RAMSECTION</span></code> s are placed first.</p>
<p>NOTE! Currently WLA-DX assumes that there are 256 RAM banks available for
each slot in the memory map. There is no other way to limit this number at the
moment than manually keep the <code class="docutils literal notranslate"><span class="pre">BANK</span></code> number inside real limits.</p>
<p>Anyway, here’s another example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>.MEMORYMAP
SLOTSIZE $4000
DEFAULTSLOT 0
SLOT 0 $0000           ; ROM slot 0.
SLOT 1 $4000           ; ROM slot 1.
SLOT 2 $A000 &quot;RAMSlot&quot; ; variable RAM is here!
.ENDME

.STRUCT game_object
x DB
y DB
.ENDST

.RAMSECTION &quot;vars 1&quot; BANK 0 SLOT 2
moomin1   DW
phantom   DB
nyanko    DB
enemy     INSTANCEOF game_object
.ENDS

.RAMSECTION &quot;vars 2&quot; BANK 1 SLOT &quot;RAMSlot&quot;  ; Here we use slot 2
moomin2   DW
.ENDS

.RAMSECTION &quot;vars 3&quot; BANK 1 SLOT $A000      ; Slot 2 here as well...
moomin3_all .DSB 3
moomin3_a    DB
moomin3_b    DB
moomin3_c    DB
.ENDS

.RAMSECTION &quot;vars 4&quot; BANK 1 SLOT $A000
enemies      INSTANCEOF game_object 2 STARTFROM 0 ; If you leave away &quot;STARTFROM 0&quot; the indexing will start from 1
.ENDS
</pre></div>
</div>
<p>If no other RAM sections are used, then this is what you will get:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>.DEFINE moomin1     $A000
.DEFINE phantom     $A002
.DEFINE nyanko      $A003
.DEFINE enemy       $A004
.DEFINE enemy.x     $A004
.DEFINE enemy.y     $A005
.DEFINE moomin2     $A000
.DEFINE moomin3_all $A002
.DEFINE moomin3_a   $A002
.DEFINE moomin3_b   $A003
.DEFINE moomin3_c   $A004
.DEFINE enemies     $A005
.DEFINE enemies.0   $A005
.DEFINE enemies.0.x $A005
.DEFINE enemies.0.y $A006
.DEFINE enemies.1   $A007
.DEFINE enemies.1.x $A007
.DEFINE enemies.1.y $A008
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">BANK</span></code> in <code class="docutils literal notranslate"><span class="pre">.RAMSECTION</span></code> is optional so you can leave it away if you
don’t switch RAM banks, or the target doesn’t have them (defaults to 0).</p>
<p>NOTE! The generated _sizeof_ labels for <code class="docutils literal notranslate"><span class="pre">.RAMSECTION</span></code> “vars 3” will be:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">_sizeof_moomin3_all</span> <span class="p">(</span><span class="o">==</span> <span class="mi">3</span><span class="p">)</span>
<span class="n">_sizeof_moomin3_a</span>   <span class="p">(</span><span class="o">==</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">_sizeof_moomin3_b</span>   <span class="p">(</span><span class="o">==</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">_sizeof_moomin3_c</span>   <span class="p">(</span><span class="o">==</span> <span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<p>Going back to the previous example, if you wanted to make the size of all
instances of <code class="docutils literal notranslate"><span class="pre">game_object</span></code> to be 8 (bytes) in <code class="docutils literal notranslate"><span class="pre">enemies</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>.RAMSECTION &quot;vars 4&quot; BANK 1 SLOT $A000
enemies      INSTANCEOF game_object SIZE 8 COUNT 2 STARTFROM 0
.ENDS
</pre></div>
</div>
<p>Use the keyword <code class="docutils literal notranslate"><span class="pre">SIZE</span></code> to do that. Also note that the keyword <code class="docutils literal notranslate"><span class="pre">COUNT</span></code>
is optional, and recommended.</p>
<p>It is also possible to merge two or more sections using <code class="docutils literal notranslate"><span class="pre">APPENDTO</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">.</span><span class="n">RAMSECTION</span> <span class="s2">&quot;RAMSection1&quot;</span> <span class="n">BANK</span> <span class="mi">0</span> <span class="n">SLOT</span> <span class="mi">0</span>
<span class="n">label1</span>    <span class="n">DB</span>
<span class="o">.</span><span class="n">ENDS</span>

<span class="o">.</span><span class="n">RAMSECTION</span> <span class="s2">&quot;RAMSection2&quot;</span> <span class="n">APPENDTO</span> <span class="s2">&quot;RAMSection1&quot;</span>
<span class="n">label2</span>    <span class="n">DB</span>
<span class="o">.</span><span class="n">ENDS</span>
</pre></div>
</div>
<p>If you wist to skip some bytes without giving them labels, use <code class="docutils literal notranslate"><span class="pre">.</span></code> as
a label:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">.</span><span class="n">RAMSECTION</span> <span class="s2">&quot;ZERO_PAGE&quot;</span> <span class="n">BANK</span> <span class="mi">0</span> <span class="n">SLOT</span> <span class="mi">0</span>
<span class="n">UsingThisByte1</span><span class="p">:</span> <span class="n">DB</span>
<span class="o">.</span>               <span class="n">DB</span> <span class="p">;</span> <span class="n">RESERVED</span>
<span class="o">.</span>               <span class="n">DB</span> <span class="p">;</span> <span class="n">RESERVED</span>
<span class="n">UsingThisByte2</span><span class="p">:</span> <span class="n">DB</span>
<span class="o">.</span>               <span class="n">DB</span> <span class="p">;</span> <span class="n">RESERVED</span>
<span class="n">UsingThisByte3</span><span class="p">:</span> <span class="n">DB</span>
<span class="o">.</span><span class="n">ENDS</span>
</pre></div>
</div>
<p>If you want to use <code class="docutils literal notranslate"><span class="pre">FORCE</span></code> RAMSECTIONs that are fixed to a specified
address, do as follows:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>.RAMSECTION &quot;FixedRAMSection&quot; BANK 0 SLOT 0 ORGA $0 FORCE
.               DB ; SYSTEM RESERVED
.               DB ; SYSTEM RESERVED
PlayerX         DB
PlayerY         DB
.ENDS
</pre></div>
</div>
<p>Other types that are supported: <code class="docutils literal notranslate"><span class="pre">SEMIFREE</span></code> and <code class="docutils literal notranslate"><span class="pre">SEMISUBFREE</span></code>.</p>
<p>Here’s the order in which WLA writes the RAM sections:</p>
<ol class="arabic simple">
<li><p><code class="docutils literal notranslate"><span class="pre">FORCE</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">SEMISUBFREE</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">SEMIFREE</span></code> &amp; <code class="docutils literal notranslate"><span class="pre">FREE</span></code></p></li>
</ol>
<p>NOTE: You can use <code class="docutils literal notranslate"><span class="pre">ORGA</span></code> to specify the fixed address for a <code class="docutils literal notranslate"><span class="pre">FORCE</span></code>
<code class="docutils literal notranslate"><span class="pre">RAMSECTION</span></code>. <code class="docutils literal notranslate"><span class="pre">ORG</span></code> is also supported.</p>
<p>NOTE: When you have <code class="docutils literal notranslate"><span class="pre">RAMSECTION</span></code> s inside libraries, you must give
them BANKs and SLOTs in the linkfile, under [ramsections].</p>
<p>NOTE: <code class="docutils literal notranslate"><span class="pre">WINDOW</span></code> and <code class="docutils literal notranslate"><span class="pre">BITWINDOW</span></code> work also with <code class="docutils literal notranslate"><span class="pre">.RAMSECTION</span></code> s.</p>
<p>This is not a compulsory directive.</p>
</section>
<section id="ramsize-0">
<h2><span class="section-number">2.129. </span><code class="docutils literal notranslate"><span class="pre">.RAMSIZE</span> <span class="pre">0</span></code><a class="headerlink" href="#ramsize-0" title="Permalink to this headline">¶</a></h2>
<p>Indicates the size of the RAM. This is a standard Gameboy RAM size indicator
value found at <code class="docutils literal notranslate"><span class="pre">$149</span></code> in a Gameboy ROM, and there this one is put to also.</p>
<p>This is not a compulsory directive.</p>
</section>
<section id="redef-if-0f">
<h2><span class="section-number">2.130. </span><code class="docutils literal notranslate"><span class="pre">.REDEF</span> <span class="pre">IF</span> <span class="pre">$0F</span></code><a class="headerlink" href="#redef-if-0f" title="Permalink to this headline">¶</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">.REDEF</span></code> is an alias for <code class="docutils literal notranslate"><span class="pre">.REDEFINE</span></code>.</p>
<p>This is not a compulsory directive.</p>
</section>
<section id="redefine-if-0f">
<h2><span class="section-number">2.131. </span><code class="docutils literal notranslate"><span class="pre">.REDEFINE</span> <span class="pre">IF</span> <span class="pre">$0F</span></code><a class="headerlink" href="#redefine-if-0f" title="Permalink to this headline">¶</a></h2>
<p>Assigns a new value or a string to an old definition. If the
definition doesn’t exist, <code class="docutils literal notranslate"><span class="pre">.REDEFINE</span></code> performs <code class="docutils literal notranslate"><span class="pre">.DEFINE</span></code>’s work.</p>
<p>When used with <code class="docutils literal notranslate"><span class="pre">.REPT</span></code> <code class="docutils literal notranslate"><span class="pre">REDEFINE</span></code> helps creating tables:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">.</span><span class="n">DEFINE</span> <span class="n">CNT</span> <span class="mi">0</span>

<span class="o">.</span><span class="n">REPT</span> <span class="mi">256</span>
<span class="o">.</span><span class="n">DB</span> <span class="n">CNT</span>
<span class="o">.</span><span class="n">REDEFINE</span> <span class="n">CNT</span> <span class="n">CNT</span><span class="o">+</span><span class="mi">1</span>
<span class="o">.</span><span class="n">ENDR</span>
</pre></div>
</div>
<p>This is not a compulsory directive.</p>
</section>
<section id="repeat-6">
<h2><span class="section-number">2.132. </span><code class="docutils literal notranslate"><span class="pre">.REPEAT</span> <span class="pre">6</span></code><a class="headerlink" href="#repeat-6" title="Permalink to this headline">¶</a></h2>
<p>Repeats the text enclosed between <code class="docutils literal notranslate"><span class="pre">.REPEAT</span> <span class="pre">x</span></code> and <code class="docutils literal notranslate"><span class="pre">.ENDR</span></code> <code class="docutils literal notranslate"><span class="pre">x</span></code> times
(<code class="docutils literal notranslate"><span class="pre">6</span></code> in this example). You can use <code class="docutils literal notranslate"><span class="pre">.REPEAT</span></code> s inside <code class="docutils literal notranslate"><span class="pre">.REPEAT</span></code> s.
<code class="docutils literal notranslate"><span class="pre">x</span></code> must be bigger or equal than <code class="docutils literal notranslate"><span class="pre">0</span></code>.</p>
<p>It’s also possible to have the repeat counter/index in a definition:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">.</span><span class="n">REPEAT</span> <span class="mi">6</span> <span class="n">INDEX</span> <span class="n">COUNT</span>
<span class="o">.</span><span class="n">DB</span> <span class="n">COUNT</span>
<span class="o">.</span><span class="n">ENDR</span>
</pre></div>
</div>
<p>This would define bytes <code class="docutils literal notranslate"><span class="pre">0</span></code>, <code class="docutils literal notranslate"><span class="pre">1</span></code>, <code class="docutils literal notranslate"><span class="pre">2</span></code>, <code class="docutils literal notranslate"><span class="pre">3</span></code>, <code class="docutils literal notranslate"><span class="pre">4</span></code> and <code class="docutils literal notranslate"><span class="pre">5</span></code>.</p>
<p>This is not a compulsory directive.</p>
</section>
<section id="rept-6">
<h2><span class="section-number">2.133. </span><code class="docutils literal notranslate"><span class="pre">.REPT</span> <span class="pre">6</span></code><a class="headerlink" href="#rept-6" title="Permalink to this headline">¶</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">.REPT</span></code> is an alias for <code class="docutils literal notranslate"><span class="pre">.REPEAT</span></code>.</p>
<p>This is not a compulsory directive.</p>
</section>
<section id="rombankmap">
<h2><span class="section-number">2.134. </span><code class="docutils literal notranslate"><span class="pre">.ROMBANKMAP</span></code><a class="headerlink" href="#rombankmap" title="Permalink to this headline">¶</a></h2>
<p>Begins the ROM bank map definition. You can use this directive to
define the project’s ROM banks. Use <code class="docutils literal notranslate"><span class="pre">.ROMBANKMAP</span></code> when not all the
ROM banks are of equal size. Note that you can use <code class="docutils literal notranslate"><span class="pre">.ROMBANKSIZE</span></code> and
<code class="docutils literal notranslate"><span class="pre">.ROMBANKS</span></code> instead of <code class="docutils literal notranslate"><span class="pre">.ROMBANKMAP</span></code>, but that’s only when the ROM banks
are equal in size.</p>
<p>Examples:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>.ROMBANKMAP
BANKSTOTAL 16
BANKSIZE $4000
BANKS 16
.ENDRO

.ROMBANKMAP
BANKSTOTAL 510
BANKSIZE $6000
BANKS 1
BANKSIZE $2000
BANKS 509
.ENDRO
</pre></div>
</div>
<p>The first one describes an ordinary ROM image of 16 equal sized
banks. The second one defines a 4MB Pocket Voice ROM image.
In the PV ROM image the first bank is <code class="docutils literal notranslate"><span class="pre">$6000</span></code> bytes and the remaining
<code class="docutils literal notranslate"><span class="pre">509</span></code> banks are smaller ones, <code class="docutils literal notranslate"><span class="pre">$2000</span></code> bytes each.</p>
<p><code class="docutils literal notranslate"><span class="pre">BANKSTOTAL</span></code> tells the total amount of ROM banks. It must be
defined prior to anything else.</p>
<p><code class="docutils literal notranslate"><span class="pre">BANKSIZE</span></code> tells the size of the following ROM banks. You can
supply WLA with <code class="docutils literal notranslate"><span class="pre">BANKSIZE</span></code> as many times as you wish.</p>
<p><code class="docutils literal notranslate"><span class="pre">BANKS</span></code> tells the amount of banks that follow and that are of
the size <code class="docutils literal notranslate"><span class="pre">BANKSIZE</span></code> which has been previously defined.</p>
<p>This is not a compulsory directive when <code class="docutils literal notranslate"><span class="pre">.ROMBANKSIZE</span></code> and
<code class="docutils literal notranslate"><span class="pre">.ROMBANKS</span></code> are defined.</p>
<p>You can redefine <code class="docutils literal notranslate"><span class="pre">.ROMBANKMAP</span></code> as many times as you wish as long as
the old and the new ROM bank maps match as much as possible. This
way you can enlarge the size of the project on the fly.</p>
</section>
<section id="rombanks-2">
<h2><span class="section-number">2.135. </span><code class="docutils literal notranslate"><span class="pre">.ROMBANKS</span> <span class="pre">2</span></code><a class="headerlink" href="#rombanks-2" title="Permalink to this headline">¶</a></h2>
<p>Indicates the size of the ROM in rombanks.</p>
<p>This is a compulsory directive unless <code class="docutils literal notranslate"><span class="pre">.ROMBANKMAP</span></code> is defined.</p>
<p>You can redefine <code class="docutils literal notranslate"><span class="pre">.ROMBANKS</span></code> as many times as you wish as long as
the old and the new ROM bank maps match as much as possible. This
way you can enlarge the size of the project on the fly.</p>
</section>
<section id="rombanksize-4000">
<h2><span class="section-number">2.136. </span><code class="docutils literal notranslate"><span class="pre">.ROMBANKSIZE</span> <span class="pre">$4000</span></code><a class="headerlink" href="#rombanksize-4000" title="Permalink to this headline">¶</a></h2>
<p>Defines the ROM bank size. Old syntax is <code class="docutils literal notranslate"><span class="pre">.BANKSIZE</span> <span class="pre">x</span></code>.</p>
<p>This is a compulsory directive unless <code class="docutils literal notranslate"><span class="pre">.ROMBANKMAP</span></code> is defined.</p>
</section>
<section id="romdmg">
<h2><span class="section-number">2.137. </span><code class="docutils literal notranslate"><span class="pre">.ROMDMG</span></code><a class="headerlink" href="#romdmg" title="Permalink to this headline">¶</a></h2>
<p>Inserts data into the specific ROM location to mark the ROM as a DMG
(Gameboy) ROM (<code class="docutils literal notranslate"><span class="pre">$00</span></code> -&gt; <code class="docutils literal notranslate"><span class="pre">$0146</span></code>). It will only run in DMG mode.</p>
<p>This is not a compulsory directive. <code class="docutils literal notranslate"><span class="pre">.ROMDMG</span></code> cannot be used with <code class="docutils literal notranslate"><span class="pre">.ROMSGB</span></code>.</p>
</section>
<section id="romgbconly">
<h2><span class="section-number">2.138. </span><code class="docutils literal notranslate"><span class="pre">.ROMGBCONLY</span></code><a class="headerlink" href="#romgbconly" title="Permalink to this headline">¶</a></h2>
<p>Inserts data into the specific ROM location to mark the ROM as a Gameboy Color
ROM (<code class="docutils literal notranslate"><span class="pre">$C0</span></code> -&gt; <code class="docutils literal notranslate"><span class="pre">$0143</span></code>, so ROM name is max. 15 characters long). It will
only run in GBC mode.</p>
<p>This is not a compulsory directive.</p>
</section>
<section id="romgbc">
<h2><span class="section-number">2.139. </span><code class="docutils literal notranslate"><span class="pre">.ROMGBC</span></code><a class="headerlink" href="#romgbc" title="Permalink to this headline">¶</a></h2>
<p>Inserts data into the specific ROM location to mark the ROM as a dual-mode ROM
(<code class="docutils literal notranslate"><span class="pre">$80</span></code> -&gt; <code class="docutils literal notranslate"><span class="pre">$0143</span></code>, so ROM name is max. 15 characters long). It will run in
either DMG or GBC mode.</p>
<p>This is not a compulsory directive.</p>
</section>
<section id="romsgb">
<h2><span class="section-number">2.140. </span><code class="docutils literal notranslate"><span class="pre">.ROMSGB</span></code><a class="headerlink" href="#romsgb" title="Permalink to this headline">¶</a></h2>
<p>Inserts data into the specific ROM location to mark the ROM as a Super
Gameboy enhanced ROM (<code class="docutils literal notranslate"><span class="pre">$03</span></code> -&gt; <code class="docutils literal notranslate"><span class="pre">$0146</span></code>).</p>
<p>This is not a compulsory directive. <code class="docutils literal notranslate"><span class="pre">.ROMSGB</span></code> cannot be used with <code class="docutils literal notranslate"><span class="pre">.ROMDMG</span></code>.</p>
</section>
<section id="romsize-1">
<h2><span class="section-number">2.141. </span><code class="docutils literal notranslate"><span class="pre">.ROMSIZE</span> <span class="pre">1</span></code><a class="headerlink" href="#romsize-1" title="Permalink to this headline">¶</a></h2>
<p>This is a standard Gameboy ROM size indicator value found at <code class="docutils literal notranslate"><span class="pre">$148</span></code> in a
Gameboy ROM, and there this one is put to also. If you don’t specify a value
then WLA-GB tries to calculate it based on <code class="docutils literal notranslate"><span class="pre">.ROMBANKS</span></code> / <code class="docutils literal notranslate"><span class="pre">.ROMBANKMAP</span></code>.</p>
<p>This is not a compulsory directive.</p>
</section>
<section id="row-ff00-1-3">
<h2><span class="section-number">2.142. </span><code class="docutils literal notranslate"><span class="pre">.ROW</span> <span class="pre">$ff00,</span> <span class="pre">1,</span> <span class="pre">&quot;3&quot;</span></code><a class="headerlink" href="#row-ff00-1-3" title="Permalink to this headline">¶</a></h2>
<p>Defines bytes after a .TABLE has been used to define the format.
An alternative way of defining bytes to .DB/.DW.</p>
<p>Note that when you use .ROW you’ll need to give all the items
.TABLE defines, i.e. one full row. To give more or less bytes
use .DATA.</p>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>.TABLE word, byte, word
.ROW $aabb, &quot;H&quot;, $ddee
</pre></div>
</div>
<p>This is the same as</p>
<blockquote>
<div><p>.DW $aabb
.DB “H”
.DW $ddee</p>
</div></blockquote>
<p>This is not a compulsory directive.</p>
</section>
<section id="sdsctag-1-0-dungeon-man-a-wild-dungeon-exploration-game-ville-helin">
<h2><span class="section-number">2.143. </span><code class="docutils literal notranslate"><span class="pre">.SDSCTAG</span> <span class="pre">1.0,</span> <span class="pre">&quot;DUNGEON</span> <span class="pre">MAN&quot;,</span> <span class="pre">&quot;A</span> <span class="pre">wild</span> <span class="pre">dungeon</span> <span class="pre">exploration</span> <span class="pre">game&quot;,</span> <span class="pre">&quot;Ville</span> <span class="pre">Helin&quot;</span></code><a class="headerlink" href="#sdsctag-1-0-dungeon-man-a-wild-dungeon-exploration-game-ville-helin" title="Permalink to this headline">¶</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">.SDSCTAG</span></code> adds SDSC tag to your SMS/GG ROM file. The ROM size must be at
least 8KB just like with <code class="docutils literal notranslate"><span class="pre">.COMPUTESMSCHECKSUM</span></code> and <code class="docutils literal notranslate"><span class="pre">.SMSTAG</span></code>. For more
information about this header take a look at <a class="reference external" href="http://www.smspower.org/dev/sdsc/">http://www.smspower.org/dev/sdsc/</a>.
Here’s an explanation of the arguments:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">.</span><span class="n">SDSCTAG</span> <span class="p">{</span><span class="n">version</span> <span class="n">number</span><span class="p">},</span> <span class="p">{</span><span class="n">program</span> <span class="n">name</span><span class="p">},</span> <span class="p">{</span><span class="n">program</span> <span class="n">release</span> <span class="n">notes</span><span class="p">},</span> <span class="p">{</span><span class="n">program</span> <span class="n">author</span><span class="p">}</span>
</pre></div>
</div>
<p>Note that program name, release notes and program author can also be pointers
to strings instead of being only strings (which WLA terminates with zero, and
places them into suitable locations inside the ROM file). So:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">.</span><span class="n">SDSCTAG</span> <span class="mf">0.8</span><span class="p">,</span> <span class="n">PRGNAME</span><span class="p">,</span> <span class="n">PRGNOTES</span><span class="p">,</span> <span class="n">PRGAUTHOR</span>
<span class="o">...</span>
<span class="n">PRGNAME</span><span class="p">:</span>  <span class="o">.</span><span class="n">DB</span> <span class="s2">&quot;DUNGEON MAN&quot;</span><span class="p">,</span> <span class="mi">0</span>
<span class="n">PRGNOTES</span><span class="p">:</span> <span class="o">.</span><span class="n">DB</span> <span class="s2">&quot;A wild and totally crazy dungeon exploration game&quot;</span><span class="p">,</span> <span class="mi">0</span>
<span class="n">PRGAUTHOR</span><span class="p">:</span><span class="o">.</span><span class="n">DB</span> <span class="s2">&quot;Ville Helin&quot;</span><span class="p">,</span> <span class="mi">0</span>
</pre></div>
</div>
<p>works also. All strings supplied explicitly to <code class="docutils literal notranslate"><span class="pre">.SDSCTAG</span></code> are placed
somewhere in <code class="docutils literal notranslate"><span class="pre">.BANK</span> <span class="pre">0</span> <span class="pre">SLOT</span> <span class="pre">0</span></code>.:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">.</span><span class="n">SDSCTAG</span> <span class="mf">1.0</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span>
<span class="o">.</span><span class="n">SDSCTAG</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span>
</pre></div>
</div>
<p>are also valid, here <code class="docutils literal notranslate"><span class="pre">0</span></code> and <code class="docutils literal notranslate"><span class="pre">&quot;&quot;</span></code> mean the user doesn’t want to use any
descriptive strings. Version number can also be given as an integer, but then
the minor version number defaults to zero.</p>
<p><code class="docutils literal notranslate"><span class="pre">.SDSCTAG</span></code> also defines <code class="docutils literal notranslate"><span class="pre">.SMSTAG</span></code> (as it’s part of the SDSC ROM tag
specification).</p>
<p>This is not a compulsory directive.</p>
</section>
<section id="section-init-force">
<h2><span class="section-number">2.144. </span><code class="docutils literal notranslate"><span class="pre">.SECTION</span> <span class="pre">&quot;Init&quot;</span> <span class="pre">FORCE</span></code><a class="headerlink" href="#section-init-force" title="Permalink to this headline">¶</a></h2>
<p>Section is a continuous area of data which is placed into the output
file according to the section type and <code class="docutils literal notranslate"><span class="pre">.BANK</span></code> and <code class="docutils literal notranslate"><span class="pre">.ORG</span></code> directive
values.</p>
<p>The example begins a section called <code class="docutils literal notranslate"><span class="pre">Init</span></code>. Before a section can be
declared, <code class="docutils literal notranslate"><span class="pre">.BANK</span></code> and <code class="docutils literal notranslate"><span class="pre">.ORG</span></code> must be used unless WLA is in library file
output mode. Library file’s sections must all be <code class="docutils literal notranslate"><span class="pre">FREE</span></code> ones. <code class="docutils literal notranslate"><span class="pre">.BANK</span></code>
tells the bank number where this section will be later relocated into. <code class="docutils literal notranslate"><span class="pre">.ORG</span></code>
tells the offset for the relocation from the beginning of <code class="docutils literal notranslate"><span class="pre">.BANK</span></code>.</p>
<p>You can put sections inside a namespace. For instance, if you put a section
into a namespace called <code class="docutils literal notranslate"><span class="pre">bank0</span></code>, then labels in that section can be
accessed with <code class="docutils literal notranslate"><span class="pre">bank0.label</span></code>. This is not necessary inside the section
itself. The namespace directive should immediately follow the name:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">.</span><span class="n">SECTION</span> <span class="s2">&quot;Init&quot;</span> <span class="n">NAMESPACE</span> <span class="s2">&quot;bank0&quot;</span>
</pre></div>
</div>
<p>You can give the size of the section, if you wish to force the section
to some specific size, the following way:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">.</span><span class="n">SECTION</span> <span class="s2">&quot;Init&quot;</span> <span class="n">SIZE</span> <span class="mi">100</span> <span class="n">FREE</span>
</pre></div>
</div>
<p>It’s possible to force WLALINK to align the <code class="docutils literal notranslate"><span class="pre">FREE</span></code>, <code class="docutils literal notranslate"><span class="pre">SEMIFREE</span></code> and
<code class="docutils literal notranslate"><span class="pre">SUPERFREE</span></code> sections by giving the alignment as follows:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">.</span><span class="n">SECTION</span> <span class="s2">&quot;Init&quot;</span> <span class="n">SIZE</span> <span class="mi">100</span> <span class="n">ALIGN</span> <span class="mi">4</span> <span class="n">FREE</span>
</pre></div>
</div>
<p>If you need an offset from the alignment, use OFFSET:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">.</span><span class="n">SECTION</span> <span class="s2">&quot;Init&quot;</span> <span class="n">SIZE</span> <span class="mi">10</span> <span class="n">ALIGN</span> <span class="mi">256</span> <span class="n">OFFSET</span> <span class="mi">32</span> <span class="n">FREE</span>
</pre></div>
</div>
<p>And if you want that WLA returns the <code class="docutils literal notranslate"><span class="pre">ORG</span></code> to what it was before issuing
the section, put <code class="docutils literal notranslate"><span class="pre">RETURNORG</span></code> at the end of the parameter list:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">.</span><span class="n">SECTION</span> <span class="s2">&quot;Init&quot;</span> <span class="n">SIZE</span> <span class="mi">100</span> <span class="n">ALIGN</span> <span class="mi">4</span> <span class="n">FREE</span> <span class="n">RETURNORG</span>
</pre></div>
</div>
<p>By default WLA advances the <code class="docutils literal notranslate"><span class="pre">ORG</span></code>, so, for example, if your <code class="docutils literal notranslate"><span class="pre">ORG</span></code> was
<code class="docutils literal notranslate"><span class="pre">$0</span></code> before a section of 16 bytes, then the <code class="docutils literal notranslate"><span class="pre">ORG</span></code> will be <code class="docutils literal notranslate"><span class="pre">16</span></code> after the
section.</p>
<p>Note also that if your section name begins with double underlines (e.g.,
<code class="docutils literal notranslate"><span class="pre">__UNIQUE_SECTION!!!</span></code>) the section will be unique in the sense that
when WLALINK recieves files containing sections which share the same
name, WLALINK will save only the first of them for further processing,
all others are deleted from memory with corresponding labels, references
and calculations.</p>
<p>If a section name begins with an exclamation mark (<code class="docutils literal notranslate"><span class="pre">!</span></code>) it tells
WLALINK to not to drop it, even if you use WLALINK’s ability to discard
all unreferenced sections and there are no references to the section. You can
achieve the same effect by adding <code class="docutils literal notranslate"><span class="pre">KEEP</span></code> to the end of the list:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">.</span><span class="n">SECTION</span> <span class="s2">&quot;Init&quot;</span> <span class="n">SIZE</span> <span class="mi">100</span> <span class="n">ALIGN</span> <span class="mi">4</span> <span class="n">FREE</span> <span class="n">RETURNORG</span> <span class="n">KEEP</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">FORCE</span></code> after the name of the section tells WLA that the section <em>must</em> be
inserted so it starts at <code class="docutils literal notranslate"><span class="pre">.ORG</span></code>. <code class="docutils literal notranslate"><span class="pre">FORCE</span></code> can be replaced with <code class="docutils literal notranslate"><span class="pre">FREE</span></code>
which means that the section can be inserted somewhere in the defined bank,
where there is room. You can also use <code class="docutils literal notranslate"><span class="pre">OVERWRITE</span></code> to insert the section into
the memory regardless of data collisions. Using <code class="docutils literal notranslate"><span class="pre">OVERWRITE</span></code> you can easily
patch an existing ROM image just by <code class="docutils literal notranslate"><span class="pre">.BACKGROUND</span></code>’ing the ROM image and
inserting <code class="docutils literal notranslate"><span class="pre">OVERWRITE</span></code> sections into it. <code class="docutils literal notranslate"><span class="pre">SEMIFREE</span></code> sections are also
possible and they behave much like <code class="docutils literal notranslate"><span class="pre">FREE</span></code> sections. The only difference is
that they are positioned somewhere in the bank starting from <code class="docutils literal notranslate"><span class="pre">.ORG</span></code>.
<code class="docutils literal notranslate"><span class="pre">SEMISUBFREE</span></code> sections on the other hand are positioned somewhere in the bank
starting from <code class="docutils literal notranslate"><span class="pre">$0</span></code> and ending to <code class="docutils literal notranslate"><span class="pre">.ORG</span></code>.</p>
<p><code class="docutils literal notranslate"><span class="pre">SUPERFREE</span></code> sections are also available, and they will be positioned into
the first suitable place inside the first suitable bank (candidates for these
suitable banks have the same size with the slot of the section, no other banks
are considered). You can also leave away the type specifier as the default type
for the section is <code class="docutils literal notranslate"><span class="pre">FREE</span></code>.</p>
<p>You can name the sections as you wish, but there is one special name. A section
called <code class="docutils literal notranslate"><span class="pre">BANKHEADER</span></code> is placed in the front of the bank where it is defined.
These sections contain data that is not in the memory map of the machine, so
you can’t refer to the data of a <code class="docutils literal notranslate"><span class="pre">BANKHEADER</span></code> section, but you can write
references to outside. So no labels inside <code class="docutils literal notranslate"><span class="pre">BANKHEADER</span></code> sections. These
special sections are useful when writing e.g., MSX programs. Note that library
files don’t take <code class="docutils literal notranslate"><span class="pre">BANKHEADER</span></code> sections.</p>
<p>Here’s an example of a <code class="docutils literal notranslate"><span class="pre">BANKHEADER</span></code> section:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">.</span><span class="n">BANK</span> <span class="mi">0</span>
<span class="o">.</span><span class="n">ORG</span> <span class="mi">0</span>
<span class="o">.</span><span class="n">SECTION</span> <span class="s2">&quot;BANKHEADER&quot;</span>
    <span class="o">.</span><span class="n">DW</span> <span class="n">MAIN</span>
    <span class="o">.</span><span class="n">DW</span> <span class="n">VBI</span>
<span class="o">.</span><span class="n">ENDS</span>

<span class="o">.</span><span class="n">SECTION</span> <span class="s2">&quot;Program&quot;</span>
<span class="n">MAIN</span><span class="p">:</span> <span class="n">CALL</span> <span class="n">MONTY_ON_THE_RUN</span>
<span class="n">VBI</span><span class="p">:</span>  <span class="n">PUSH</span> <span class="n">HL</span>
      <span class="o">...</span>
      <span class="n">POP</span> <span class="n">HL</span>
      <span class="n">RETI</span>
<span class="o">.</span><span class="n">ENDS</span>
</pre></div>
</div>
<p>Here’s an example of an ordinary section:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>.BANK 0
.ORG $150
.SECTION &quot;Init&quot; FREE PRIORITY 1000
        DI
        LD  SP, $FFFE
        SUB A
        LD  ($FF00+R_IE), A
.ENDS
</pre></div>
</div>
<p>This tells WLA that a <code class="docutils literal notranslate"><span class="pre">FREE</span></code> section called <code class="docutils literal notranslate"><span class="pre">Init</span></code> must be located
somewhere in bank <code class="docutils literal notranslate"><span class="pre">0</span></code> and it has a sorting <code class="docutils literal notranslate"><span class="pre">PRIORITY</span></code> of 1000. If you replace
<code class="docutils literal notranslate"><span class="pre">FREE</span></code> with <code class="docutils literal notranslate"><span class="pre">SEMIFREE</span></code> the section will be inserted somewhere in the bank <code class="docutils literal notranslate"><span class="pre">0</span></code>,
but not in the <code class="docutils literal notranslate"><span class="pre">$0</span></code> - <code class="docutils literal notranslate"><span class="pre">$14F</span></code> area. If you replace <code class="docutils literal notranslate"><span class="pre">FREE</span></code> with <code class="docutils literal notranslate"><span class="pre">SUPERFREE</span></code>
the section will be inserted somewhere in any bank with the same size as bank <code class="docutils literal notranslate"><span class="pre">0</span></code>.</p>
<p>Here’s the order in which WLA writes the sections:</p>
<ol class="arabic simple">
<li><p><code class="docutils literal notranslate"><span class="pre">FORCE</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">SEMISUBFREE</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">SEMIFREE</span></code> &amp; <code class="docutils literal notranslate"><span class="pre">FREE</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">SUPERFREE</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">OVERWRITE</span></code></p></li>
</ol>
<p>Before the sections are inserted into the output file, they are sorted by
priorities, so that the section with the highest priority is processed first.
If priorities are the same, then the size of the section matters, and bigger
sections are processed before smaller ones. The default <code class="docutils literal notranslate"><span class="pre">PRIORITY</span></code>, when not
explicitly given, is 0.</p>
<p>You can also create a RAM section. For more information about them, please
read the <code class="docutils literal notranslate"><span class="pre">.RAMSECTION</span></code> directive explanation.</p>
<p>It is also possible to merge two or more sections using <code class="docutils literal notranslate"><span class="pre">APPENDTO</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">.</span><span class="n">SECTION</span> <span class="s2">&quot;Base&quot;</span>
<span class="o">.</span><span class="n">DB</span> <span class="mi">0</span>
<span class="o">.</span><span class="n">ENDS</span>

<span class="o">.</span><span class="n">SECTION</span> <span class="s2">&quot;AppendToBase&quot;</span> <span class="n">FREE</span> <span class="n">RETURNORG</span> <span class="n">APPENDTO</span> <span class="s2">&quot;Base&quot;</span>
<span class="o">.</span><span class="n">DB</span> <span class="mi">1</span>
<span class="o">.</span><span class="n">ENDS</span>
</pre></div>
</div>
<p>And you can force a section to be placed after another section, with an
offset:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">.</span><span class="n">SECTION</span> <span class="s2">&quot;Follower&quot;</span> <span class="n">OFFSET</span> <span class="mi">32</span> <span class="n">AFTER</span> <span class="s2">&quot;Base&quot;</span>
<span class="o">.</span><span class="n">DB</span> <span class="mi">111</span>
<span class="o">.</span><span class="n">ENDS</span>
</pre></div>
</div>
<p>If you want to force WLALINK to place a section say between $0100 and $0200
in the address space, use <code class="docutils literal notranslate"><span class="pre">WINDOW</span></code> (note that <code class="docutils literal notranslate"><span class="pre">.SLOT</span></code> must be used to make
this placement possible, have the <code class="docutils literal notranslate"><span class="pre">.SECTION</span></code> in the correct slot):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>.SECTION &quot;SpecialStuff&quot; FREE WINDOW $0100 $0200
NOP
.ENDS
</pre></div>
</div>
<p>If you want to position a <code class="docutils literal notranslate"><span class="pre">.SECTION</span></code> so that it is placed in memory in a
spot where e.g., only the least 8 bits of the address change (the <code class="docutils literal notranslate"><span class="pre">.SECTION</span></code>
must thus be less than 256 bytes in size), use <code class="docutils literal notranslate"><span class="pre">BITWINDOW</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">.</span><span class="n">SECTION</span> <span class="s2">&quot;PageX&quot;</span> <span class="n">FREE</span> <span class="n">BITWINDOW</span> <span class="mi">8</span>
<span class="n">NOP</span>
<span class="o">.</span><span class="n">ENDS</span>
</pre></div>
</div>
<p>This is not a compulsory directive.</p>
</section>
<section id="seed-123">
<h2><span class="section-number">2.145. </span><code class="docutils literal notranslate"><span class="pre">.SEED</span> <span class="pre">123</span></code><a class="headerlink" href="#seed-123" title="Permalink to this headline">¶</a></h2>
<p>Seeds the random number generator.</p>
<p>The random number generator is initially seeded with the output of <code class="docutils literal notranslate"><span class="pre">time()</span></code>,
which is, according to the manual, <em>the time since the Epoch (00:00:00 UTC,
January 1, 1970), measured in seconds</em>. So if you don’t <code class="docutils literal notranslate"><span class="pre">.SEED</span></code> the random
number generator yourself with a constant value, <code class="docutils literal notranslate"><span class="pre">.DBRND</span></code> and <code class="docutils literal notranslate"><span class="pre">.DWRND</span></code> give
you different values every time you run WLA.</p>
<p>In WLA DX 9.4a and before we used the stdlib’s <code class="docutils literal notranslate"><span class="pre">srand()</span></code> and <code class="docutils literal notranslate"><span class="pre">rand()</span></code>
functions making the output differ on different platforms. Since v9.4 WLA DX
contains its own Mersenne Twister pseudo random number generator.</p>
<p>This is not a compulsory directive.</p>
</section>
<section id="shift">
<h2><span class="section-number">2.146. </span><code class="docutils literal notranslate"><span class="pre">.SHIFT</span></code><a class="headerlink" href="#shift" title="Permalink to this headline">¶</a></h2>
<p>Shifts the macro arguments one down (<code class="docutils literal notranslate"><span class="pre">\2</span></code> becomes <code class="docutils literal notranslate"><span class="pre">\1</span></code>, <code class="docutils literal notranslate"><span class="pre">\3</span></code> becomes <code class="docutils literal notranslate"><span class="pre">\2</span></code>,
etc.). <code class="docutils literal notranslate"><span class="pre">.SHIFT</span></code> can thus only be used inside a <code class="docutils literal notranslate"><span class="pre">.MACRO</span></code>.</p>
<p>This is not a compulsory directive.</p>
</section>
<section id="slot-1">
<h2><span class="section-number">2.147. </span><code class="docutils literal notranslate"><span class="pre">.SLOT</span> <span class="pre">1</span></code><a class="headerlink" href="#slot-1" title="Permalink to this headline">¶</a></h2>
<p>Changes the currently active memory slot. This directive is meant to be
used with <code class="docutils literal notranslate"><span class="pre">SUPERFREE</span></code> sections, where only the slot number is constant
when placing the sections.</p>
<p>You can use the number, address or name of the slot here:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>.SLOT 1           ; Use slot 1.
.SLOT $2000       ; Use a slot with starting address of $2000.
.SLOT &quot;SlotOne&quot;   ; Use a slot with a name &quot;SlotOne&quot;
</pre></div>
</div>
<p>This is not a compulsory directive.</p>
</section>
<section id="slowrom">
<h2><span class="section-number">2.148. </span><code class="docutils literal notranslate"><span class="pre">.SLOWROM</span></code><a class="headerlink" href="#slowrom" title="Permalink to this headline">¶</a></h2>
<p>Clears the ROM memory speed bit in <code class="docutils literal notranslate"><span class="pre">$FFD5</span></code> (<code class="docutils literal notranslate"><span class="pre">.HIROM</span></code>), <code class="docutils literal notranslate"><span class="pre">$7FD5</span></code> (<code class="docutils literal notranslate"><span class="pre">.LOROM</span></code>)
or <code class="docutils literal notranslate"><span class="pre">$FFD5</span></code> and <code class="docutils literal notranslate"><span class="pre">$40FFD5</span></code> (<code class="docutils literal notranslate"><span class="pre">.EXHIROM</span></code>) to indicate that the SNES ROM chips
are 200ns chips.</p>
<p>This is not a compulsory directive.</p>
</section>
<section id="smc">
<h2><span class="section-number">2.149. </span><code class="docutils literal notranslate"><span class="pre">.SMC</span></code><a class="headerlink" href="#smc" title="Permalink to this headline">¶</a></h2>
<p>Forces WLALINK to compute a proper SMC header for the ROM file.</p>
<p>SMC header is a chunk of 512 bytes. WLALINK touches only its first three
bytes, and sets the rest to zeroes. Here’s what will be inside the first
three bytes:</p>
<table class="docutils align-default">
<tbody>
<tr class="row-odd"><td><p>Byte</p></td>
<td><p>Description</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">0</span></code></p></td>
<td><p>low byte of 8KB page count.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">1</span></code></p></td>
<td><p>high byte of 8KB page count.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">2</span></code></p></td>
<td><ul class="simple">
<li><p>Bit <code class="docutils literal notranslate"><span class="pre">7</span></code>: <code class="docutils literal notranslate"><span class="pre">0</span></code></p></li>
<li><p>Bit <code class="docutils literal notranslate"><span class="pre">6</span></code>: <code class="docutils literal notranslate"><span class="pre">0</span></code></p></li>
<li><p>Bit <code class="docutils literal notranslate"><span class="pre">5</span></code>: <code class="docutils literal notranslate"><span class="pre">0</span></code> = LoROM, <code class="docutils literal notranslate"><span class="pre">1</span></code> = HiROM</p></li>
<li><p>Bit <code class="docutils literal notranslate"><span class="pre">4</span></code>: <code class="docutils literal notranslate"><span class="pre">0</span></code> = LoROM, <code class="docutils literal notranslate"><span class="pre">1</span></code> = HiROM</p></li>
<li><p>Bit <code class="docutils literal notranslate"><span class="pre">3</span></code> and <code class="docutils literal notranslate"><span class="pre">2</span></code>: SRAM size (<code class="docutils literal notranslate"><span class="pre">00</span></code> = 256Kb, <code class="docutils literal notranslate"><span class="pre">01</span></code> = 64Kb,
<code class="docutils literal notranslate"><span class="pre">10</span></code> = 16Kb, <code class="docutils literal notranslate"><span class="pre">11</span></code> = 0Kb)</p></li>
<li><p>Bit <code class="docutils literal notranslate"><span class="pre">1</span></code>: <code class="docutils literal notranslate"><span class="pre">0</span></code></p></li>
<li><p>Bit <code class="docutils literal notranslate"><span class="pre">0</span></code>: <code class="docutils literal notranslate"><span class="pre">0</span></code></p></li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>This is not a compulsory directive.</p>
</section>
<section id="smsheader">
<h2><span class="section-number">2.150. </span><code class="docutils literal notranslate"><span class="pre">.SMSHEADER</span></code><a class="headerlink" href="#smsheader" title="Permalink to this headline">¶</a></h2>
<p>All the fields in <code class="docutils literal notranslate"><span class="pre">.SMSHEADER</span></code> are optional and PRODUCTCODE, VERSION,
REGIONCODE and RESERVEDSPACE default to zero. If ROMSIZE is not specified
it will be calculated automatically:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>.SMSHEADER
    PRODUCTCODE 26, 70, 2 ; 2.5 bytes
    VERSION 1             ; 0-15
    REGIONCODE 4          ; 3-7
    RESERVEDSPACE 0, 0    ; 2 bytes
    ROMSIZE 0             ; 0-15
    CHECKSUMSIZE 32*1024  ; Uses the first this-many bytes in checksum
                          ;   calculations (excluding header area)
    FORCECHECKSUM $1234   ; Forces the checksum to be this value
.ENDSMS
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">REGIONCODE</span></code> also defines the system:</p>
<table class="docutils align-default">
<tbody>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">3</span></code></p></td>
<td><p>SMS Japan</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">4</span></code></p></td>
<td><p>SMS Export</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">5</span></code></p></td>
<td><p>GG Japan</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">6</span></code></p></td>
<td><p>GG Export</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">7</span></code></p></td>
<td><p>GG International</p></td>
</tr>
</tbody>
</table>
<p>When <code class="docutils literal notranslate"><span class="pre">.SMSHEADER</span></code> is defined, also the checksum is calculated, and TMR SEGA,
two reserved bytes and ROM size are defined.</p>
<p>See <a class="reference external" href="http://www.smspower.org/Development/ROMHeader">http://www.smspower.org/Development/ROMHeader</a> for more information about
SMS header.</p>
<p>This is not a compulsory directive.</p>
</section>
<section id="smstag">
<h2><span class="section-number">2.151. </span><code class="docutils literal notranslate"><span class="pre">.SMSTAG</span></code><a class="headerlink" href="#smstag" title="Permalink to this headline">¶</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">.SMSTAG</span></code> forces WLA to write an ordinary SMS/GG ROM tag to the ROM file.
Currently only the string <code class="docutils literal notranslate"><span class="pre">TMR</span> <span class="pre">SEGA</span></code> and ROM checksum are written
(meaning that <code class="docutils literal notranslate"><span class="pre">.SMSTAG</span></code> also defines <code class="docutils literal notranslate"><span class="pre">.COMPUTESMSCHECKSUM</span></code>). The ROM size
must be at least 8KBs.</p>
<p>This is not a compulsory directive.</p>
</section>
<section id="snesemuvector">
<h2><span class="section-number">2.152. </span><code class="docutils literal notranslate"><span class="pre">.SNESEMUVECTOR</span></code><a class="headerlink" href="#snesemuvector" title="Permalink to this headline">¶</a></h2>
<p>Begins definition of the emulation mode interrupt vector table:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>.SNESEMUVECTOR
COP    COPHandler
UNUSED $0000
ABORT  BRKHandler
NMI    VBlank
RESET  Main
IRQBRK IRQBRKHandler
.ENDEMUVECTOR
</pre></div>
</div>
<p>These can be defined in any order, but they will be placed into
memory starting at <code class="docutils literal notranslate"><span class="pre">$7FF4</span></code> (<code class="docutils literal notranslate"><span class="pre">$FFF4</span></code> in HiROM, <code class="docutils literal notranslate"><span class="pre">$40FFF4</span></code> and <code class="docutils literal notranslate"><span class="pre">$FFF4</span></code> in
ExHiROM) in the order listed above. All the vectors default to <code class="docutils literal notranslate"><span class="pre">$0000</span></code>.</p>
<p>This is not a compulsory directive.</p>
</section>
<section id="snesheader">
<h2><span class="section-number">2.153. </span><code class="docutils literal notranslate"><span class="pre">.SNESHEADER</span></code><a class="headerlink" href="#snesheader" title="Permalink to this headline">¶</a></h2>
<p>This begins the SNES header definition, and automatically defines
<code class="docutils literal notranslate"><span class="pre">.COMPUTESNESCHECKSUM</span></code>. From here you may define any of the following:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">ID</span> <span class="pre">&quot;ABCD&quot;</span></code> - inserts a one to four letter string starting at <code class="docutils literal notranslate"><span class="pre">$7FB2</span></code>
(lorom) or <code class="docutils literal notranslate"><span class="pre">$FFB2</span></code> (hirom).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">NAME</span> <span class="pre">&quot;Hello</span> <span class="pre">World!&quot;</span></code> - identical to a freestanding <code class="docutils literal notranslate"><span class="pre">.NAME</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">LOROM</span></code> - identical to a freestanding <code class="docutils literal notranslate"><span class="pre">.LOROM</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">HIROM</span></code> - identical to a freestanding <code class="docutils literal notranslate"><span class="pre">.HIROM</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">EXHIROM</span></code> - identical to a freestanding <code class="docutils literal notranslate"><span class="pre">.EXHIROM</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">SLOWROM</span></code> - identical to a freestanding <code class="docutils literal notranslate"><span class="pre">.SLOWROM</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">FASTROM</span></code> - identical to a freestanding <code class="docutils literal notranslate"><span class="pre">.FASTROM</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CARTRIDGETYPE</span> <span class="pre">$00</span></code> - Places the given 8-bit value in <code class="docutils literal notranslate"><span class="pre">$7FD6</span></code> (<code class="docutils literal notranslate"><span class="pre">$FFD6</span></code>
in HiROM, <code class="docutils literal notranslate"><span class="pre">$40FFD6</span></code> and <code class="docutils literal notranslate"><span class="pre">$FFD6</span></code> in ExHiROM). Some possible values I’ve
come across but cannot guarantee the accuracy of:</p>
<blockquote>
<div><table class="docutils align-default">
<tbody>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">$00</span></code></p></td>
<td><p>ROM</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">$01</span></code></p></td>
<td><p>ROM</p></td>
<td><p>RAM</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">$02</span></code></p></td>
<td><p>ROM</p></td>
<td><p>SRAM</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">$03</span></code></p></td>
<td><p>ROM</p></td>
<td></td>
<td><p>DSP1</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">$04</span></code></p></td>
<td><p>ROM</p></td>
<td><p>RAM</p></td>
<td><p>DSP1</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">$05</span></code></p></td>
<td><p>ROM</p></td>
<td><p>SRAM</p></td>
<td><p>DSP1</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">$13</span></code></p></td>
<td><p>ROM</p></td>
<td></td>
<td><p>Super FX</p></td>
</tr>
</tbody>
</table>
</div></blockquote>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">ROMSIZE</span> <span class="pre">$09</span></code> - Places the given 8-bit value in <code class="docutils literal notranslate"><span class="pre">$7FD7</span></code> (<code class="docutils literal notranslate"><span class="pre">$FFD7</span></code> in
HiROM, <code class="docutils literal notranslate"><span class="pre">$40FFD7</span></code> and <code class="docutils literal notranslate"><span class="pre">$FFD7</span></code> in ExHiROM). Possible values include (but
may not be limited to):</p>
<blockquote>
<div><table class="docutils align-default">
<tbody>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">$08</span></code></p></td>
<td><p>2 Megabits</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">$09</span></code></p></td>
<td><p>4 Megabits</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">$0A</span></code></p></td>
<td><p>8 Megabits</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">$0B</span></code></p></td>
<td><p>16 Megabits</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">$0C</span></code></p></td>
<td><p>32 Megabits</p></td>
</tr>
</tbody>
</table>
</div></blockquote>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">SRAMSIZE</span> <span class="pre">$01</span></code> - Places the given 2-bit value into <code class="docutils literal notranslate"><span class="pre">$7FD8</span></code> (<code class="docutils literal notranslate"><span class="pre">$FFD8</span></code> in
HiROM, <code class="docutils literal notranslate"><span class="pre">$40FFD8</span></code> and <code class="docutils literal notranslate"><span class="pre">$FFD8</span></code> in ExHiROM). I believe these are the only possible
values:</p>
<blockquote>
<div><table class="docutils align-default">
<tbody>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">$00</span></code></p></td>
<td><p>0 kilobits</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">$01</span></code></p></td>
<td><p>16 kilobits</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">$02</span></code></p></td>
<td><p>32 kilobits</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">$03</span></code></p></td>
<td><p>64 kilobits</p></td>
</tr>
</tbody>
</table>
</div></blockquote>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">COUNTRY</span> <span class="pre">$00</span></code> - Places the given 8-bit value into <code class="docutils literal notranslate"><span class="pre">$7FD9</span></code> (<code class="docutils literal notranslate"><span class="pre">$FFD9</span></code> in
HiROM, <code class="docutils literal notranslate"><span class="pre">$40FFD9</span></code> and <code class="docutils literal notranslate"><span class="pre">$FFD9</span></code> in ExHiROM). <code class="docutils literal notranslate"><span class="pre">$00</span></code> is Japan and <code class="docutils literal notranslate"><span class="pre">$01</span></code> is the
United States, and there several more for other regions that I cannot recall off
the top of my head.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">LICENSEECODE</span> <span class="pre">$00</span></code> - Places the given 8-bit value into <code class="docutils literal notranslate"><span class="pre">$7FDA</span></code> (<code class="docutils literal notranslate"><span class="pre">$FFDA</span></code>
in HiROM, <code class="docutils literal notranslate"><span class="pre">$40FFDA</span></code> and <code class="docutils literal notranslate"><span class="pre">$FFDA</span></code> in ExHiROM). You must find the legal values
yourself as there are plenty of them. ;)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">VERSION</span> <span class="pre">$01</span></code> - Places the given 8-bit value into <code class="docutils literal notranslate"><span class="pre">$7FDB</span></code> (<code class="docutils literal notranslate"><span class="pre">$FFDB</span></code> in
HiROM, <code class="docutils literal notranslate"><span class="pre">$40FFDB</span></code> and <code class="docutils literal notranslate"><span class="pre">$FFDB</span></code> in ExHiROM). This is supposedly interpreted as
version 1.byte, so a <code class="docutils literal notranslate"><span class="pre">$01</span></code> here would be version 1.01.</p></li>
</ul>
<p>This is not a compulsory directive.</p>
</section>
<section id="snesnativevector">
<h2><span class="section-number">2.154. </span><code class="docutils literal notranslate"><span class="pre">.SNESNATIVEVECTOR</span></code><a class="headerlink" href="#snesnativevector" title="Permalink to this headline">¶</a></h2>
<p>Begins definition of the native mode interrupt vector table:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>.SNESNATIVEVECTOR
COP    COPHandler
BRK    BRKHandler
ABORT  ABORTHandler
NMI    VBlank
UNUSED $0000
IRQ    IRQHandler
.ENDNATIVEVECTOR
</pre></div>
</div>
<p>These can be defined in any order, but they will be placed into
memory starting at <code class="docutils literal notranslate"><span class="pre">$7FE4</span></code> (<code class="docutils literal notranslate"><span class="pre">$FFE4</span></code> in HiROM, <code class="docutils literal notranslate"><span class="pre">$40FFE4</span></code> and <code class="docutils literal notranslate"><span class="pre">$FFE4</span></code> in
ExHiROM) in the order listed above. All the vectors default to <code class="docutils literal notranslate"><span class="pre">$0000</span></code>.</p>
<p>This is not a compulsory directive.</p>
</section>
<section id="stringmap-script-hello-n">
<h2><span class="section-number">2.155. </span><code class="docutils literal notranslate"><span class="pre">.STRINGMAP</span> <span class="pre">script</span> <span class="pre">&quot;Hello\n&quot;</span></code><a class="headerlink" href="#stringmap-script-hello-n" title="Permalink to this headline">¶</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">.ASC</span></code> is an alias for <code class="docutils literal notranslate"><span class="pre">.DB</span></code>, but if you use <code class="docutils literal notranslate"><span class="pre">.ASC</span></code> it will remap
the characters using the mapping given via <code class="docutils literal notranslate"><span class="pre">.ASCIITABLE</span></code>.</p>
<p>This is not a compulsory directive.</p>
</section>
<section id="stringmaptable-script-script-tbl">
<h2><span class="section-number">2.156. </span><code class="docutils literal notranslate"><span class="pre">.STRINGMAPTABLE</span> <span class="pre">script</span> <span class="pre">&quot;script.tbl&quot;</span></code><a class="headerlink" href="#stringmaptable-script-script-tbl" title="Permalink to this headline">¶</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">.STRINGMAPTABLE</span></code>’s only purpose is to provide string mapping for
<code class="docutils literal notranslate"><span class="pre">.STRINGMAP</span></code>. Take a look at the example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">.</span><span class="n">STRINGMAPTABLE</span> <span class="n">script</span> <span class="s2">&quot;script.tbl&quot;</span>
</pre></div>
</div>
<p>This will load the file “script.tbl” and define a new string mapping called
“script”. This file is in the “table file” format commonly used for game
translations; take a look at an example of one:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">00</span><span class="o">=</span><span class="n">A</span>
<span class="mi">01</span><span class="o">=</span><span class="n">B</span>
<span class="p">;</span> <span class="n">This</span> <span class="ow">is</span> <span class="n">a</span> <span class="n">comment</span>
<span class="n">ff01</span><span class="o">=</span><span class="n">あ</span>
<span class="n">ff02</span><span class="o">=</span><span class="n">いうえ</span>
<span class="n">fe</span><span class="o">=</span>\<span class="n">n</span>
</pre></div>
</div>
<p>The values to the left of the ‘=’ are a variable number of bytes expressed
in hex, which map to the text value on the right. Note that depending on the
text encoding of the file, this may be a variable number of bytes too. Thus
this is a more flexible version of <code class="docutils literal notranslate"><span class="pre">.ASCIITABLE</span></code>.</p>
<p>After you’ve given the <code class="docutils literal notranslate"><span class="pre">.STRINGMAPTABLE</span></code>, use <code class="docutils literal notranslate"><span class="pre">.STRINGMAP</span></code> to define bytes
using this mapping. For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">.</span><span class="n">STRINGMAP</span> <span class="n">script</span><span class="p">,</span> <span class="s2">&quot;いうえA</span><span class="se">\n</span><span class="s2">&quot;</span>
</pre></div>
</div>
<p>This will map to the byte values <code class="docutils literal notranslate"><span class="pre">FF</span> <span class="pre">02</span> <span class="pre">00</span> <span class="pre">FE</span></code>, provided the source file and
TBL file use the same string encoding - use of UTF-8 is advised.</p>
<p>Note that all characters must be defined in the mapping - there is no fallback
to ASCII encoding. You also cannot mix in byte values like with <code class="docutils literal notranslate"><span class="pre">.DB</span></code> and
<code class="docutils literal notranslate"><span class="pre">.ASC</span></code>.</p>
<p>You can define multiple named string map tables.</p>
<p>This is not a compulsory directive.</p>
</section>
<section id="struct-enemy-object">
<h2><span class="section-number">2.157. </span><code class="docutils literal notranslate"><span class="pre">.STRUCT</span> <span class="pre">enemy_object</span></code><a class="headerlink" href="#struct-enemy-object" title="Permalink to this headline">¶</a></h2>
<p>Begins the definition of a structure. These structures can be placed
inside <code class="docutils literal notranslate"><span class="pre">RAMSECTION</span></code> s and <code class="docutils literal notranslate"><span class="pre">ENUM</span></code> s. Here’s an example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">.</span><span class="n">STRUCT</span> <span class="n">enemy_object</span>
<span class="nb">id</span>      <span class="n">dw</span>             <span class="p">;</span> <span class="n">the</span> <span class="n">insides</span> <span class="n">of</span> <span class="n">a</span> <span class="o">.</span><span class="n">STRUCT</span> <span class="n">are</span> <span class="mi">1</span><span class="p">:</span><span class="mi">1</span> <span class="n">like</span> <span class="ow">in</span> <span class="o">.</span><span class="n">ENUM</span>
<span class="n">x</span>       <span class="n">db</span>             <span class="p">;</span> <span class="k">except</span> <span class="n">that</span> <span class="n">no</span> <span class="n">structs</span> <span class="n">inside</span> <span class="n">structs</span> <span class="n">are</span>
<span class="n">y</span>       <span class="n">db</span>             <span class="p">;</span> <span class="n">allowed</span><span class="o">.</span>
<span class="n">data</span>    <span class="n">ds</span>  <span class="mi">10</span>
<span class="n">info</span>    <span class="n">dsb</span> <span class="mi">16</span>
<span class="n">stats</span>   <span class="n">dsw</span>  <span class="mi">4</span>
<span class="o">.</span><span class="n">ENDST</span>
</pre></div>
</div>
<p>This also creates a definition <code class="docutils literal notranslate"><span class="pre">_sizeof_[struct</span> <span class="pre">name]</span></code>, in our example
this would be <code class="docutils literal notranslate"><span class="pre">_sizeof_enemy_object</span></code>, and the value of this definition
is the size of the object, in bytes (2+1+1+10+16+4*2 = 38 in the example).</p>
<p>You’ll get the following definitions as well:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">enemy_object</span><span class="o">.</span><span class="n">id</span>    <span class="p">(</span><span class="o">==</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">enemy_object</span><span class="o">.</span><span class="n">x</span>     <span class="p">(</span><span class="o">==</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">enemy_object</span><span class="o">.</span><span class="n">y</span>     <span class="p">(</span><span class="o">==</span> <span class="mi">3</span><span class="p">)</span>
<span class="n">enemy_object</span><span class="o">.</span><span class="n">data</span>  <span class="p">(</span><span class="o">==</span> <span class="mi">4</span><span class="p">)</span>
<span class="n">enemy_object</span><span class="o">.</span><span class="n">info</span>  <span class="p">(</span><span class="o">==</span> <span class="mi">14</span><span class="p">)</span>
<span class="n">enemy_object</span><span class="o">.</span><span class="n">stats</span> <span class="p">(</span><span class="o">==</span> <span class="mi">30</span><span class="p">)</span>
</pre></div>
</div>
<p>After defining a <code class="docutils literal notranslate"><span class="pre">.STRUCT</span></code> you can create an instance of it in a
<code class="docutils literal notranslate"><span class="pre">.RAMSECTION</span></code> / <code class="docutils literal notranslate"><span class="pre">.ENUM</span></code> by typing:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">instance</span> <span class="n">name</span><span class="o">&gt;</span> <span class="n">INSTANCEOF</span> <span class="o">&lt;</span><span class="n">struct</span> <span class="n">name</span><span class="o">&gt;</span> <span class="p">[</span><span class="n">optional</span><span class="p">,</span> <span class="n">the</span> <span class="n">number</span> <span class="n">of</span> <span class="n">structures</span><span class="p">]</span>
</pre></div>
</div>
<p>Here’s an example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">.</span><span class="n">RAMSECTION</span> <span class="s2">&quot;enemies&quot;</span> <span class="n">BANK</span> <span class="mi">4</span> <span class="n">SLOT</span> <span class="mi">4</span>
<span class="n">enemies</span>   <span class="n">INSTANCEOF</span> <span class="n">enemy_object</span> <span class="mi">4</span>
<span class="n">enemyman</span>  <span class="n">INSTANCEOF</span> <span class="n">enemy_object</span>
<span class="n">enemyboss</span> <span class="n">INSTANCEOF</span> <span class="n">enemy_object</span>
<span class="o">.</span><span class="n">ENDS</span>
</pre></div>
</div>
<p>This will create definitions like <code class="docutils literal notranslate"><span class="pre">enemies</span></code>, <code class="docutils literal notranslate"><span class="pre">enemies.1.id</span></code>, <code class="docutils literal notranslate"><span class="pre">enemies.1.x</span></code>,
<code class="docutils literal notranslate"><span class="pre">enemies.1.y</span></code> and so on. Definition <code class="docutils literal notranslate"><span class="pre">enemies</span></code> is followed by four <code class="docutils literal notranslate"><span class="pre">enemy_object</span></code>
instances. After those four come <code class="docutils literal notranslate"><span class="pre">enemyman</span></code> and <code class="docutils literal notranslate"><span class="pre">enemyboss</span></code> instances, but
as they are single instances, their definitions lack the index: <code class="docutils literal notranslate"><span class="pre">enemyman</span></code>,
<code class="docutils literal notranslate"><span class="pre">enemyman.id</span></code>, <code class="docutils literal notranslate"><span class="pre">enemyman.x</span></code>, <code class="docutils literal notranslate"><span class="pre">enemyman.y</span></code> and so on.</p>
<p>Take a look at the documentation on <code class="docutils literal notranslate"><span class="pre">.RAMSECTION</span></code> &amp; <code class="docutils literal notranslate"><span class="pre">.ENUM</span></code>, they have more
examples of how you can use <code class="docutils literal notranslate"><span class="pre">.STRUCT</span></code> s.</p>
<p><strong>A WORD OF WARNING</strong>: Don’t use labels <code class="docutils literal notranslate"><span class="pre">b</span></code>, <code class="docutils literal notranslate"><span class="pre">B</span></code>, <code class="docutils literal notranslate"><span class="pre">w</span></code> and <code class="docutils literal notranslate"><span class="pre">W</span></code> inside a
structure as e.g., WLA sees <code class="docutils literal notranslate"><span class="pre">enemy.b</span></code> as a byte sized reference to enemy. All
other labels should be safe:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>lda enemy1.b  ; load a byte from zeropage address enemy1 or from the address
              ; of enemy1.b??? i can&#39;t tell you, and WLA can&#39;t tell you...
</pre></div>
</div>
<p>It’s possible to explicitly define the size of the <code class="docutils literal notranslate"><span class="pre">.STRUCT</span></code> by using keyword
<code class="docutils literal notranslate"><span class="pre">SIZE</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">.</span><span class="n">STRUCT</span> <span class="n">PaddedStruct</span> <span class="n">SIZE</span> <span class="mi">8</span>
<span class="n">posX</span>  <span class="n">DW</span>
<span class="n">posY</span>  <span class="n">DW</span>
<span class="o">.</span><span class="n">ENDST</span>
</pre></div>
</div>
<p>Normally this <code class="docutils literal notranslate"><span class="pre">.STRUCT</span></code> would define four bytes, but by using keyword <code class="docutils literal notranslate"><span class="pre">SIZE</span></code>
its size is now eight bytes. The extra padding, put after the last item in the
<code class="docutils literal notranslate"><span class="pre">.STRUCT</span></code>, will contain <code class="docutils literal notranslate"><span class="pre">.EMPTYFILL</span></code> bytes when used with <code class="docutils literal notranslate"><span class="pre">.DSTRUCT</span></code>.</p>
<p>Note that if we <code class="docutils literal notranslate"><span class="pre">.DSTRUCT</span></code> “PaddedStruct” and name it PS1 we’ll also get a
definition</p>
<blockquote>
<div><p>_paddingof_PS1   (== 4)</p>
</div></blockquote>
<p>This is not a compulsory directive.</p>
</section>
<section id="sym-sausage">
<h2><span class="section-number">2.158. </span><code class="docutils literal notranslate"><span class="pre">.SYM</span> <span class="pre">SAUSAGE</span></code><a class="headerlink" href="#sym-sausage" title="Permalink to this headline">¶</a></h2>
<p>WLA treats symbols (<code class="docutils literal notranslate"><span class="pre">SAUSAGE</span></code> in this example) like labels, but they
only appear in the symbol files WLALINK outputs. Useful for finding out
the location where WLALINK puts data.</p>
<p>This is not a compulsory directive.</p>
</section>
<section id="symbol-sausage">
<h2><span class="section-number">2.159. </span><code class="docutils literal notranslate"><span class="pre">.SYMBOL</span> <span class="pre">SAUSAGE</span></code><a class="headerlink" href="#symbol-sausage" title="Permalink to this headline">¶</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">.SYMBOL</span></code> is an alias for <code class="docutils literal notranslate"><span class="pre">.SYM</span></code>.</p>
<p>This is not a compulsory directive.</p>
</section>
<section id="table-byte-word-byte">
<h2><span class="section-number">2.160. </span><code class="docutils literal notranslate"><span class="pre">.TABLE</span> <span class="pre">byte,</span> <span class="pre">word,</span> <span class="pre">byte</span></code><a class="headerlink" href="#table-byte-word-byte" title="Permalink to this headline">¶</a></h2>
<p>Defines table’s columns. With .DATA and .ROW you can define data much
like using .DB or .DW, but .TABLE makes it convenient to feed big
amounts of data in mixed format.</p>
<p>For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">.</span><span class="n">TABLE</span> <span class="n">byte</span><span class="p">,</span> <span class="n">word</span><span class="p">,</span> <span class="n">byte</span>
</pre></div>
</div>
<p>After the columns have been defined, you can define rows using e.g.,</p>
<blockquote>
<div><p>.ROW $01, $0302, $04</p>
</div></blockquote>
<p>This is the same as:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>.DB $01
.DW $0302
.DB $04
</pre></div>
</div>
<p>Note that .DATA can also be used instead of .ROW, if one wants to
give the data in pieces.</p>
<dl class="simple">
<dt>All supported column formats:</dt><dd><ul class="simple">
<li><p>DB, BYT, BYTE</p></li>
<li><p>DW, WORD, ADDR</p></li>
<li><p>DL, LONG, FARADDR</p></li>
<li><p>DD</p></li>
<li><p>DS, DSB</p></li>
<li><p>DSW</p></li>
<li><p>DSL</p></li>
<li><p>DSD</p></li>
</ul>
</dd>
</dl>
<p>This is not a compulsory directive.</p>
</section>
<section id="unbackground-1000-1fff">
<h2><span class="section-number">2.161. </span><code class="docutils literal notranslate"><span class="pre">.UNBACKGROUND</span> <span class="pre">$1000</span> <span class="pre">$1FFF</span></code><a class="headerlink" href="#unbackground-1000-1fff" title="Permalink to this headline">¶</a></h2>
<p>After issuing <code class="docutils literal notranslate"><span class="pre">.BACKGROUND</span></code> you might want to free some parts of the
backgrounded ROM image for e.g., <code class="docutils literal notranslate"><span class="pre">FREE</span></code> sections. With <code class="docutils literal notranslate"><span class="pre">.UNBACKGROUND</span></code>
you can define such regions. In the example a block starting at
<code class="docutils literal notranslate"><span class="pre">$1000</span></code> and ending at <code class="docutils literal notranslate"><span class="pre">$1FFF</span></code> was released (both ends included). You can
issue <code class="docutils literal notranslate"><span class="pre">.UNBACKGROUND</span></code> as many times as you wish.</p>
<p>This is not a compulsory directive.</p>
</section>
<section id="undef-debug">
<h2><span class="section-number">2.162. </span><code class="docutils literal notranslate"><span class="pre">.UNDEF</span> <span class="pre">DEBUG</span></code><a class="headerlink" href="#undef-debug" title="Permalink to this headline">¶</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">.UNDEF</span></code> is an alias for <code class="docutils literal notranslate"><span class="pre">.UNDEFINE</span></code>.</p>
<p>This is not a compulsory directive.</p>
</section>
<section id="undefine-debug">
<h2><span class="section-number">2.163. </span><code class="docutils literal notranslate"><span class="pre">.UNDEFINE</span> <span class="pre">DEBUG</span></code><a class="headerlink" href="#undefine-debug" title="Permalink to this headline">¶</a></h2>
<p>Removes the supplied definition label from system. If there is no
such label as given no error is displayed as the result would be the
same.</p>
<p>You can undefine as many definitions as you wish with one <code class="docutils literal notranslate"><span class="pre">.UNDEFINE</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">.</span><span class="n">UNDEFINE</span> <span class="n">NUMBER</span><span class="p">,</span> <span class="n">NAME</span><span class="p">,</span> <span class="n">ADDRESS</span><span class="p">,</span> <span class="n">COUNTRY</span>
<span class="o">.</span><span class="n">UNDEFINE</span> <span class="n">NAME</span><span class="p">,</span> <span class="n">AGE</span>
</pre></div>
</div>
<p>This is not a compulsory directive.</p>
</section>
<section id="union-name">
<h2><span class="section-number">2.164. </span><code class="docutils literal notranslate"><span class="pre">.UNION</span> <span class="pre">name</span></code><a class="headerlink" href="#union-name" title="Permalink to this headline">¶</a></h2>
<p>Begins a “union”. This can only be used in <code class="docutils literal notranslate"><span class="pre">.ENUM</span></code> s, <code class="docutils literal notranslate"><span class="pre">.RAMSECTION</span></code> s
and <code class="docutils literal notranslate"><span class="pre">.STRUCT</span></code> s.</p>
<p>When entering a union, the current address in the enum is saved, and the
following data is processed as normal. When the <code class="docutils literal notranslate"><span class="pre">.NEXTU</span></code> directive is
encountered, the address is reverted back to the start of the union. This allows
one to assign an area of memory to multiple labels:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>.ENUM $C000
    .UNION
        pos_lowbyte:  db
        pos_highbyte: db
        extra_word:   dw
    .NEXTU
        pos:          dw
    .ENDU
    after: db
.ENDE
</pre></div>
</div>
<p>This example is equivalent to:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>.DEFINE pos_lowbyte  $c000
.DEFINE pos_highbyte $c001
.DEFINE extra_word   $c002
.DEFINE pos          $c000
.DEFINE after        $c004
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">.UNION</span></code> and <code class="docutils literal notranslate"><span class="pre">.NEXTU</span></code> commands can be given an argument to assign
a prefix to the labels that follow:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>.ENUM $C000
    .UNION union1
        byte1: db
        byte2: db
    .NEXTU union2
        word1: dw
    .ENDU
.ENDE
</pre></div>
</div>
<p>This example is equivalent to:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>.DEFINE union1.byte1 $c000
.DEFINE union1.byte2 $c001
.DEFINE union2.word1 $c000
</pre></div>
</div>
<p>Unions can be nested.</p>
</section>
<section id="version-1">
<h2><span class="section-number">2.165. </span><code class="docutils literal notranslate"><span class="pre">.VERSION</span> <span class="pre">1</span></code><a class="headerlink" href="#version-1" title="Permalink to this headline">¶</a></h2>
<p>Indicates the Mask ROM version number located at <code class="docutils literal notranslate"><span class="pre">$14C</span></code> of a Gameboy ROM.</p>
<p>This is not a compulsory directive.</p>
</section>
<section id="wdc">
<h2><span class="section-number">2.166. </span><code class="docutils literal notranslate"><span class="pre">.WDC</span></code><a class="headerlink" href="#wdc" title="Permalink to this headline">¶</a></h2>
<p>Turns WLA-65816 into a mode where it accepts WDC standard assembly code, in
addition to WLA’s own syntax. In WDC standard mode:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>AND &lt;x  ; 8-bit
AND |?  ; 16-bit
AND &gt;&amp;  ; 24-bit
</pre></div>
</div>
<p>are the same as:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>AND x.b ; 8-bit
AND ?.w ; 16-bit
AND &amp;.l ; 24-bit
</pre></div>
</div>
<p>in WLA’s own syntax. Beware of the situations where you use ‘&lt;’ and ‘&gt;’ to
get the low and high bytes!</p>
<p>This is not a compulsory directive.</p>
</section>
<section id="word-16000-10-255">
<h2><span class="section-number">2.167. </span><code class="docutils literal notranslate"><span class="pre">.WORD</span> <span class="pre">16000,</span> <span class="pre">10,</span> <span class="pre">255</span></code><a class="headerlink" href="#word-16000-10-255" title="Permalink to this headline">¶</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">.WORD</span></code> is an alias for <code class="docutils literal notranslate"><span class="pre">.DW</span></code>.</p>
<p>This is not a compulsory directive.</p>
</section>
</section>
<span id="document-asmsyntax"></span><section id="assembler-syntax">
<h1><span class="section-number">3. </span>Assembler Syntax<a class="headerlink" href="#assembler-syntax" title="Permalink to this headline">¶</a></h1>
<section id="case-sensitivity">
<h2><span class="section-number">3.1. </span>Case Sensitivity<a class="headerlink" href="#case-sensitivity" title="Permalink to this headline">¶</a></h2>
<p>WLA is case sensitive, except with directives, so be careful.</p>
</section>
<section id="comments">
<h2><span class="section-number">3.2. </span>Comments<a class="headerlink" href="#comments" title="Permalink to this headline">¶</a></h2>
<p>Comments begin with <code class="docutils literal notranslate"><span class="pre">;</span></code> or <code class="docutils literal notranslate"><span class="pre">*</span></code> and end along with the line. <code class="docutils literal notranslate"><span class="pre">;</span></code> can be
used anywhere, but <code class="docutils literal notranslate"><span class="pre">*</span></code> can be placed only at the beginning of a new line.</p>
<p>WLA supports also ANSI C style commenting. This means you can start a
multiline comment with <code class="docutils literal notranslate"><span class="pre">/*</span></code> and end it with <code class="docutils literal notranslate"><span class="pre">*/</span></code>.</p>
<p>What also is supported are C++ style comments. This means you can start a
comment with <code class="docutils literal notranslate"><span class="pre">//</span></code>.</p>
<p>You can also use <code class="docutils literal notranslate"><span class="pre">.ASM</span></code> and <code class="docutils literal notranslate"><span class="pre">.ENDASM</span></code> directives to skip characters. These
function much like ANSI C comments, but unlike the ANSI C comments these can be
nested.</p>
</section>
<section id="line-splitting">
<h2><span class="section-number">3.3. </span>Line splitting<a class="headerlink" href="#line-splitting" title="Permalink to this headline">¶</a></h2>
<p>Lines can be split using a <code class="docutils literal notranslate"><span class="pre">\</span></code> between elements. So instead of writing</p>
<blockquote>
<div><p>.db 1, 2, 3, 4, 5, 6, 7, 8</p>
</div></blockquote>
<p>it’s possible to write</p>
<blockquote>
<div><dl class="simple">
<dt>.db 1, 2, 3, 4 </dt><dd><p>5, 6, 7, 8</p>
</dd>
</dl>
</div></blockquote>
<p>Note that line splitting works only in places where WLA expects a new label,
number, calculation, etc. String splitting isn’t currently supported.</p>
</section>
<section id="labels">
<h2><span class="section-number">3.4. </span>Labels<a class="headerlink" href="#labels" title="Permalink to this headline">¶</a></h2>
<p>Labels are ordinary strings (which can also end to a <code class="docutils literal notranslate"><span class="pre">:</span></code>). Labels starting
with <code class="docutils literal notranslate"><span class="pre">_</span></code> are considered to be local labels and do not show outside sections
where they were defined, or outside object files, if they were not defined
inside a section.</p>
<p>Here are few examples of different labels:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">VBI_IRQ</span><span class="p">:</span>
<span class="n">VBI_IRQ2</span>
<span class="n">_VBI_LOOP</span><span class="p">:</span>
<span class="n">main</span><span class="p">:</span>
</pre></div>
</div>
<p>Labels starting with <code class="docutils literal notranslate"><span class="pre">&#64;</span></code> are considered to be child labels. They can only be
referenced within the scope of their parent labels, unless the full name is
specified. When there is more than one <code class="docutils literal notranslate"><span class="pre">&#64;</span></code>, the label is considered to be
a child of a child.</p>
<p>Here are some examples of child labels:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">PARENT1</span><span class="p">:</span>
<span class="nd">@CHILD</span><span class="p">:</span>
<span class="o">@</span><span class="nd">@SUBCHILD</span>

<span class="n">PARENT2</span><span class="p">:</span>
<span class="nd">@CHILD</span><span class="p">:</span>
</pre></div>
</div>
<p>This is legal, since each of the <code class="docutils literal notranslate"><span class="pre">&#64;CHILD</span></code> labels has a different parent.
You can specify a parent to be explicit, like so:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">jr</span> <span class="n">PARENT1</span><span class="nd">@CHILD@SUBCHILD</span>
</pre></div>
</div>
<p>You can also use <code class="docutils literal notranslate"><span class="pre">__label__</span></code> to refer to the last defined parent label:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">main</span><span class="p">:</span>                 <span class="p">;</span> <span class="c1">#</span>
        <span class="n">nop</span>
        <span class="n">nop</span>
<span class="nd">@child</span><span class="p">:</span>
        <span class="n">nop</span>
        <span class="n">nop</span>
<span class="o">@</span><span class="nd">@grandchild</span><span class="p">:</span>
        <span class="n">nop</span>
        <span class="n">nop</span>
        <span class="n">jmp</span> <span class="n">__label__</span> <span class="p">;</span> <span class="n">jump</span> <span class="o">-&gt;</span> <span class="c1">#</span>
<span class="n">loop</span><span class="p">:</span>   <span class="n">nop</span>           <span class="p">;</span> <span class="o">%</span>
        <span class="n">nop</span>
        <span class="n">jmp</span> <span class="n">__label__</span> <span class="p">;</span> <span class="n">jump</span> <span class="o">-&gt;</span> <span class="o">%</span>
</pre></div>
</div>
<p>Note that when you place <code class="docutils literal notranslate"><span class="pre">:</span></code> in front of the label string when referring to
it, you’ll get the bank number of the label, instead of the label’s address.
Here’s an example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">LD</span> <span class="n">A</span><span class="p">,</span> <span class="p">:</span><span class="n">LOOP</span>
<span class="o">.</span><span class="n">BANK</span> <span class="mi">2</span> <span class="n">SLOT</span> <span class="mi">0</span>
<span class="n">LOOP</span><span class="p">:</span>
</pre></div>
</div>
<p>Here <code class="docutils literal notranslate"><span class="pre">LD</span> <span class="pre">A,</span> <span class="pre">:LOOP</span></code> will be replaced with <code class="docutils literal notranslate"><span class="pre">LD</span> <span class="pre">A,</span> <span class="pre">2</span></code> as the label <code class="docutils literal notranslate"><span class="pre">LOOP</span></code>
is inside the bank number two.</p>
<p>When you are referring to a label and you are adding something to its address
(or subtracting, any arithmetics apply) the result will always be bytes.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">.</span><span class="n">org</span> <span class="mi">20</span>
<span class="n">DATA</span><span class="p">:</span>  <span class="o">.</span><span class="n">dw</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="mi">300</span>
       <span class="n">ld</span>  <span class="n">a</span><span class="p">,</span> <span class="n">DATA</span><span class="o">+</span><span class="mi">1</span>
              <span class="o">^^^^^^</span> <span class="o">=</span> <span class="n">r</span>
</pre></div>
</div>
<p>So here the result <code class="docutils literal notranslate"><span class="pre">r</span></code> will be the address of <code class="docutils literal notranslate"><span class="pre">DATA</span></code> plus one, here 21.
Some x86 assemblers would give here <code class="docutils literal notranslate"><span class="pre">22</span></code> as the result <code class="docutils literal notranslate"><span class="pre">r</span></code> as <code class="docutils literal notranslate"><span class="pre">DATA</span></code>
points to an array or machine words, but WLA isn’t that smart (and some people
including me think this is the better solution).</p>
<p>Note that each CPU WLA supports contains opcodes that either generate an
absolute reference or a relative reference to the given label. For example,</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">.</span><span class="n">org</span> <span class="mi">20</span>
<span class="n">DATA</span><span class="p">:</span>  <span class="n">ld</span>  <span class="n">a</span><span class="p">,</span> <span class="n">DATA</span>   <span class="p">;</span> <span class="n">DATA</span> <span class="n">becomes</span> <span class="mi">20</span> <span class="p">(</span><span class="n">absolute</span><span class="p">)</span>
       <span class="n">jr</span>  <span class="n">DATA</span>      <span class="p">;</span> <span class="n">DATA</span> <span class="n">becomes</span> <span class="o">-</span><span class="mi">4</span> <span class="p">(</span><span class="n">relative</span><span class="p">)</span>
</pre></div>
</div>
<p>Check out section 14 for the list of opcodes that generate relative references.</p>
<p>You can also use <code class="docutils literal notranslate"><span class="pre">-</span></code>, <code class="docutils literal notranslate"><span class="pre">--</span></code>, <code class="docutils literal notranslate"><span class="pre">---</span></code>, <code class="docutils literal notranslate"><span class="pre">+</span></code>, <code class="docutils literal notranslate"><span class="pre">++</span></code>, <code class="docutils literal notranslate"><span class="pre">+++</span></code>, … as
un-named labels. Labels consisting of <code class="docutils literal notranslate"><span class="pre">-</span></code> are meant for reverse jumps and
labels consisting of <code class="docutils literal notranslate"><span class="pre">+</span></code> are meant for forward jumps. You can reuse un-named
labels as much as you wish inside your source code. Here’s an example of this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>    dec e
    beq ++      ; jump -&gt; ?
    dec e
    beq +       ; jump -&gt; %
    ld d, 14
--- ld a, 10    ; !
--  ld b, c     ; #
-   dec b       ; *
    jp nz, -    ; jump -&gt; *
    dec c
    jp nz, --   ; jump -&gt; #
    dec d
    jp nz, ---  ; jump -&gt; !
    ld a, 20
-   dec a       ; $
    jp nz, -    ; jump -&gt; $
+   halt        ; %
++  nop         ; ?
</pre></div>
</div>
<p>Note that <code class="docutils literal notranslate"><span class="pre">__</span></code> (that’s two underline characters) serves also as a un-named
label. You can refer to this label from both directions. Use <code class="docutils literal notranslate"><span class="pre">_b</span></code> when
you are jumping backwards and <code class="docutils literal notranslate"><span class="pre">_f</span></code> when you are jumping forwards label <code class="docutils literal notranslate"><span class="pre">__</span></code>.</p>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>   <span class="n">dec</span> <span class="n">e</span>
   <span class="n">jp</span> <span class="n">z</span><span class="p">,</span> <span class="n">_f</span>     <span class="p">;</span> <span class="n">jump</span> <span class="o">-&gt;</span> <span class="o">*</span>
   <span class="n">dec</span> <span class="n">e</span>
<span class="n">__</span> <span class="n">ldi</span> <span class="n">a</span><span class="p">,</span> <span class="p">(</span><span class="n">hl</span><span class="p">)</span>  <span class="p">;</span> <span class="o">*</span>
   <span class="n">dec</span> <span class="n">e</span>
   <span class="n">jp</span> <span class="n">nz</span><span class="p">,</span> <span class="n">_b</span>    <span class="p">;</span> <span class="n">jump</span> <span class="o">-&gt;</span> <span class="o">*</span>
</pre></div>
</div>
<p><strong>CAVEAT! CAVEAT! CAVEAT!</strong></p>
<p>The following code doesn’t work as it would if WLA would determine the
distance lexically (but in practice it’s WLALINK that does all the
calculations and sees only the preprocessed output of WLA):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">.</span><span class="n">macro</span> <span class="n">dummy</span>
<span class="o">-</span>  <span class="n">dec</span> <span class="n">a</span>        <span class="p">;</span> <span class="c1">#</span>
   <span class="n">jp</span> <span class="n">nz</span><span class="p">,</span> <span class="o">-</span>     <span class="p">;</span> <span class="n">jump</span> <span class="o">-&gt;</span> <span class="c1">#</span>
<span class="o">.</span><span class="n">endm</span>

   <span class="o">...</span>
<span class="o">-</span>  <span class="n">nop</span>          <span class="p">;</span> <span class="o">*</span>
   <span class="n">dummy</span>
   <span class="n">dec</span> <span class="n">e</span>
   <span class="n">jp</span> <span class="n">nz</span><span class="p">,</span> <span class="o">-</span>     <span class="p">;</span> <span class="n">i</span><span class="s1">&#39;d like to jump to *, but i&#39;</span><span class="n">ll</span> <span class="n">end</span> <span class="n">up</span> <span class="n">jumping</span>
                <span class="p">;</span> <span class="n">to</span> <span class="c1"># as it&#39;s closest to me in the output WLA produces</span>
                <span class="p">;</span> <span class="k">for</span> <span class="n">WLALINK</span> <span class="p">(</span><span class="n">so</span> <span class="n">it</span><span class="s1">&#39;s better to use \@ with labels inside</span>
                <span class="p">;</span> <span class="n">a</span> <span class="n">macro</span><span class="p">)</span><span class="o">.</span>
</pre></div>
</div>
<p>To make un-named labels inside a <code class="docutils literal notranslate"><span class="pre">.MACRO</span></code> isolated, and the previous example
to work, use the keyword <code class="docutils literal notranslate"><span class="pre">ISOLATED</span></code></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">.</span><span class="n">macro</span> <span class="n">dummy</span> <span class="n">isolated</span>
<span class="o">-</span>  <span class="n">dec</span> <span class="n">a</span>        <span class="p">;</span> <span class="c1">#</span>
   <span class="n">jp</span> <span class="n">nz</span><span class="p">,</span> <span class="o">-</span>     <span class="p">;</span> <span class="n">jump</span> <span class="o">-&gt;</span> <span class="c1">#</span>
<span class="o">.</span><span class="n">endm</span>
</pre></div>
</div>
<p>The same issue exists with child labels. See <code class="docutils literal notranslate"><span class="pre">.MACRO</span></code>’s documentation for
more details.</p>
<p>WLALINK will also generate <code class="docutils literal notranslate"><span class="pre">_sizeof_[label]</span></code> defines that measure the
distance between two consecutive labels. These labels have the same scope as
the labels they describe. Here is an example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Label1</span><span class="p">:</span>
    <span class="o">.</span><span class="n">db</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span>
<span class="n">Label2</span><span class="p">:</span>
</pre></div>
</div>
<p>In this case you’ll get a definition <code class="docutils literal notranslate"><span class="pre">_sizeof_Label1</span></code> that will have value
<code class="docutils literal notranslate"><span class="pre">4</span></code>.</p>
<p>WLA will skip over any child labels when calculating <code class="docutils literal notranslate"><span class="pre">_sizeof</span></code>. So, in this
example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Label1</span><span class="p">:</span>
<span class="o">.</span><span class="n">db</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span>
<span class="nd">@child</span><span class="p">:</span>
    <span class="o">.</span><span class="n">db</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span>
<span class="n">Label2</span><span class="p">:</span>
</pre></div>
</div>
<p>The value of <code class="docutils literal notranslate"><span class="pre">_sizeof_Label1</span></code> will still have a value of <code class="docutils literal notranslate"><span class="pre">4</span></code>.</p>
</section>
<section id="number-types">
<h2><span class="section-number">3.5. </span>Number Types<a class="headerlink" href="#number-types" title="Permalink to this headline">¶</a></h2>
<table class="docutils align-default">
<tbody>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">1000</span></code></p></td>
<td><p>decimal</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">$100</span></code></p></td>
<td><p>hexadecimal</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">100h</span></code></p></td>
<td><p>hexadecimal</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">0x10</span></code></p></td>
<td><p>hexadecimal</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">%100</span></code></p></td>
<td><p>binary</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">0b10</span></code></p></td>
<td><p>binary</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">'x'</span></code></p></td>
<td><p>character</p></td>
</tr>
</tbody>
</table>
<p>Remember that if you use the suffix <code class="docutils literal notranslate"><span class="pre">h</span></code> to give a hexadecimal value,
and the value begins with an alphabet, you must place a zero in front of it
so WLA knows it’s not a label (e.g., <code class="docutils literal notranslate"><span class="pre">0ah</span></code> instead of <code class="docutils literal notranslate"><span class="pre">ah</span></code>).</p>
</section>
<section id="strings">
<h2><span class="section-number">3.6. </span>Strings<a class="headerlink" href="#strings" title="Permalink to this headline">¶</a></h2>
<p>Strings begin with and end to <code class="docutils literal notranslate"><span class="pre">&quot;</span></code>. Note that no <code class="docutils literal notranslate"><span class="pre">0</span></code> is inserted to
indicate the termination of the string like in e.g., ANSI C. You’ll have to do
it yourself. You can place quotation marks inside strings the way C
preprocessors accept them.</p>
<p>Here are some examples of strings:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s2">&quot;Hello world!&quot;</span>
<span class="s2">&quot;He said: </span><span class="se">\&quot;</span><span class="s2">Please, kiss me honey.</span><span class="se">\&quot;</span><span class="s2">&quot;</span>
</pre></div>
</div>
</section>
<section id="substitution">
<h2><span class="section-number">3.7. </span>Substitution<a class="headerlink" href="#substitution" title="Permalink to this headline">¶</a></h2>
<p>It’s possible to substitute definition’s name with its value inside a label.</p>
<p>Here’s an example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">.</span><span class="n">REPEAT</span> <span class="mi">10</span> <span class="n">INDEX</span> <span class="n">COUNT</span>
<span class="n">Label_</span><span class="p">{</span><span class="n">COUNT</span><span class="p">}:</span>                      <span class="p">;</span> <span class="o">-&gt;</span> <span class="n">Label_0</span><span class="p">,</span> <span class="n">Label_1</span><span class="p">,</span> <span class="n">Label_2</span><span class="o">...</span>
<span class="o">.</span><span class="n">DW</span> <span class="n">Label_</span><span class="p">{</span><span class="n">COUNT</span><span class="p">}</span>
<span class="o">.</span><span class="n">ENDR</span>
</pre></div>
</div>
<p>Substitution supports minimal formatting for integers:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">.</span><span class="n">DEFINE</span> <span class="n">COUNT</span> <span class="o">=</span> <span class="mi">10</span>
<span class="o">.</span><span class="n">DEFINE</span> <span class="n">UNIT</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">Label_</span><span class="p">{</span><span class="o">%</span><span class="mf">.4</span><span class="n">x</span><span class="p">{</span><span class="n">COUNT</span><span class="p">}}:</span>                <span class="p">;</span> <span class="o">-&gt;</span> <span class="n">Label_000a</span>
<span class="n">Label_</span><span class="p">{</span><span class="o">%</span><span class="mf">.3</span><span class="n">X</span><span class="p">{</span><span class="n">COUNT</span><span class="p">}}</span><span class="n">_</span><span class="p">{</span><span class="o">%</span><span class="mf">.3</span><span class="n">X</span><span class="p">{</span><span class="n">UNIT</span><span class="p">}}:</span>   <span class="p">;</span> <span class="o">-&gt;</span> <span class="n">Label_00A_005</span>
<span class="n">Label_</span><span class="p">{</span><span class="o">%</span><span class="mf">.9</span><span class="n">d</span><span class="p">{</span><span class="n">COUNT</span><span class="p">}}:</span>                <span class="p">;</span> <span class="o">-&gt;</span> <span class="n">Label_000000010</span>
<span class="n">Label_</span><span class="p">{</span><span class="o">%</span><span class="mf">.3</span><span class="n">i</span><span class="p">{</span><span class="n">COUNT</span><span class="p">}}:</span>                <span class="p">;</span> <span class="o">-&gt;</span> <span class="n">Label_010</span>
</pre></div>
</div>
<p>The examples show all the formatting symbols currently supported.</p>
<p>The same substitution works for strings inside quotes when the quoted string is as follows:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">.</span><span class="n">db</span> <span class="p">{</span> <span class="s2">&quot;HELLO_</span><span class="si">{COUNT}</span><span class="s2">&quot;</span> <span class="p">}</span>             <span class="p">;</span> <span class="o">-&gt;</span> <span class="s2">&quot;HELLO_10&quot;</span>
</pre></div>
</div>
<p>Note that only WLA can do the substitution and it needs to know the value of the definition
at the time the substitution is done, i.e., the time a string containing a substitution is
parsed.</p>
<p>Also note that you can embed calculations into substitutions:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">.</span><span class="n">DEFINE</span> <span class="n">COUNT</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">Label_</span><span class="p">{</span><span class="n">COUNT</span><span class="o">+</span><span class="mi">1</span><span class="p">}:</span>                    <span class="p">;</span> <span class="o">-&gt;</span> <span class="n">Label_2</span>
</pre></div>
</div>
</section>
<section id="mnemonics">
<h2><span class="section-number">3.8. </span>Mnemonics<a class="headerlink" href="#mnemonics" title="Permalink to this headline">¶</a></h2>
<p>You can give the operand size with the operand itself (and this is
highly recommended) in WLA 6502/65C02/65CE02/HUC6280/65816/6800/6801/6809:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="ow">and</span> <span class="c1">#20.b</span>
<span class="ow">and</span> <span class="c1">#20.w</span>
<span class="n">bit</span> <span class="n">loop</span><span class="o">.</span><span class="n">b</span>
<span class="n">bit</span> <span class="n">loop</span><span class="o">.</span><span class="n">w</span>
</pre></div>
</div>
</section>
<section id="brackets">
<h2><span class="section-number">3.9. </span>Brackets?<a class="headerlink" href="#brackets" title="Permalink to this headline">¶</a></h2>
<p>You can write</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">LDI</span> <span class="p">(</span><span class="n">HL</span><span class="p">),</span> <span class="n">A</span>
</pre></div>
</div>
<p>or</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">LDI</span> <span class="p">[</span><span class="n">HL</span><span class="p">],</span> <span class="n">A</span>
</pre></div>
</div>
<p>as both mean the same thing in the syntax of most of the supported CPUs.
Yes, you could write</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">LDI</span> <span class="p">[</span><span class="n">HL</span><span class="p">),</span> <span class="n">A</span>
</pre></div>
</div>
<p>but that is not recommended.</p>
<p>Note that brackets have special meaning when dealing with a 65816/SPC-700
system so you can’t use</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>AND [$65]
</pre></div>
</div>
<p>instead of</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>AND ($65)
</pre></div>
</div>
<p>as they mean different things.</p>
</section>
</section>
<span id="document-errormsg"></span><section id="error-messages">
<h1><span class="section-number">4. </span>Error Messages<a class="headerlink" href="#error-messages" title="Permalink to this headline">¶</a></h1>
<p>There are quite a few of them in WLA, but most of them are not as informative
as I would like them to be. This will be fixed in the future. Mean while, be
careful. ;)</p>
</section>
<span id="document-gb-support"></span><section id="supported-rom-ram-cartridge-types-wla-gb">
<h1><span class="section-number">5. </span>Supported ROM/RAM/Cartridge Types (WLA-GB)<a class="headerlink" href="#supported-rom-ram-cartridge-types-wla-gb" title="Permalink to this headline">¶</a></h1>
<section id="rom-size">
<h2><span class="section-number">5.1. </span>ROM Size<a class="headerlink" href="#rom-size" title="Permalink to this headline">¶</a></h2>
<p>GB-Z80 version of WLA supports the following ROM bank sizes. There’s no such limit
in the Z80/6502/65C02/65CE02/65816/6800/6801/6809/8008/8080/HUC6280/SPC-700/SuperFX
version of WLA. Supply one of the following values to <code class="docutils literal notranslate"><span class="pre">.ROMBANKS</span></code>.</p>
<table class="docutils align-default">
<tbody>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">$00</span></code></p></td>
<td><p>256Kbit</p></td>
<td><p>32KByte</p></td>
<td><p>2 banks</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">$01</span></code></p></td>
<td><p>512Kbit</p></td>
<td><p>64KByte</p></td>
<td><p>4 banks</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">$02</span></code></p></td>
<td><p>1Mbit</p></td>
<td><p>128KByte</p></td>
<td><p>8 banks</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">$03</span></code></p></td>
<td><p>2Mbit</p></td>
<td><p>256KByte</p></td>
<td><p>16 banks</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">$04</span></code></p></td>
<td><p>4Mbit</p></td>
<td><p>512KByte</p></td>
<td><p>32 banks</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">$05</span></code></p></td>
<td><p>8Mbit</p></td>
<td><p>1MByte</p></td>
<td><p>64 banks</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">$06</span></code></p></td>
<td><p>16Mbit</p></td>
<td><p>2MByte</p></td>
<td><p>128 banks</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">$07</span></code></p></td>
<td><p>32Mbit</p></td>
<td><p>4MByte</p></td>
<td><p>256 banks</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">$08</span></code></p></td>
<td><p>64Mbit</p></td>
<td><p>8MByte</p></td>
<td><p>512 banks</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">$52</span></code></p></td>
<td><p>9Mbit</p></td>
<td><p>1.1MByte</p></td>
<td><p>72 banks</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">$53</span></code></p></td>
<td><p>10Mbit</p></td>
<td><p>1.2MByte</p></td>
<td><p>80 banks</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">$54</span></code></p></td>
<td><p>12Mbit</p></td>
<td><p>1.5MByte</p></td>
<td><p>96 banks</p></td>
</tr>
</tbody>
</table>
</section>
<section id="ram-size">
<h2><span class="section-number">5.2. </span>RAM Size<a class="headerlink" href="#ram-size" title="Permalink to this headline">¶</a></h2>
<p>Supply one of the following hex values to <code class="docutils literal notranslate"><span class="pre">.RAMSIZE</span></code> in the GB-Z80 version
of WLA.</p>
<table class="docutils align-default">
<tbody>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">$00</span></code></p></td>
<td><p>None</p></td>
<td><p>None</p></td>
<td><p>None</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">$01</span></code></p></td>
<td><p>16kbit</p></td>
<td><p>2kByte</p></td>
<td><p>1 bank</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">$02</span></code></p></td>
<td><p>64kbit</p></td>
<td><p>8kByte</p></td>
<td><p>1 bank</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">$03</span></code></p></td>
<td><p>256kbit</p></td>
<td><p>32kByte</p></td>
<td><p>4 banks</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">$04</span></code></p></td>
<td><p>1Mbit</p></td>
<td><p>128kByte</p></td>
<td><p>16 banks</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">$05</span></code></p></td>
<td><p>512kbit</p></td>
<td><p>64kByte</p></td>
<td><p>8 banks</p></td>
</tr>
</tbody>
</table>
</section>
<section id="cartridge-type">
<h2><span class="section-number">5.3. </span>Cartridge Type<a class="headerlink" href="#cartridge-type" title="Permalink to this headline">¶</a></h2>
<p>It’s up to the user to check that the cartridge type is valid and
can be used combined with the supplied ROM and RAM sizes. Give
one the the following values to <code class="docutils literal notranslate"><span class="pre">.CARTRIDGETYPE</span></code> in the GB-Z80 version of WLA.</p>
<table class="docutils align-default">
<tbody>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">$00</span></code></p></td>
<td><p>ROM</p></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">$01</span></code></p></td>
<td><p>ROM</p></td>
<td><p>MBC1</p></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">$02</span></code></p></td>
<td><p>ROM</p></td>
<td><p>MBC1</p></td>
<td><p>RAM</p></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">$03</span></code></p></td>
<td><p>ROM</p></td>
<td><p>MBC1</p></td>
<td><p>RAM</p></td>
<td><p>BATTERY</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">$05</span></code></p></td>
<td><p>ROM</p></td>
<td><p>MBC2</p></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">$06</span></code></p></td>
<td><p>ROM</p></td>
<td><p>MBC2</p></td>
<td></td>
<td><p>BATTERY</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">$08</span></code></p></td>
<td><p>ROM</p></td>
<td></td>
<td><p>RAM</p></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">$09</span></code></p></td>
<td><p>ROM</p></td>
<td></td>
<td><p>RAM</p></td>
<td><p>BATTERY</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">$0B</span></code></p></td>
<td><p>ROM</p></td>
<td><p>MMM01</p></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">$0C</span></code></p></td>
<td><p>ROM</p></td>
<td><p>MMM01</p></td>
<td><p>SRAM</p></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">$0D</span></code></p></td>
<td><p>ROM</p></td>
<td><p>MMM01</p></td>
<td><p>SRAM</p></td>
<td><p>BATTERY</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">$0F</span></code></p></td>
<td><p>ROM</p></td>
<td><p>MBC3</p></td>
<td></td>
<td><p>BATTERY</p></td>
<td><p>TIMER</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">$10</span></code></p></td>
<td><p>ROM</p></td>
<td><p>MBC3</p></td>
<td><p>RAM</p></td>
<td><p>BATTERY</p></td>
<td><p>TIMER</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">$11</span></code></p></td>
<td><p>ROM</p></td>
<td><p>MBC3</p></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">$12</span></code></p></td>
<td><p>ROM</p></td>
<td><p>MBC3</p></td>
<td><p>RAM</p></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">$13</span></code></p></td>
<td><p>ROM</p></td>
<td><p>MBC3</p></td>
<td><p>RAM</p></td>
<td><p>BATTERY</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">$19</span></code></p></td>
<td><p>ROM</p></td>
<td><p>MBC5</p></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">$1A</span></code></p></td>
<td><p>ROM</p></td>
<td><p>MBC5</p></td>
<td><p>RAM</p></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">$1B</span></code></p></td>
<td><p>ROM</p></td>
<td><p>MBC5</p></td>
<td><p>RAM</p></td>
<td><p>BATTERY</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">$1C</span></code></p></td>
<td><p>ROM</p></td>
<td><p>MBC5</p></td>
<td></td>
<td></td>
<td></td>
<td><p>RUMBLE</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">$1D</span></code></p></td>
<td><p>ROM</p></td>
<td><p>MBC5</p></td>
<td><p>SRAM</p></td>
<td></td>
<td></td>
<td><p>RUMBLE</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">$1E</span></code></p></td>
<td><p>ROM</p></td>
<td><p>MBC5</p></td>
<td><p>SRAM</p></td>
<td><p>BATTERY</p></td>
<td></td>
<td><p>RUMBLE</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">$20</span></code></p></td>
<td><p>MBC6</p></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">$22</span></code></p></td>
<td><p>MBC7</p></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">$BE</span></code></p></td>
<td><p>Pocket Voice</p></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">$FC</span></code></p></td>
<td><p>Pocket Camera</p></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">$FD</span></code></p></td>
<td><p>Bandai TAMA5</p></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">$FE</span></code></p></td>
<td><p>Hudson HuC-3</p></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">$FF</span></code></p></td>
<td><p>Hudson HuC-1</p></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
</section>
</section>
<span id="document-bugs"></span><section id="bugs">
<h1><span class="section-number">6. </span>Bugs<a class="headerlink" href="#bugs" title="Permalink to this headline">¶</a></h1>
<p>If you find bugs, please let us know about them via GitHub:
<a class="reference external" href="https://github.com/vhelin/wla-dx/issues">https://github.com/vhelin/wla-dx/issues</a></p>
</section>
<span id="document-files"></span><section id="files">
<h1><span class="section-number">7. </span>Files<a class="headerlink" href="#files" title="Permalink to this headline">¶</a></h1>
<section id="tests">
<h2><span class="section-number">7.1. </span><code class="docutils literal notranslate"><span class="pre">tests</span></code><a class="headerlink" href="#tests" title="Permalink to this headline">¶</a></h2>
<p>The main purpose of the files in the <code class="docutils literal notranslate"><span class="pre">tests</span></code> directory is to test that WLA
and WLALINK can assemble and link the tiny project correctly. You can also
take a look at the code and syntax in the files, but beware: if you run the
rom files you probably don’t see anything on screen.</p>
<p><code class="docutils literal notranslate"><span class="pre">include</span></code> directory under <code class="docutils literal notranslate"><span class="pre">gb-z80</span></code> could be very useful as the six include
files there have all the Game Boy hardware register address and memory
definitions you could ever need and more.</p>
</section>
<section id="tests-gb-z80-lib">
<h2><span class="section-number">7.2. </span><code class="docutils literal notranslate"><span class="pre">tests/gb-z80/lib</span></code><a class="headerlink" href="#tests-gb-z80-lib" title="Permalink to this headline">¶</a></h2>
<p>This folder holds few very useful libraries for you to use in your Game Boy
projects. Instead of reinventing the wheel, use the stuff found in here.
Remember to compile the libraries right after you’ve installed WLA by
executing <code class="docutils literal notranslate"><span class="pre">make</span></code> in the <code class="docutils literal notranslate"><span class="pre">lib</span></code> directory.</p>
</section>
<section id="memorymaps">
<h2><span class="section-number">7.3. </span><code class="docutils literal notranslate"><span class="pre">memorymaps</span></code><a class="headerlink" href="#memorymaps" title="Permalink to this headline">¶</a></h2>
<p>Here you can find default memory maps (see <code class="docutils literal notranslate"><span class="pre">.MEMORYMAP</span></code>) for various computers
and video game consoles.</p>
</section>
</section>
<span id="document-functions"></span><section id="functions">
<h1><span class="section-number">8. </span>Functions<a class="headerlink" href="#functions" title="Permalink to this headline">¶</a></h1>
<p>WLA supports functions in addition to <code class="docutils literal notranslate"><span class="pre">.MACRO</span></code> s. Functions are different from
<code class="docutils literal notranslate"><span class="pre">.MACRO</span></code> s as functions always return a value.</p>
<section id="built-in-functions">
<h2><span class="section-number">8.1. </span>Built-in functions<a class="headerlink" href="#built-in-functions" title="Permalink to this headline">¶</a></h2>
<p>The following built-in functions can be used where ever a number is expected:</p>
<table class="docutils align-default">
<tbody>
<tr class="row-odd"><td><p>asc()</p></td>
<td><p>Uses <code class="docutils literal notranslate"><span class="pre">.ASCIITABLE</span></code> to map the supplied value</p></td>
</tr>
<tr class="row-even"><td><p>bank()</p></td>
<td><p>Returns the bank (the same as preceding <code class="docutils literal notranslate"><span class="pre">:</span></code>)</p></td>
</tr>
<tr class="row-odd"><td><p>bankbyte()</p></td>
<td><p>Returns the bank byte, bits 16-23</p></td>
</tr>
<tr class="row-even"><td><p>ceil()</p></td>
<td><p>The same as ANSI C90 ceil()</p></td>
</tr>
<tr class="row-odd"><td><p>defined()</p></td>
<td><p>Returns 1 (true) if the supplied definition exists, 0 (false) otherwise</p></td>
</tr>
<tr class="row-even"><td><p>exists()</p></td>
<td><p>Returns 1 (true) if the supplied file exists, 0 (false) otherwise</p></td>
</tr>
<tr class="row-odd"><td><p>floor()</p></td>
<td><p>The same as ANSI C90 floor()</p></td>
</tr>
<tr class="row-even"><td><p>hibyte()</p></td>
<td><p>Returns the high byte, bits 8-15 (the same as preceding <code class="docutils literal notranslate"><span class="pre">&gt;</span></code>)</p></td>
</tr>
<tr class="row-odd"><td><p>hiword()</p></td>
<td><p>Returns the high word, bits 16-31</p></td>
</tr>
<tr class="row-even"><td><p>lobyte()</p></td>
<td><p>Returns the low byte, bits 0-7 (the same as preceding <code class="docutils literal notranslate"><span class="pre">&lt;</span></code>)</p></td>
</tr>
<tr class="row-odd"><td><p>loword()</p></td>
<td><p>Returns the low word, bits 0-15</p></td>
</tr>
<tr class="row-even"><td><p>round()</p></td>
<td><p>The same as ANSI C99 round()</p></td>
</tr>
</tbody>
</table>
<p>Note! Use bankbyte() with WLA-65816 as on that platform the bank (+ base) bits
are 16-23. On other platforms bank() works better.</p>
</section>
<section id="examples-of-functions">
<h2><span class="section-number">8.2. </span>Examples of functions<a class="headerlink" href="#examples-of-functions" title="Permalink to this headline">¶</a></h2>
<p>Here’s an example about how these functions can be used</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">.</span><span class="n">IF</span> <span class="n">defined</span><span class="p">(</span><span class="n">USE_DEBUG</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="n">defined</span><span class="p">(</span><span class="n">DEBUG_SHOW</span><span class="p">)</span>

<span class="n">LDX</span> <span class="c1">#loword(CPU_ADDR)           ; instead of (CPU_ADDR &amp; $00FFFF)</span>
<span class="n">LDA</span> <span class="c1">#bankbyte(CPU_ADDR)         ; instead of :CPU_ADDR</span>

<span class="o">.</span><span class="n">ENDIF</span>
</pre></div>
</div>
</section>
</section>
<span id="document-tempfiles"></span><section id="temporary-files">
<h1><span class="section-number">9. </span>Temporary Files<a class="headerlink" href="#temporary-files" title="Permalink to this headline">¶</a></h1>
<p>Note that WLA will generate an temporary files in the current working
directory while it works. On Windows and Unix-like systems, the file is
called <code class="docutils literal notranslate"><span class="pre">.wla%PID%a</span></code>, where <code class="docutils literal notranslate"><span class="pre">%PID%</span></code> is the PID of the process.
For other system, it’s just <code class="docutils literal notranslate"><span class="pre">wla_a.tmp</span></code>.</p>
<p>When WLA finishes its work these two files are deleted as they serve
of no further use.</p>
</section>
<span id="document-compiling"></span><section id="compiling">
<h1><span class="section-number">10. </span>Compiling<a class="headerlink" href="#compiling" title="Permalink to this headline">¶</a></h1>
<section id="compiling-object-files">
<h2><span class="section-number">10.1. </span>Compiling Object Files<a class="headerlink" href="#compiling-object-files" title="Permalink to this headline">¶</a></h2>
<p>To compile an object file use the <code class="docutils literal notranslate"><span class="pre">-o</span> <span class="pre">[OUT]</span></code> option on the command line.</p>
<p>These object files can be linked together (or with library files) later
with WLALINK.</p>
<p>Name object files so that they can be recognized as object files. Normal
suffix is <code class="docutils literal notranslate"><span class="pre">.o</span></code> (WLA default). This can also be changed with <code class="docutils literal notranslate"><span class="pre">.OUTNAME</span></code>.</p>
<p>With object files you can reduce the amount of compiling when editing
small parts of the program. Note also the possibility of using local
labels (starting with <code class="docutils literal notranslate"><span class="pre">_</span></code>).</p>
<p><strong>Note</strong>: When you compile objects, group 1 directives are saved for linking
time, when they are all compared and if they differ, an error message is
shown. It is advisable to use something like an include file to hold all
the group 1 directives for that particular project and include it to every
object file.</p>
<p>If you are interested in the WLA object file format, take a look at the
file <code class="docutils literal notranslate"><span class="pre">txt/wla_file_formats.txt</span></code> which is included in the release archive.</p>
<p>Here are some examples of definitions:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">-D</span> <span class="pre">IEXIST</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">-D</span> <span class="pre">DAY=10</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">-D</span> <span class="pre">BASE</span> <span class="pre">=</span> <span class="pre">$10</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">-D</span> <span class="pre">NAME=elvis</span></code></p></li>
</ul>
<p>And here’s an WLA example creating definitions on the command line:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">wla</span><span class="o">-</span><span class="n">gb</span> <span class="o">-</span><span class="n">D</span> <span class="n">DEBUG</span> <span class="o">-</span><span class="n">D</span> <span class="n">VERBOSE</span><span class="o">=</span><span class="mi">5</span> <span class="o">-</span><span class="n">D</span> <span class="n">NAME</span> <span class="o">=</span> <span class="s2">&quot;math v1.0&quot;</span> <span class="o">-</span><span class="n">o</span> <span class="n">math</span><span class="o">.</span><span class="n">o</span> <span class="n">math</span><span class="o">.</span><span class="n">s</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">DEBUG</span></code>’s value will be <code class="docutils literal notranslate"><span class="pre">0</span></code>, <code class="docutils literal notranslate"><span class="pre">VERBOSE</span></code>’s <code class="docutils literal notranslate"><span class="pre">5</span></code> and <code class="docutils literal notranslate"><span class="pre">NAME</span></code> is a
string definition with value <code class="docutils literal notranslate"><span class="pre">math</span> <span class="pre">v1.0</span></code>.
Note that <code class="docutils literal notranslate"><span class="pre">-D</span></code> always needs a space after it, but the rest of the statement
can be optionally stuck inside one word.</p>
</section>
<section id="compiling-library-files">
<h2><span class="section-number">10.2. </span>Compiling Library Files<a class="headerlink" href="#compiling-library-files" title="Permalink to this headline">¶</a></h2>
<p>To compile a library file use the <code class="docutils literal notranslate"><span class="pre">-l</span> <span class="pre">[OUT]</span></code> option on the command line.</p>
<p>Name these files so that they can be recognized as library files. Normal
suffix is <code class="docutils literal notranslate"><span class="pre">.lib</span></code> (WLA default).</p>
<p>With library files you can reduce the amount of compiling. Library files
are meant to hold general functions that can be used in different projects.
Note also the possibility of using local labels (starting with <code class="docutils literal notranslate"><span class="pre">_</span></code>).
Library files consist only of <code class="docutils literal notranslate"><span class="pre">FREE</span></code> sections.</p>
</section>
</section>
<span id="document-linking"></span><section id="linking">
<h1><span class="section-number">11. </span>Linking<a class="headerlink" href="#linking" title="Permalink to this headline">¶</a></h1>
<p>After you have produced one or more object files and perhaps some library
files, you might want to link them together to produce a ROM image / program
file. WLALINK is the program you use for that. Here’s how you use it:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">wlalink</span> <span class="p">[</span><span class="n">OPTIONS</span><span class="p">]</span> <span class="o">&lt;</span><span class="n">LINK</span> <span class="n">FILE</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="n">OUTPUT</span> <span class="n">FILE</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>Choose the option <code class="docutils literal notranslate"><span class="pre">-b</span> <span class="pre">[OUT]</span></code> for program file or <code class="docutils literal notranslate"><span class="pre">-r</span> <span class="pre">[OUT]</span></code> for
ROM image linking. ROM image is all the data in the ROM banks. Program file
is the data between the first used byte and the last used byte. You can also use
<code class="docutils literal notranslate"><span class="pre">-bS</span> <span class="pre">[START</span> <span class="pre">ADDRESS]</span></code> and <code class="docutils literal notranslate"><span class="pre">-bE</span> <span class="pre">[END</span> <span class="pre">ADDRESS]</span></code> to specify the start and
the end addresses of the program. Both are optional.</p>
<p>Link file is a text file that contains information about the files you want
to link together. Here’s the format:</p>
<ol class="arabic">
<li><p>You must define the group for the files. Put the name of the group
inside brackets. Valid group definitions are</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">objects</span><span class="p">]</span>
<span class="p">[</span><span class="n">libraries</span><span class="p">]</span>
<span class="p">[</span><span class="n">header</span><span class="p">]</span>
<span class="p">[</span><span class="n">footer</span><span class="p">]</span>
<span class="p">[</span><span class="n">definitions</span><span class="p">]</span>
<span class="p">[</span><span class="n">ramsections</span><span class="p">]</span>
<span class="p">[</span><span class="n">sections</span><span class="p">]</span>
</pre></div>
</div>
</li>
<li><p>Start to list the file names.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">objects</span><span class="p">]</span>
<span class="n">main</span><span class="o">.</span><span class="n">o</span>
<span class="n">vbi</span><span class="o">.</span><span class="n">o</span>
<span class="n">level_01</span><span class="o">.</span><span class="n">o</span>
<span class="o">...</span>
</pre></div>
</div>
</li>
<li><p>Give parameters to the library files:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">libraries</span><span class="p">]</span>
<span class="n">bank</span> <span class="mi">0</span> <span class="n">slot</span> <span class="mi">1</span> <span class="n">speed</span><span class="o">.</span><span class="n">lib</span>
<span class="n">bank</span> <span class="mi">4</span> <span class="n">slot</span> <span class="mi">2</span> <span class="n">map_data</span><span class="o">.</span><span class="n">lib</span>
<span class="o">...</span>
</pre></div>
</div>
<p>Here you can also use <code class="docutils literal notranslate"><span class="pre">base</span></code> to define the 65816 CPU bank number
(like <code class="docutils literal notranslate"><span class="pre">.BASE</span></code> works in WLA):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>[libraries]
bank 0 slot 1 base $80 speed.lib
bank 4 slot 2 base $80 map_data.lib
...
</pre></div>
</div>
<p>You must tell WLALINK the bank and the slot for the library files.</p>
</li>
<li><p>If you want to use header and/or footer in your project,
you can type the following:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">header</span><span class="p">]</span>
<span class="n">header</span><span class="o">.</span><span class="n">dat</span>
<span class="p">[</span><span class="n">footer</span><span class="p">]</span>
<span class="n">footer</span><span class="o">.</span><span class="n">dat</span>
</pre></div>
</div>
</li>
<li><p>If you have RAMSECTIONs inside the libraries, you must place
the sections inside BANKs and SLOTs (ORG and ORGA are optional).
Note that you can also change the type and priority of the section,
and can use appendto:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>[ramsections]
bank 0 slot 3 org $0 &quot;library 1 vars 1&quot;
bank 0 slot 3 orga $6100 priority 100 force &quot;library 1 vars 2&quot;
bank 0 slot 3 appendto &quot;library 1 vars 2&quot; &quot;library 1 vars 3&quot;
</pre></div>
</div>
</li>
<li><p>If you want to relocate normal sections, do as follows (ORG, ORGA,
KEEP, AFTER, OFFSET, PRIORITY, WINDOW, BITWINDOW and APPENDTO are
optional, but useful):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>[sections]
bank 0 slot 1 org $100 appendto &quot;MusicPlayers&quot; &quot;MusicPlayer1&quot;
bank 0 slot 1 orga $2200 semisubfree priority 100 keep bitwindow 8 &quot;EnemyAI&quot;
bank 0 slot 2 after &quot;Enemies&quot; offset 256 &quot;Dragon&quot;
</pre></div>
</div>
</li>
<li><p>If you want to make value definitions, here’s your chance:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>[definitions]
debug 1
max_str_len 128
start $150
...
</pre></div>
</div>
</li>
</ol>
<p>If flag <code class="docutils literal notranslate"><span class="pre">v</span></code> is used, WLALINK displays information about ROM file after a
succesful linking.</p>
<p>If flag <code class="docutils literal notranslate"><span class="pre">R</span></code> is used the file paths inside the link file are relative
to the directory where the link file is, not relative to current working
directory.</p>
<p>If flag <code class="docutils literal notranslate"><span class="pre">nS</span></code> is used, WLALINK doesn’t sort the sections at all, so they
are placed in the output in their order of appearance.</p>
<p>If flag <code class="docutils literal notranslate"><span class="pre">s</span></code> is used, WLALINK will produce a NO$GMB/NO$SNES symbol file. It’s
useful when you work under MSDOS (NO$GMB is a very good Game Boy emulator for
MSDOS/Windows) as it contains information about the labels in your project.</p>
<p>If flag <code class="docutils literal notranslate"><span class="pre">S</span></code> is used, WLALINK will create a WLA symbol file, that is much
like NO$GMB symbol file, but shows also symbols, defines, and breakpoints, not
just labels.</p>
<p>If flag <code class="docutils literal notranslate"><span class="pre">d</span></code> is used, WLALINK discards all unreferenced <code class="docutils literal notranslate"><span class="pre">FREE</span></code>, <code class="docutils literal notranslate"><span class="pre">SEMIFREE</span></code>,
<code class="docutils literal notranslate"><span class="pre">SEMISUBFREE</span></code>, <code class="docutils literal notranslate"><span class="pre">SUPERFREE</span></code> and <code class="docutils literal notranslate"><span class="pre">RAM</span></code> sections. This way you can link big
libraries to your project and WLALINK will choose only the used sections, so you
won’t be linking any dead code/data.</p>
<p>If flag <code class="docutils literal notranslate"><span class="pre">D</span></code> is used, WLALINK doesn’t create any _sizeof_* labels. Note that
to disable fully _sizeof_* label creation, you’ll also need to give WLA the
<code class="docutils literal notranslate"><span class="pre">s</span></code> flag.</p>
<p>If flag <code class="docutils literal notranslate"><span class="pre">t</span></code> is used with <code class="docutils literal notranslate"><span class="pre">c64PRG</span></code>, WLALINK will add a two byte header to the
program file (use with flag <code class="docutils literal notranslate"><span class="pre">b</span></code>). The header contains the load address for
the PRG. Use the flag <code class="docutils literal notranslate"><span class="pre">a</span></code> to specify the load address. It can be a value or
the name of a label.</p>
<p>If flag <code class="docutils literal notranslate"><span class="pre">i</span></code> is given, WLALINK will write list files. Note that you must
compile the object and library files with <code class="docutils literal notranslate"><span class="pre">-i</span></code> flag as well. Otherwise
WLALINK has no extra information it needs to build list files. Here is an
example of a list file: Let’s assume you’ve compiled a source file called
<code class="docutils literal notranslate"><span class="pre">main.s</span></code> using the <code class="docutils literal notranslate"><span class="pre">i</span></code> flag. After you’ve linked the result also with the
<code class="docutils literal notranslate"><span class="pre">i</span></code> flag WLALINK has created a list file called <code class="docutils literal notranslate"><span class="pre">main.lst</span></code>. This file
contains the source text and the result data the source compiled into. List
files are good for debugging. NOTE: list file data can currently be generated
only for code inside sections. <code class="docutils literal notranslate"><span class="pre">.MACRO</span></code> calls and <code class="docutils literal notranslate"><span class="pre">.REPT</span></code> s don’t produce
list file data either.</p>
<p>If flag <code class="docutils literal notranslate"><span class="pre">L</span></code> is given after the above options, WLALINK will use the
directory specified after the flag for including libraries. If WLALINK
cannot find the library in the specified directory, it will then silently
search the current working directory. This is useful when using WLA in an SDK
environment where a global path is needed.</p>
<p>Make sure you don’t create duplicate labels in different places in the
memory map as they break the linking loop. Duplicate labels are allowed when
they overlap each other in the destination machine’s memory. Look at the
following example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>...
.BANK 0
.ORG $150

    ...
    LD      A, 1
    CALL    LOAD_LEVEL
    ...

LOAD_LEVEL:
    LD      HL, $2000
    LD      (HL), A
    CALL    INIT_LEVEL
    RET

.BANK 1
.ORG 0

INIT_LEVEL:
    ...
    RET

.BANK 2
.ORG $0

INIT_LEVEL:
    ...
    RET
...
</pre></div>
</div>
<p>Here duplicate <code class="docutils literal notranslate"><span class="pre">INIT_LEVEL</span></code> labels are accepted as they both point to the
same memory address (in the program’s point of view).</p>
<p>Note that when you use .RAMSECTIONs, WLALINK will generate labels
RAM_USAGE_SLOT_[slot name/id]_BANK_[bank number]_START and
RAM_USAGE_SLOT_[slot name/id]_BANK_[bank number]_END that contain the
addresses of the first and last used byte in the RAM bank/slot. Note that
this only uses .RAMSECTION information to calculate the addresses, not
.ENUMs or anything else.</p>
<p>Examples:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">seravy</span><span class="nd">@localhost</span> <span class="n">tbp</span><span class="p">]</span><span class="c1"># wlalink -r linkfile testa.sfc</span>
<span class="p">[</span><span class="n">seravy</span><span class="nd">@localhost</span> <span class="n">tbp</span><span class="p">]</span><span class="c1"># wlalink -d -i -b linkfile testb.sfc</span>
<span class="p">[</span><span class="n">seravy</span><span class="nd">@localhost</span> <span class="n">tbp</span><span class="p">]</span><span class="c1"># wlalink -v -S -L ../../lib linkfile testc.sfc</span>
<span class="p">[</span><span class="n">seravy</span><span class="nd">@localhost</span> <span class="n">tbp</span><span class="p">]</span><span class="c1"># wlalink -v -b -s -t c64PRG -a LOAD_ADDRESS linkfile linked.prg</span>
</pre></div>
</div>
</section>
<span id="document-arithmetics"></span><section id="arithmetics">
<h1><span class="section-number">12. </span>Arithmetics<a class="headerlink" href="#arithmetics" title="Permalink to this headline">¶</a></h1>
<p>WLA is able to solve really complex calculations like</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">-</span><span class="p">((</span><span class="n">HELLO</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span> <span class="o">|</span> <span class="mi">3</span><span class="p">)</span>
<span class="n">skeletor_end</span><span class="o">-</span><span class="n">skeletor</span>
<span class="mi">10</span><span class="o">/</span><span class="mf">2.5</span>
</pre></div>
</div>
<p>so you can write something like</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">LD</span> <span class="n">HL</span><span class="p">,</span> <span class="n">data_end</span><span class="o">-</span><span class="n">data</span>
<span class="n">LD</span> <span class="n">A</span><span class="p">,</span> <span class="p">(</span><span class="n">pointer</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">CP</span> <span class="p">(</span><span class="n">TEST</span> <span class="o">+</span> <span class="o">%</span><span class="mi">100</span><span class="p">)</span> <span class="o">&amp;</span> <span class="o">%</span><span class="mi">10101010</span>
</pre></div>
</div>
<p>WLALINK also has this ability so it can compute the pending calculations
WLA wasn’t able to solve.</p>
<p>The following operators are valid:</p>
<table class="docutils align-default">
<tbody>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">|</span></code></p></td>
<td><p>bitwise or</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">&amp;</span></code></p></td>
<td><p>bitwise and</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">^</span></code></p></td>
<td><p>power</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">&lt;&lt;</span></code></p></td>
<td><p>bitwise shift left</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">&gt;&gt;</span></code></p></td>
<td><p>bitwise shift right</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">+</span></code></p></td>
<td><p>plus</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
<td><p>minus</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">#</span></code></p></td>
<td><p>modulo</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">~</span></code></p></td>
<td><p>bitwise xor</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">*</span></code></p></td>
<td><p>multiply</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">/</span></code></p></td>
<td><p>divide</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">&lt;</span></code></p></td>
<td><p>get the low byte</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">&gt;</span></code></p></td>
<td><p>get the high byte</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">:</span></code></p></td>
<td><p>get the bank byte of an address</p></td>
</tr>
</tbody>
</table>
<p>Note that you can do NOT using XOR</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>- ``VALUE_A ~ $FF``   is  8-bit NOT
- ``VALUE_B ~ $FFFF`` is 16-bit NOT
</pre></div>
</div>
<p>Unary XOR (e.g., <code class="docutils literal notranslate"><span class="pre">~$FF</span></code>) is the same as NOT.</p>
<p><code class="docutils literal notranslate"><span class="pre">.IF</span></code> conditions have the following additional operators:</p>
<table class="docutils align-default">
<tbody>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">!</span></code></p></td>
<td><p>not</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">&lt;</span></code></p></td>
<td><p>smaller than (note that outside <code class="docutils literal notranslate"><span class="pre">.IF</span></code> this is something else)</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">&gt;</span></code></p></td>
<td><p>larger than (note that outside <code class="docutils literal notranslate"><span class="pre">.IF</span></code> this is something else)</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">&lt;=</span></code></p></td>
<td><p>smaller or equal</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">&gt;=</span></code></p></td>
<td><p>larger or equal</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">==</span></code></p></td>
<td><p>equal</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">!=</span></code></p></td>
<td><p>unequal</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">||</span></code></p></td>
<td><p>logical or</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">&amp;&amp;</span></code></p></td>
<td><p>logical and</p></td>
</tr>
</tbody>
</table>
<p>Here’s a table of the precedence of the operators in calculations and conditions
(higher priority operators come first):</p>
<table class="docutils align-default">
<tbody>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">(</span></code> <code class="docutils literal notranslate"><span class="pre">)</span></code></p></td>
<td><p>expression</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">~</span></code> <code class="docutils literal notranslate"><span class="pre">!</span></code></p></td>
<td><p>unary</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">&lt;</span></code> <code class="docutils literal notranslate"><span class="pre">&gt;</span></code> <code class="docutils literal notranslate"><span class="pre">:</span></code></p></td>
<td><p>low byte / high byte / bank (outside <code class="docutils literal notranslate"><span class="pre">.IF</span></code>)</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">/</span></code> <code class="docutils literal notranslate"><span class="pre">*</span></code> <code class="docutils literal notranslate"><span class="pre">#</span></code> <code class="docutils literal notranslate"><span class="pre">^</span></code></p></td>
<td><p>multiplicative</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">+</span></code> <code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
<td><p>additive</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">&lt;&lt;</span></code> <code class="docutils literal notranslate"><span class="pre">&gt;&gt;</span></code></p></td>
<td><p>bitwise shift</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">&lt;</span></code> <code class="docutils literal notranslate"><span class="pre">&gt;</span></code> <code class="docutils literal notranslate"><span class="pre">&lt;=</span></code> <code class="docutils literal notranslate"><span class="pre">&gt;=</span></code></p></td>
<td><p>relational (only inside <code class="docutils literal notranslate"><span class="pre">.IF</span></code>)</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">==</span></code> <code class="docutils literal notranslate"><span class="pre">!=</span></code></p></td>
<td><p>equality (only inside <code class="docutils literal notranslate"><span class="pre">.IF</span></code>)</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">&amp;</span></code></p></td>
<td><p>bitwise and</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">~</span></code></p></td>
<td><p>bitwise xor</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">|</span></code></p></td>
<td><p>bitwise or</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">&amp;&amp;</span></code></p></td>
<td><p>logical and</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">||</span></code></p></td>
<td><p>logical or</p></td>
</tr>
</tbody>
</table>
<p>WLA computes internally with real numbers so <code class="docutils literal notranslate"><span class="pre">(5/2)*2</span></code> produces <code class="docutils literal notranslate"><span class="pre">5</span></code>,
not <code class="docutils literal notranslate"><span class="pre">4</span></code>.</p>
</section>
<span id="document-bintodb"></span><section id="binary-to-db-conversion">
<h1><span class="section-number">13. </span>Binary to DB Conversion<a class="headerlink" href="#binary-to-db-conversion" title="Permalink to this headline">¶</a></h1>
<p>WLAB converts binary files to WLA’s byte definition strings. Here’s how
you use it:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">wlab</span> <span class="o">-</span><span class="p">[</span><span class="n">ap</span><span class="p">]{</span><span class="n">bdh</span><span class="p">}</span> <span class="o">&lt;</span><span class="n">BIN</span> <span class="n">FILE</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>Give it the binary file and WLAB will output the WLA DB formatted data of it
into stdout. Here’s an example from real life:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">wlab</span> <span class="o">-</span><span class="n">da</span> <span class="n">gayskeletor</span><span class="o">.</span><span class="n">bin</span> <span class="o">&gt;</span> <span class="n">gayskeletor</span><span class="o">.</span><span class="n">s</span>
</pre></div>
</div>
<p>WLAB has three command flags of which one must be given to WLAB:</p>
<dl class="option-list">
<dt><kbd><span class="option">-b</span></kbd></dt>
<dd><p>Output data in binary format.</p>
</dd>
<dt><kbd><span class="option">-d</span></kbd></dt>
<dd><p>Output data in decimal format.</p>
</dd>
<dt><kbd><span class="option">-h</span></kbd></dt>
<dd><p>Output data in hexadecimal format.</p>
</dd>
</dl>
<p>WLAB has also two option flags:</p>
<dl class="option-list">
<dt><kbd><span class="option">-a</span></kbd></dt>
<dd><p>Print the address (relative to the beginning of the data).</p>
</dd>
<dt><kbd><span class="option">-p</span></kbd></dt>
<dd><p>Don’t print file header.</p>
</dd>
</dl>
<p>Examples:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">seravy</span><span class="nd">@localhost</span> <span class="n">src</span><span class="p">]</span><span class="c1"># wlab -bap iscandar.bin &gt; iscandar.s</span>
<span class="p">[</span><span class="n">seravy</span><span class="nd">@localhost</span> <span class="n">src</span><span class="p">]</span><span class="c1"># wlab -h starsha.bin &gt; starsha.s</span>
</pre></div>
</div>
</section>
<span id="document-codetoknow"></span><section id="things-you-should-know-about-coding-for">
<h1><span class="section-number">14. </span>Things you should know about coding for…<a class="headerlink" href="#things-you-should-know-about-coding-for" title="Permalink to this headline">¶</a></h1>
<p>Please be aware that the source code files in there are mainly used to test that
the compiler and linker work, they are not possibly good examples of how you should
write code using WLA DX.</p>
<section id="z80">
<h2><span class="section-number">14.1. </span>Z80<a class="headerlink" href="#z80" title="Permalink to this headline">¶</a></h2>
<p>Check the Z80 specific directives. All SMS/GG coders should find <code class="docutils literal notranslate"><span class="pre">.SMSTAG</span></code>,
<code class="docutils literal notranslate"><span class="pre">.SDSCTAG</span></code> and <code class="docutils literal notranslate"><span class="pre">.COMPUTESMSCHECKSUM</span></code> very useful…</p>
<p>There are shadow register aliases for opcodes that use registers A, F, BC, DE and HL.
The shadow register versions are just for convenience, if the programmer wants to
explicitly show that he is now using the shadow registers. For example:</p>
<blockquote>
<div><p>AND A     ; (original, assembles to 0xA7)
AND A’    ; (alias, assembles to 0xA7 and is in reality “AND A”)</p>
</div></blockquote>
<p>Opcodes that make relative label references:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">JR</span> <span class="o">*</span>
<span class="n">DJNZ</span>
</pre></div>
</div>
</section>
<section id="codesub6502">
<span id="id1"></span><h2><span class="section-number">14.2. </span>6502<a class="headerlink" href="#codesub6502" title="Permalink to this headline">¶</a></h2>
<p>For example mnemonics <code class="docutils literal notranslate"><span class="pre">ADC</span></code>, <code class="docutils literal notranslate"><span class="pre">AND</span></code>, <code class="docutils literal notranslate"><span class="pre">ASL</span></code>, etc… cause problems to WLA,
because they take different sized arguments. Take a look at this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>LSR 11       ; $46 $0B
LSR $A000    ; $4E $00 $A0
</pre></div>
</div>
<p>The first one could also be</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>LSR 11       ; $4E $0B $00
</pre></div>
</div>
<p>To really get what you want, use <code class="docutils literal notranslate"><span class="pre">.8BIT</span></code>, <code class="docutils literal notranslate"><span class="pre">.16BIT</span></code> and <code class="docutils literal notranslate"><span class="pre">.24BIT</span></code>
directives. Or even better, supply WLA the size of the argument:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>LSR 11.W     ; $4E $0B $00
</pre></div>
</div>
<p>Opcodes that make relative label references:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">BCC</span>
<span class="n">BCS</span>
<span class="n">BEQ</span>
<span class="n">BMI</span>
<span class="n">BNE</span>
<span class="n">BPL</span>
<span class="n">BVC</span>
<span class="n">BVS</span>
</pre></div>
</div>
</section>
<section id="c02">
<h2><span class="section-number">14.3. </span>65C02<a class="headerlink" href="#c02" title="Permalink to this headline">¶</a></h2>
<p>Read the subsection <a class="reference internal" href="#codesub6502"><span class="std std-ref">6502</span></a> as the information applies also to 65C02
coding…</p>
<p>Opcodes that make relative label references:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">BCC</span>
<span class="n">BCS</span>
<span class="n">BEQ</span>
<span class="n">BMI</span>
<span class="n">BNE</span>
<span class="n">BPL</span>
<span class="n">BVC</span>
<span class="n">BVS</span>
<span class="n">BRA</span>
<span class="n">BBR</span><span class="o">*</span>
<span class="n">BBS</span><span class="o">*</span>
</pre></div>
</div>
</section>
<section id="ce02">
<h2><span class="section-number">14.4. </span>65CE02<a class="headerlink" href="#ce02" title="Permalink to this headline">¶</a></h2>
<p>Read the subsection <a class="reference internal" href="#codesub6502"><span class="std std-ref">6502</span></a> as the information applies also to 65CE02
coding…</p>
<p>Opcodes that make relative label references:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">BCC</span>
<span class="n">BCS</span>
<span class="n">BEQ</span>
<span class="n">BMI</span>
<span class="n">BNE</span>
<span class="n">BPL</span>
<span class="n">BVC</span>
<span class="n">BVS</span>
<span class="n">BRA</span>
<span class="n">BSR</span>
<span class="n">BBR</span><span class="o">*</span>
<span class="n">BBS</span><span class="o">*</span>
</pre></div>
</div>
</section>
<section id="id2">
<h2><span class="section-number">14.5. </span>65816<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h2>
<p>Read the subsection <a class="reference internal" href="#codesub6502"><span class="std std-ref">6502</span></a> as the information applies also to 65816
coding…</p>
<p>WLA-65816 has also few SNES specific directives which are all very
helpful. Remember that when you use <code class="docutils literal notranslate"><span class="pre">.LOROM</span></code>, <code class="docutils literal notranslate"><span class="pre">.HIROM</span></code>, <code class="docutils literal notranslate"><span class="pre">.SLOWROM</span></code> and
<code class="docutils literal notranslate"><span class="pre">.FASTROM</span></code> WLA automatically writes the information into the output.
<code class="docutils literal notranslate"><span class="pre">.COMPUTESNESCHECKSUM</span></code>, <code class="docutils literal notranslate"><span class="pre">.SNESHEADER</span></code> and few others could also be useful.</p>
<p>Use <code class="docutils literal notranslate"><span class="pre">.BASE</span></code> to set the upmost eight bits of 24-bit addresses.</p>
<p>If possible, use operand hints to specify the size of the operand.
WLA is able to deduce the accumulator/index mode to some extent from
<code class="docutils literal notranslate"><span class="pre">REP</span></code>/<code class="docutils literal notranslate"><span class="pre">SEP</span></code>-mnemonics and <code class="docutils literal notranslate"><span class="pre">.ACCU</span></code> and <code class="docutils literal notranslate"><span class="pre">.INDEX</span></code>-directives, but just to
be sure, terminate the operand with <code class="docutils literal notranslate"><span class="pre">.B</span></code>, <code class="docutils literal notranslate"><span class="pre">.W</span></code> or <code class="docutils literal notranslate"><span class="pre">.L</span></code>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">AND</span> <span class="c1">#10     ; can be two different things, depending on the size of the accu.</span>
<span class="n">AND</span> <span class="c1">#10.B   ; forces 8-bit immediate value.</span>
<span class="n">AND</span> <span class="c1">#10.W   ; forces 16-bit immediate value.</span>
</pre></div>
</div>
<p>Or if you must, these work as well:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">AND</span><span class="o">.</span><span class="n">B</span> <span class="c1">#10   ; the same as &quot;AND #10.B&quot;.</span>
<span class="n">AND</span><span class="o">.</span><span class="n">W</span> <span class="c1">#10   ; the same as &quot;AND #10.W&quot;.</span>
</pre></div>
</div>
<p>Opcodes that make relative label references:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">BCC</span>
<span class="n">BCS</span>
<span class="n">BEQ</span>
<span class="n">BMI</span>
<span class="n">BNE</span>
<span class="n">BPL</span>
<span class="n">BVC</span>
<span class="n">BVS</span>
<span class="n">BRA</span>
<span class="n">BRL</span>
<span class="n">PER</span>
</pre></div>
</div>
<p>Use <code class="docutils literal notranslate"><span class="pre">.WDC</span></code> to start parsing WDC standard assembly code. <code class="docutils literal notranslate"><span class="pre">.NOWDC</span></code> sets
the parser to parse WLA syntax assembly code.</p>
</section>
<section id="huc6280">
<h2><span class="section-number">14.6. </span>HUC6280<a class="headerlink" href="#huc6280" title="Permalink to this headline">¶</a></h2>
<p>Read the subsection <a class="reference internal" href="#codesub6502"><span class="std std-ref">6502</span></a> as the information applies also to
HUC6280 coding…</p>
<p>Opcodes that make relative label references:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">BCC</span>
<span class="n">BCS</span>
<span class="n">BEQ</span>
<span class="n">BMI</span>
<span class="n">BNE</span>
<span class="n">BPL</span>
<span class="n">BVC</span>
<span class="n">BVS</span>
<span class="n">BSR</span>
<span class="n">BBR</span><span class="o">*</span>
<span class="n">BBS</span><span class="o">*</span>
</pre></div>
</div>
</section>
<section id="spc-700">
<h2><span class="section-number">14.7. </span>SPC-700<a class="headerlink" href="#spc-700" title="Permalink to this headline">¶</a></h2>
<p>Note that you’ll have to put an exclamation mark before a 16-bit value.
For example,</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>CALL !Main
AND  A, !$1000
</pre></div>
</div>
<p>Opcodes that make relative label references:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">BCC</span>
<span class="n">BCS</span>
<span class="n">BEQ</span>
<span class="n">BMI</span>
<span class="n">BNE</span>
<span class="n">BPL</span>
<span class="n">BVC</span>
<span class="n">BVS</span>
<span class="n">BRA</span>
<span class="n">BBS</span>
<span class="n">BBC</span>
<span class="n">CBNE</span> <span class="o">*</span>
<span class="n">DBNZ</span> <span class="o">*</span>
</pre></div>
</div>
</section>
<section id="pocket-voice-gb-z80">
<h2><span class="section-number">14.8. </span>Pocket Voice (GB-Z80)<a class="headerlink" href="#pocket-voice-gb-z80" title="Permalink to this headline">¶</a></h2>
<p>Pocket Voice uses its own MBC. You can enable Pocket Voice mode by selecting
Pocket Voice cartridge type (<code class="docutils literal notranslate"><span class="pre">$BE</span></code> in <code class="docutils literal notranslate"><span class="pre">$0147</span></code>) and defining correct
<code class="docutils literal notranslate"><span class="pre">.ROMBANKMAP</span></code> and <code class="docutils literal notranslate"><span class="pre">.MEMORYMAP</span></code>. In PV mode bank 0 is 24KB and the rest are
8KB.</p>
<p>Note that WLA assumes that ROM offset is all the time 0. If you use
something else as the offset, make sure to compute the jumps by hand as WLA
cannot do that.</p>
<p>Check out <code class="docutils literal notranslate"><span class="pre">tests/gb-z80/include/pocket_voice.i</span></code> for more information.</p>
</section>
<section id="gb-z80">
<h2><span class="section-number">14.9. </span>GB-Z80<a class="headerlink" href="#gb-z80" title="Permalink to this headline">¶</a></h2>
<p>WLA outputs only <code class="docutils literal notranslate"><span class="pre">$10</span></code> when it decodes <code class="docutils literal notranslate"><span class="pre">STOP</span></code>. Often it’s necessary to put
an extra <code class="docutils literal notranslate"><span class="pre">NOP</span></code> (<code class="docutils literal notranslate"><span class="pre">$00</span></code>) after a <code class="docutils literal notranslate"><span class="pre">STOP</span></code>, and sometimes something else, but
that’s left entirely to the user.</p>
<p>Opcodes that make relative label references:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">JR</span> <span class="o">*</span>
</pre></div>
</div>
</section>
</section>
<span id="document-wlaflags"></span><section id="wla-flags">
<h1><span class="section-number">15. </span>WLA Flags<a class="headerlink" href="#wla-flags" title="Permalink to this headline">¶</a></h1>
<p>Here are short descriptions for the flags you can give to WLA:</p>
<p>You can supply WLA with some (or all or none) of the following option flags.</p>
<dl class="option-list">
<dt><kbd><span class="option">-h</span></kbd></dt>
<dd><p>Assume that all label references are 16-bit by default (size hints
still work). Without this flag it’s assumed that label references are
8-bit unless otherwise specified.</p>
</dd>
<dt><kbd><span class="option">-i</span></kbd></dt>
<dd><p>Add list file information. Adds extra information to the output so
WLALINK can produce list files.</p>
</dd>
<dt><kbd><span class="option">-k</span></kbd></dt>
<dd><p>Keep all empty sections. By default they are discarded.</p>
</dd>
<dt><kbd><span class="option">-M</span></kbd></dt>
<dd><p>WLA generates makefile rules describing the dependencies of the main
source file. Use only with flags <code class="docutils literal notranslate"><span class="pre">o</span></code> and <code class="docutils literal notranslate"><span class="pre">l</span></code>.</p>
</dd>
<dt><kbd><span class="option">-q</span></kbd></dt>
<dd><p>Quiet mode. <code class="docutils literal notranslate"><span class="pre">.PRINT*</span></code> -directives output nothing.</p>
</dd>
<dt><kbd><span class="option">-s</span></kbd></dt>
<dd><p>Don’t create _sizeof_* and _padding_* definitions.</p>
</dd>
<dt><kbd><span class="option">-t</span></kbd></dt>
<dd><p>Test compile. Doesn’t output any files.</p>
</dd>
<dt><kbd><span class="option">-v</span></kbd></dt>
<dd><p>Verbose mode. Shows a lot of information about the compiling process.</p>
</dd>
<dt><kbd><span class="option">-x</span></kbd></dt>
<dd><p>Extra compile time labels and definitions. WLA does extra work by creating
few helpful definitions, and labels SECTIONSTART_[section name] and
SECTIONEND_[section name] at the beginning and end of a section.</p>
</dd>
<dt><kbd><span class="option">-D</span></kbd></dt>
<dd><p>Declare a definition.</p>
</dd>
</dl>
<p>One (and only one) of the following command flags must be defined.</p>
<dl class="option-list">
<dt><kbd><span class="option">-l</span></kbd></dt>
<dd><p>Output a library file.</p>
</dd>
<dt><kbd><span class="option">-o</span></kbd></dt>
<dd><p>Output an object file.</p>
</dd>
</dl>
<p>You may also use an extra option to specify the include directory. WLA will
search this directory for included files before defaulting to the specified
<code class="docutils literal notranslate"><span class="pre">.INCDIR</span></code> or current working directory.</p>
<dl class="option-list">
<dt><kbd><span class="option">-I</span></kbd></dt>
<dd><p>Directory to include files.</p>
</dd>
</dl>
<p>Examples:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">seravy</span><span class="nd">@localhost</span> <span class="n">tbp</span><span class="p">]</span><span class="c1"># wla -D VERSION=255 -x -v -i -o testa.o testa.s</span>
<span class="p">[</span><span class="n">seravy</span><span class="nd">@localhost</span> <span class="n">tbp</span><span class="p">]</span><span class="c1"># wla -M -o testa.o testa.s</span>
<span class="p">[</span><span class="n">seravy</span><span class="nd">@localhost</span> <span class="n">tbp</span><span class="p">]</span><span class="c1"># wla -D VERSION=$FF -D MESSAGE=\&quot;Hello world\&quot; -l testb.lib testb.s</span>
<span class="p">[</span><span class="n">seravy</span><span class="nd">@localhost</span> <span class="n">tbp</span><span class="p">]</span><span class="c1"># wla -I ../../include -l testb.lib testb.s</span>
<span class="p">[</span><span class="n">seravy</span><span class="nd">@localhost</span> <span class="n">tbp</span><span class="p">]</span><span class="c1"># wla -M -I myfiles -l testa.lib testa.s</span>
</pre></div>
</div>
<p>Note that the first example produces a file named <code class="docutils literal notranslate"><span class="pre">testa.o</span></code>.</p>
</section>
<span id="document-extraflags"></span><section id="extra-compile-time-definitions">
<h1><span class="section-number">16. </span>Extra compile time definitions<a class="headerlink" href="#extra-compile-time-definitions" title="Permalink to this headline">¶</a></h1>
<p>When you supply WLA with the flag <code class="docutils literal notranslate"><span class="pre">x</span></code> it will maintain few useful definitions
and labels while compiling your source codes. Please use the enhanced error
reporting engine (so don’t use flag <code class="docutils literal notranslate"><span class="pre">f</span></code>) in conjunction with flag <code class="docutils literal notranslate"><span class="pre">x</span></code> as
some of the definitions require extra information about the flow of the data
which isn’t available when using the old, crippled error reporting engine.</p>
<p>Here’s a list of definitions you get when you use flag <code class="docutils literal notranslate"><span class="pre">x</span></code>:</p>
<table class="docutils align-default">
<tbody>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">WLA_FILENAME</span></code></p></td>
<td><p>A string definition holding the file name WLA is
currently processing.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">WLA_TIME</span></code></p></td>
<td><p>A string definition holding the calendar time
(obtained using C’s <code class="docutils literal notranslate"><span class="pre">ctime()</span></code>).</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">WLA_VERSION</span></code></p></td>
<td><p>A string definition holding the version number of WLA.</p></td>
</tr>
</tbody>
</table>
<p>So you can do for example something like</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">.</span><span class="n">DB</span> <span class="n">WLA_TIME</span>
</pre></div>
</div>
<p>to store the time when the build process started into the ROM file you
are compiling.</p>
<p>Definition <code class="docutils literal notranslate"><span class="pre">CADDR</span></code>, which is present without supplying the flag <code class="docutils literal notranslate"><span class="pre">x</span></code>,
contains the current 16-bit memory address. So</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">LD</span> <span class="n">HL</span><span class="p">,</span> <span class="n">CADDR</span>
</pre></div>
</div>
<p>will load the address of the operand data into registers <code class="docutils literal notranslate"><span class="pre">H</span></code> and <code class="docutils literal notranslate"><span class="pre">L</span></code>.</p>
<p><strong>CAVEAT</strong>:
Remember when using defines that contain <code class="docutils literal notranslate"><span class="pre">CADDR</span></code> gets the address of the place
where the definition is used, not the address of the definition, which contains
the <code class="docutils literal notranslate"><span class="pre">CADDR</span></code>.</p>
<p>Note that you’ll also get all these definitions in lower case
(e.g., <code class="docutils literal notranslate"><span class="pre">wla_filename</span></code>).</p>
<p>But that is not all. You will also get SECTIONSTART_[section name] labels
that are inserted into the start of every section, and SECTIONEND_[section name]
labels that are inserted into the end of every section.</p>
</section>
<span id="document-goodtoknow"></span><section id="good-things-to-know-about-wla">
<h1><span class="section-number">17. </span>Good things to know about WLA<a class="headerlink" href="#good-things-to-know-about-wla" title="Permalink to this headline">¶</a></h1>
<ul class="simple">
<li><p>Is 511 (Amiga, MSDOS) or 2047 (other platforms) bytes too little for a
string (file names, labels, definition labels, etc)? Check out
<code class="docutils literal notranslate"><span class="pre">MAX_NAME_LENGTH</span></code> in <code class="docutils literal notranslate"><span class="pre">shared.h</span></code>.</p></li>
<li><p>Want to have more operators and operands in a calculation than 64 (Amiga,
MSDOS) or 256 (other platforms)? Check out <code class="docutils literal notranslate"><span class="pre">MAX_STACK_CALCULATOR_ITEMS</span></code>
in <code class="docutils literal notranslate"><span class="pre">defines.h</span></code>.</p></li>
<li><p>WLA preprocessor doesn’t expand macros and repetitions. Those are actually
traversed in the assembling phase.</p></li>
<li><p>WLA’s source code is mainly a huge mess, but WLALINK is quite well
structured and written. So beware!</p></li>
<li><p>To get the length of a string e.g. “peasoup”, write “peasoup”.length.</p></li>
<li><p>Do not write <code class="docutils literal notranslate"><span class="pre">.E</span></code> into your sources as WLA uses it internally to mark
the end of a file.</p></li>
</ul>
</section>
<span id="document-archoverview"></span><section id="wla-dx-s-architectural-overview">
<h1><span class="section-number">18. </span>WLA DX’s architectural overview<a class="headerlink" href="#wla-dx-s-architectural-overview" title="Permalink to this headline">¶</a></h1>
<p>The two most important executables inside WLA DX are WLA (the assembler)
and WLALINK (the linker).</p>
<section id="wla">
<h2><span class="section-number">18.1. </span>WLA<a class="headerlink" href="#wla" title="Permalink to this headline">¶</a></h2>
<p>WLA has four separate phases, called a little bit incorrectly passes:</p>
<ol class="arabic simple">
<li><p><code class="docutils literal notranslate"><span class="pre">pass_1.c</span></code>: <code class="docutils literal notranslate"><span class="pre">pass_1()</span></code>:</p>
<ul class="simple">
<li><p>The biggest data processor in WLA.</p></li>
<li><p>Includes the include files: every time time happens the file is read in,
white space is removed, lines formatted, etc.</p></li>
<li><p>Macros are processed along with directives</p></li>
<li><p>All textual data, code, etc. are transformed into WLA’s internal byte
code that gets written into a tmp (TMP) file, and after this phase
the assembler or the linker has no idea of target CPU’s opcodes - all is
just pure WLA byte code.</p></li>
<li><p>The first and the only pass that handles the assembly source files
supplied by the user.</p></li>
<li><p>The parser in this pass starts from the first byte of the first source
file, then moves forward parsing everything that it encounters, but
when a macro is called, the parser jumps to the beginning of the macro,
and continues parsing from there.</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">pass_2.c</span></code>: <code class="docutils literal notranslate"><span class="pre">pass_2()</span></code>:</p>
<ul class="simple">
<li><p>If the user has issued directives like <code class="docutils literal notranslate"><span class="pre">.SDSCTAG</span></code>, here we generate the
needed data and write that into TMP.</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">pass_3.c</span></code>: <code class="docutils literal notranslate"><span class="pre">pass_3()</span></code>:</p>
<ul class="simple">
<li><p>Here we read in TMP and do some sanity checks for the data, give labels
addresses (if possible), generate internal structures for labels and
sections.</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">pass_4.c</span></code>: <code class="docutils literal notranslate"><span class="pre">pass_4()</span></code>:</p>
<ul class="simple">
<li><p>Again we read in TMP.</p></li>
<li><p>Now we check that if there is a reference to a calculation, and that
calculation has been succesfully calculated, then we can replace the
reference with the result.</p></li>
<li><p>This phase writes out object and library files, i.e., transforms TMP
to final output files (this write out could actually be <code class="docutils literal notranslate"><span class="pre">pass_5</span></code>)…</p></li>
</ul>
</li>
</ol>
</section>
<section id="wlalink">
<h2><span class="section-number">18.2. </span>WLALINK<a class="headerlink" href="#wlalink" title="Permalink to this headline">¶</a></h2>
<p>WLALINK is much simpler and more straight forward than WLA; WLALINK just
reads in all the objects and library files, places the sections along with
labels into the target memory map, solves pending calculations, calculates
checksums, and writes out the final ROM/PRG files.
<code class="docutils literal notranslate"><span class="pre">wlalink/main.c:main()</span></code> should quite clearly display all the higher level
phases in the linking process.</p>
</section>
</section>
<span id="document-symbols"></span><section id="wla-symbols">
<h1><span class="section-number">19. </span>WLA Symbols<a class="headerlink" href="#wla-symbols" title="Permalink to this headline">¶</a></h1>
<p>Symbols can be optionally generated as a part of the assembly and link steps. With a compatible emulator, this can provide extra information for debugging a ROM, or otherwise help in understanding how it operates.</p>
<p>The symbols file can be generated by wlalink by adding “-S” onto the command line. This will output labels, definitions, and some other rudimentary data. Most prominently, this can be used to understand where the ROM output various sections such as subroutines and data, and be able to look that up in the emulator’s ROM or RAM space.</p>
<p>Extra information for address-to-line mapping can be provided by adding the following command line arguments:
- Run object generation (e.g. “wla-65816”) with “-i” to include list data in the output obj files
- Run wlalink with “-S -A” to generate symbols with information related to address-to-line mapping</p>
<p>Address-to-line mappings includes information to relate lines in the source files to individual instructions in the generated ROM. This can be used to provide richer disassembly in the emulator, or allow for rich debugging in an external IDE.</p>
<section id="wla-symbol-version-history">
<h2><span class="section-number">19.1. </span>WLA Symbol Version History<a class="headerlink" href="#wla-symbol-version-history" title="Permalink to this headline">¶</a></h2>
<p>If you are maintaining a WLA symbol file parser, please review this page when new versions of WLA DX are released, as the format might have changed.</p>
<p>Version 1: <a class="reference external" href="https://github.com/vhelin/wla-dx/blob/v9.12/doc/symbols.rst">https://github.com/vhelin/wla-dx/blob/v9.12/doc/symbols.rst</a></p>
<ul class="simple">
<li><p>Base version, including sections [labels], [definitions], [breakpoints], [symbols], [source files], [rom checksum], [addr-to-line mapping]</p></li>
</ul>
<p>Version 2: <a class="reference external" href="https://github.com/vhelin/wla-dx/blob/master/doc/symbols.rst">https://github.com/vhelin/wla-dx/blob/master/doc/symbols.rst</a></p>
<ul class="simple">
<li><p>Added [information] section</p></li>
<li><p>Deprecated [source files] section, and replaced with [source files v2]</p></li>
<li><p>Deprecated [addr-to-line mapping] section definition, and replaced with [addr-to-line mapping v2]</p></li>
</ul>
</section>
<section id="information-for-emulator-developers">
<h2><span class="section-number">19.2. </span>Information For Emulator Developers<a class="headerlink" href="#information-for-emulator-developers" title="Permalink to this headline">¶</a></h2>
<p>In order to properly support loading of WLA symbol files, it is recommended to follow this specification below, especially so as to gracefully support future additions to the symbol files.</p>
<ul class="simple">
<li><p>The file should be read one line at a time</p></li>
<li><p>Any text on a line following a <code class="docutils literal notranslate"><span class="pre">;</span></code> should be ignored</p></li>
<li><p>Lines matching <code class="docutils literal notranslate"><span class="pre">\[\S+\]</span></code> in regex or <code class="docutils literal notranslate"><span class="pre">[%s]</span></code> in scanf code are section headers, and represent a new section. Note that no section data will start with <code class="docutils literal notranslate"><span class="pre">[</span></code>.</p></li>
<li><p>Lines following the section header are the data for that section. If you’re acknowledging the section, utilize that section’s specific formatting. Read lines that match until a new section header is encountered.</p></li>
<li><p>Unless otherwise specified, none of the data in any section should be assumed to be sorted in any particular way.</p></li>
</ul>
<p>The following are the list of currently supported sections, what they mean, and how their data should be interpreted.</p>
<section id="information">
<h3><span class="section-number">19.2.1. </span>[information]<a class="headerlink" href="#information" title="Permalink to this headline">¶</a></h3>
<p>The only fields this section has currently are “version” and then the version number. [information], if present, must always occur before any other section or data, and its first line will always be the format version.</p>
</section>
<section id="labels">
<h3><span class="section-number">19.2.2. </span>[labels]<a class="headerlink" href="#labels" title="Permalink to this headline">¶</a></h3>
<p>This is a list of all labels to sections of the ROM, such as subroutine locations, or data locations. Each line lists an address in hexadecimal (bank and offset) and a string associated with that address. This data could be used, for example, to identify what section a given target address is in, by searching for the label with the closest address less than the target address.</p>
<ul class="simple">
<li><p>Regex match: <code class="docutils literal notranslate"><span class="pre">[0-9a-fA-F]{2}:[0-9a-fA-F]{4}</span> <span class="pre">.*</span></code></p></li>
<li><p>Format specifier: <code class="docutils literal notranslate"><span class="pre">%2x:%4x</span> <span class="pre">%s</span></code></p></li>
</ul>
</section>
<section id="definitions">
<h3><span class="section-number">19.2.3. </span>[definitions]<a class="headerlink" href="#definitions" title="Permalink to this headline">¶</a></h3>
<p>This is a list of various definitions provided in code - or automatically during WLA’s processing - and values associated with them. Most prominently, WLA outputs the size of each section of the ROM. Each line lists an integer value in hexadecimal, and a string (name) associated with that value.</p>
<ul class="simple">
<li><p>Regex match: <code class="docutils literal notranslate"><span class="pre">[0-9a-fA-F]{8}</span> <span class="pre">.*</span></code></p></li>
<li><p>Format specifier: <code class="docutils literal notranslate"><span class="pre">%8x</span> <span class="pre">%s</span></code></p></li>
</ul>
</section>
<section id="breakpoints">
<h3><span class="section-number">19.2.4. </span>[breakpoints]<a class="headerlink" href="#breakpoints" title="Permalink to this headline">¶</a></h3>
<p>This is a list of hexadecimal ROM addresses where the <code class="docutils literal notranslate"><span class="pre">.BREAKPOINT</span></code> directive was used in the source assembly. Each line lists an address in hexadecimal (bank and offset).</p>
<ul class="simple">
<li><p>Regex match: <code class="docutils literal notranslate"><span class="pre">[0-9a-fA-F]{2}:[0-9a-fA-F]{4}</span></code></p></li>
<li><p>Format specificer: <code class="docutils literal notranslate"><span class="pre">%2x:%4x</span></code></p></li>
</ul>
</section>
<section id="symbols">
<h3><span class="section-number">19.2.5. </span>[symbols]<a class="headerlink" href="#symbols" title="Permalink to this headline">¶</a></h3>
<p>This is a list of hexadecimal ROM addresses where the <code class="docutils literal notranslate"><span class="pre">.SYMBOL</span></code> directive was used in the source assembly. Each line lists an address in hexadecimal (bank and offset) and a string associated with that address.</p>
<ul class="simple">
<li><p>Regex match: <code class="docutils literal notranslate"><span class="pre">[0-9a-fA-F]{2}:[0-9a-fA-F]{4}</span> <span class="pre">.*</span></code></p></li>
<li><p>Format specifier: <code class="docutils literal notranslate"><span class="pre">%2x:%4x</span> <span class="pre">%s</span></code></p></li>
</ul>
</section>
<section id="source-files-v2">
<h3><span class="section-number">19.2.6. </span>[source files v2]<a class="headerlink" href="#source-files-v2" title="Permalink to this headline">¶</a></h3>
<p>These are used to identify what files were used during the assembly process, especially to map generated assembly back to source file contents. Each line lists a hexadecimal object file index, a hexadecimal source file index, a hexadecimal CRC32 checksum of the file, and a file path relative to the generated ROM’s root. This could be used to load in the contents of one of the input files when running the ROM and verifying the file is up-to-date by checking its CRC32 checksum against the one generated during assembly.</p>
<ul class="simple">
<li><p>Regex match: <code class="docutils literal notranslate"><span class="pre">[0-9a-fA-F]{4}:[0-9a-fA-F]{4}</span> <span class="pre">[0-9a-fA-F]{8}</span> <span class="pre">.*</span></code></p></li>
<li><p>Format specifier: <code class="docutils literal notranslate"><span class="pre">%4x:%4x</span> <span class="pre">%8x</span> <span class="pre">%s</span></code></p></li>
</ul>
</section>
<section id="rom-checksum">
<h3><span class="section-number">19.2.7. </span>[rom checksum]<a class="headerlink" href="#rom-checksum" title="Permalink to this headline">¶</a></h3>
<p>This is just a single line identifying what the hexadecimal CRC32 checksum of the ROM file was when the symbol file was generated. This could be used to verify that the symbol file itself is up-to-date with the ROM in question. This checksum is calculated by reading the ROM file’s entire binary, and not by reading any platform-specific checksum value embedded in the ROM itself.</p>
<ul class="simple">
<li><p>Regex match:  <code class="docutils literal notranslate"><span class="pre">[0-9a-fA-F]{8}</span></code></p></li>
<li><p>Format specifier: <code class="docutils literal notranslate"><span class="pre">%8x</span></code></p></li>
</ul>
</section>
<section id="addr-to-line-mapping-v2">
<h3><span class="section-number">19.2.8. </span>[addr-to-line mapping v2]<a class="headerlink" href="#addr-to-line-mapping-v2" title="Permalink to this headline">¶</a></h3>
<p>This is a listing of hexadecimal ROM address, bank, ROM bank offset, memory address, each mapped to a hexadecimal object file index, a source file index and hexadecimal line index. The file indices refer back to the file indices specified in the <code class="docutils literal notranslate"><span class="pre">source</span> <span class="pre">files</span></code> section, so that the source file name can be discovered. This information can be used to, for example, display source file information in line with disassembled code, or to communicate with an external text editor the location of the current Program Counter by specifying a source file and line instead of some address in the binary ROM file.</p>
<ul class="simple">
<li><p>Regex match: <code class="docutils literal notranslate"><span class="pre">[0-9a-fA-F]{8}</span> <span class="pre">[0-9a-fA-F]{2}:[0-9a-fA-F]{4}</span> <span class="pre">[0-9a-fA-F]{4}</span> <span class="pre">[0-9a-fA-F]{4}:[0-9a-fA-F]{4}:[0-9a-fA-F]{8}</span></code></p></li>
<li><p>Format specifier: <code class="docutils literal notranslate"><span class="pre">%8x</span> <span class="pre">%2x:%4x</span> <span class="pre">%4x</span> <span class="pre">%4x:%4x:%8x</span></code></p></li>
</ul>
</section>
</section>
</section>
<span id="document-legal"></span><section id="legal-note">
<h1><span class="section-number">20. </span>Legal Note<a class="headerlink" href="#legal-note" title="Permalink to this headline">¶</a></h1>
<p>WLA DX (the whole package) was originally written by Ville Helin in 1998-2008.
After that everybody has been able to take part in the development of WLA DX,
and recently via GitHub. The authors are not responsible for anything the
software does.</p>
<p>WLA DX is GPL software. For more information about GPL, take a look at the
<code class="docutils literal notranslate"><span class="pre">LICENCE</span></code> file.</p>
<p>Game Boy and Game Boy Color are copyrighted by Nintendo.</p>
<p>Pocket Voice is copyrighted by Bung HK.</p>
</section>
</div>
<div class="toctree-wrapper compound">
<span id="document-man/wlalink"></span><section id="manpage-wla-link">
<h1><span class="section-number">1. </span>Manpage: WLA-LINK<a class="headerlink" href="#manpage-wla-link" title="Permalink to this headline">¶</a></h1>
<section id="synopsis">
<h2><span class="section-number">1.1. </span>SYNOPSIS<a class="headerlink" href="#synopsis" title="Permalink to this headline">¶</a></h2>
<div class="line-block">
<div class="line"><code class="docutils literal notranslate"><span class="pre">wlalink</span></code> [<code class="docutils literal notranslate"><span class="pre">OPTIONS</span></code>] <code class="docutils literal notranslate"><span class="pre">LINK_FILE</span></code> <code class="docutils literal notranslate"><span class="pre">OUTPUT_FILE</span></code></div>
</div>
</section>
<section id="options">
<h2><span class="section-number">1.2. </span>OPTIONS<a class="headerlink" href="#options" title="Permalink to this headline">¶</a></h2>
<dl class="option-list">
<dt><kbd><span class="option">-b</span></kbd></dt>
<dd><p>Program file output</p>
</dd>
<dt><kbd><span class="option">-d</span></kbd></dt>
<dd><p>Discard unreferenced sections</p>
</dd>
<dt><kbd><span class="option">-i</span></kbd></dt>
<dd><p>Write list files (Note: WLA needs <code class="docutils literal notranslate"><span class="pre">-i</span></code> as wel)</p>
</dd>
<dt><kbd><span class="option">-r</span></kbd></dt>
<dd><p>ROM file output (default)</p>
</dd>
<dt><kbd><span class="option">-s</span></kbd></dt>
<dd><p>Write also a NO$GMB/NO$SNES symbol file</p>
</dd>
<dt><kbd><span class="option">-S</span></kbd></dt>
<dd><p>Write also a WLA symbol file</p>
</dd>
<dt><kbd><span class="option">-A</span></kbd></dt>
<dd><p>Add address-to-line mapping data to WLA symbol file</p>
</dd>
<dt><kbd><span class="option">-v</span></kbd></dt>
<dd><p>Verbose messages</p>
</dd>
<dt><kbd><span class="option">-L <var>LIBDIR</var></span></kbd></dt>
<dd><p>Look in LIBDIR for libaries before looking in CWD</p>
</dd>
<dt><kbd><span class="option">-t <var>TYPE</var></span></kbd></dt>
<dd><p>Output type (supported types: ‘CBMPRG’)</p>
</dd>
<dt><kbd><span class="option">-a <var>ADDR</var></span></kbd></dt>
<dd><p>Load address for CBM PRG</p>
</dd>
</dl>
<p>Choose one:</p>
<dl class="option-list">
<dt><kbd><span class="option">-b <var>OUT</var></span></kbd></dt>
<dd><p>Program file linking</p>
</dd>
<dt><kbd><span class="option">-r <var>OUT</var></span></kbd></dt>
<dd><p>ROM image linking</p>
</dd>
</dl>
</section>
<section id="description">
<h2><span class="section-number">1.3. </span>DESCRIPTION<a class="headerlink" href="#description" title="Permalink to this headline">¶</a></h2>
<p><em class="manpage">wlalink(1)</em> is a part of WLA-DX. It links one or more object files
(and perhaps some library files) together to produce a ROM image / program file.</p>
<p>LINK_FILE is a text file that contains information about the files you want
to link together. Here’s the format:</p>
<ol class="arabic">
<li><p>You must define the group for the files. Put the name of the group
inside brackets. Valid group definitions are</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">objects</span><span class="p">]</span>
<span class="p">[</span><span class="n">libraries</span><span class="p">]</span>
<span class="p">[</span><span class="n">header</span><span class="p">]</span>
<span class="p">[</span><span class="n">footer</span><span class="p">]</span>
<span class="p">[</span><span class="n">definitions</span><span class="p">]</span>
</pre></div>
</div>
</li>
<li><p>Start to list the file names.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">objects</span><span class="p">]</span>
<span class="n">main</span><span class="o">.</span><span class="n">o</span>
<span class="n">vbi</span><span class="o">.</span><span class="n">o</span>
<span class="n">level_01</span><span class="o">.</span><span class="n">o</span>
<span class="o">...</span>
</pre></div>
</div>
</li>
<li><p>Give parameters to the library files:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">libraries</span><span class="p">]</span>
<span class="n">bank</span> <span class="mi">0</span> <span class="n">slot</span> <span class="mi">1</span> <span class="n">speed</span><span class="o">.</span><span class="n">lib</span>
<span class="n">bank</span> <span class="mi">4</span> <span class="n">slot</span> <span class="mi">2</span> <span class="n">map_data</span><span class="o">.</span><span class="n">lib</span>
<span class="o">...</span>
</pre></div>
</div>
<p>Here you can also use <code class="docutils literal notranslate"><span class="pre">base</span></code> to define the 65816 CPU bank number
(like <code class="docutils literal notranslate"><span class="pre">.BASE</span></code> works in WLA):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>[libraries]
bank 0 slot 1 base $80 speed.lib
bank 4 slot 2 base $80 map_data.lib
...
</pre></div>
</div>
<p>You must tell WLALINK the bank and the slot for the library files.</p>
</li>
<li><p>If you want to use header and/or footer in your project,
you can type the following:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">header</span><span class="p">]</span>
<span class="n">header</span><span class="o">.</span><span class="n">dat</span>
<span class="p">[</span><span class="n">footer</span><span class="p">]</span>
<span class="n">footer</span><span class="o">.</span><span class="n">dat</span>
</pre></div>
</div>
</li>
<li><p>If you want to make value definitions, here’s your chance:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>[definitions]
debug 1
max_str_len 128
start $150
...
</pre></div>
</div>
</li>
</ol>
<p>If flag <code class="docutils literal notranslate"><span class="pre">-i</span></code> is given, <em class="manpage">wlalink(1)</em> will write list files. Note that
you must compile the object and library files with <code class="docutils literal notranslate"><span class="pre">-i</span></code> flag as well.
Otherwise <em class="manpage">wlalink(1)</em> has no extra information it needs to build list
files.</p>
<p>Here is an example of a list file: Let’s assume you’ve compiled a source file
called <code class="docutils literal notranslate"><span class="pre">main.s</span></code> using the <code class="docutils literal notranslate"><span class="pre">-i</span></code> flag. After you’ve linked the result also
with the <code class="docutils literal notranslate"><span class="pre">-i</span></code> flag <em class="manpage">wlalink(1)</em> has created a list file called
<code class="docutils literal notranslate"><span class="pre">main.lst</span></code>. This file contains the source text and the result data the source
compiled into. List files are good for debugging.</p>
<p>Make sure you don’t create duplicate labels in different places in the
memory map as they break the linking loop. Duplicate labels are allowed when
they overlap each other in the destination machine’s memory.</p>
</section>
<section id="examples">
<h2><span class="section-number">1.4. </span>EXAMPLES<a class="headerlink" href="#examples" title="Permalink to this headline">¶</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">wlalink</span> <span class="o">-</span><span class="n">r</span> <span class="n">linkfile</span> <span class="n">testa</span><span class="o">.</span><span class="n">sfc</span>
<span class="n">wlalink</span> <span class="o">-</span><span class="n">d</span> <span class="o">-</span><span class="n">i</span> <span class="o">-</span><span class="n">b</span> <span class="n">linkfile</span> <span class="n">testb</span><span class="o">.</span><span class="n">sfc</span>
<span class="n">wlalink</span> <span class="o">-</span><span class="n">v</span> <span class="o">-</span><span class="n">S</span> <span class="o">-</span><span class="n">L</span> <span class="o">../../</span><span class="n">lib</span> <span class="n">linkfile</span> <span class="n">testc</span><span class="o">.</span><span class="n">sfc</span>
</pre></div>
</div>
</section>
</section>
<span id="document-man/wla-cpu"></span><section id="manpage-wla-cpu">
<h1><span class="section-number">2. </span>Manpage: WLA-CPU<a class="headerlink" href="#manpage-wla-cpu" title="Permalink to this headline">¶</a></h1>
<section id="synopsis">
<h2><span class="section-number">2.1. </span>SYNOPSIS<a class="headerlink" href="#synopsis" title="Permalink to this headline">¶</a></h2>
<div class="line-block">
<div class="line"><code class="docutils literal notranslate"><span class="pre">wla-6502</span></code> [<code class="docutils literal notranslate"><span class="pre">OPTIONS</span></code>] <code class="docutils literal notranslate"><span class="pre">SRC_FILE</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">wla-65816</span></code> [<code class="docutils literal notranslate"><span class="pre">OPTIONS</span></code>] <code class="docutils literal notranslate"><span class="pre">SRC_FILE</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">wla-65c02</span></code> [<code class="docutils literal notranslate"><span class="pre">OPTIONS</span></code>] <code class="docutils literal notranslate"><span class="pre">SRC_FILE</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">wla-65ce02</span></code> [<code class="docutils literal notranslate"><span class="pre">OPTIONS</span></code>] <code class="docutils literal notranslate"><span class="pre">SRC_FILE</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">wla-6800</span></code> [<code class="docutils literal notranslate"><span class="pre">OPTIONS</span></code>] <code class="docutils literal notranslate"><span class="pre">SRC_FILE</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">wla-6801</span></code> [<code class="docutils literal notranslate"><span class="pre">OPTIONS</span></code>] <code class="docutils literal notranslate"><span class="pre">SRC_FILE</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">wla-6809</span></code> [<code class="docutils literal notranslate"><span class="pre">OPTIONS</span></code>] <code class="docutils literal notranslate"><span class="pre">SRC_FILE</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">wla-8008</span></code> [<code class="docutils literal notranslate"><span class="pre">OPTIONS</span></code>] <code class="docutils literal notranslate"><span class="pre">SRC_FILE</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">wla-8080</span></code> [<code class="docutils literal notranslate"><span class="pre">OPTIONS</span></code>] <code class="docutils literal notranslate"><span class="pre">SRC_FILE</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">wla-gb</span></code> [<code class="docutils literal notranslate"><span class="pre">OPTIONS</span></code>] <code class="docutils literal notranslate"><span class="pre">SRC_FILE</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">wla-huc6280</span></code> [<code class="docutils literal notranslate"><span class="pre">OPTIONS</span></code>] <code class="docutils literal notranslate"><span class="pre">SRC_FILE</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">wla-spc700</span></code> [<code class="docutils literal notranslate"><span class="pre">OPTIONS</span></code>] <code class="docutils literal notranslate"><span class="pre">SRC_FILE</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">wla-superfx</span></code> [<code class="docutils literal notranslate"><span class="pre">OPTIONS</span></code>] <code class="docutils literal notranslate"><span class="pre">SRC_FILE</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">wla-z80</span></code> [<code class="docutils literal notranslate"><span class="pre">OPTIONS</span></code>] <code class="docutils literal notranslate"><span class="pre">SRC_FILE</span></code></div>
</div>
</section>
<section id="options">
<h2><span class="section-number">2.2. </span>OPTIONS<a class="headerlink" href="#options" title="Permalink to this headline">¶</a></h2>
<dl class="option-list">
<dt><kbd><span class="option">-h</span></kbd></dt>
<dd><p>Assume all label references are 16-bit by default (size hints still work)</p>
</dd>
<dt><kbd><span class="option">-i</span></kbd></dt>
<dd><p>Add list file information</p>
</dd>
<dt><kbd><span class="option">-k</span></kbd></dt>
<dd><p>Keep empty sections</p>
</dd>
<dt><kbd><span class="option">-M</span></kbd></dt>
<dd><p>Output makefile rules</p>
</dd>
<dt><kbd><span class="option">-q</span></kbd></dt>
<dd><p>Quiet mode (<code class="docutils literal notranslate"><span class="pre">.PRINT*</span></code>-directives output nothing)</p>
</dd>
<dt><kbd><span class="option">-s</span></kbd></dt>
<dd><p>Don’t create _sizeof_* definitions</p>
</dd>
<dt><kbd><span class="option">-t</span></kbd></dt>
<dd><p>Test compile (Don’t output any files)</p>
</dd>
<dt><kbd><span class="option">-v</span></kbd></dt>
<dd><p>Verbose messages</p>
</dd>
<dt><kbd><span class="option">-x</span></kbd></dt>
<dd><p>Extra compile time labels and definitions</p>
</dd>
<dt><kbd><span class="option">-I <var>DIR</var></span></kbd></dt>
<dd><p>Add include directory</p>
</dd>
<dt><kbd><span class="option">-D <var>DEF</var></span></kbd></dt>
<dd><p>Declare definition</p>
</dd>
</dl>
<p>Choose one:</p>
<dl class="option-list">
<dt><kbd><span class="option">-o <var>OUT</var></span></kbd></dt>
<dd><p>Output an object file</p>
</dd>
<dt><kbd><span class="option">-l <var>OUT</var></span></kbd></dt>
<dd><p>Output an library file</p>
</dd>
</dl>
</section>
<section id="description">
<h2><span class="section-number">2.3. </span>DESCRIPTION<a class="headerlink" href="#description" title="Permalink to this headline">¶</a></h2>
<p>Assemble a BIN_FILE to an object file (<code class="docutils literal notranslate"><span class="pre">-o</span></code>) or to an library file (<code class="docutils literal notranslate"><span class="pre">-l</span></code>).</p>
<p>These object files can be linked together (or with library files) later
with <em class="manpage">wlalink(1)</em>.</p>
<p>Name object files so that they can be recognized as object files. Normal
suffix is <code class="docutils literal notranslate"><span class="pre">.o</span></code> (WLA default). This can also be changed with <code class="docutils literal notranslate"><span class="pre">.OUTNAME</span></code>.</p>
<p>Name these files so that they can be recognized as library files. Normal
suffix is <code class="docutils literal notranslate"><span class="pre">.lib</span></code> (WLA default).</p>
<p>With object files you can reduce the amount of compiling when editing
small parts of the program. Note also the possibility of using local
labels (starting with <code class="docutils literal notranslate"><span class="pre">_</span></code>).</p>
<p>With library files you can reduce the amount of compiling. Library files
are meant to hold general functions that can be used in different projects.
Note also the possibility of using local labels (starting with <code class="docutils literal notranslate"><span class="pre">_</span></code>).
Library files consist only of <code class="docutils literal notranslate"><span class="pre">FREE</span></code> sections.</p>
<p><strong>Note</strong>: When you compile objects, group 1 directives are saved for linking
time, when they are all compared and if they differ, an error message is
shown. It is advisable to use something like an include file to hold all
the group 1 directives for that particular project and include it to every
object file.</p>
<p>If you are interested in the WLA object file format, take a look at the
file <code class="docutils literal notranslate"><span class="pre">txt/wla_file_formats.txt</span></code> which is included in the release archive.</p>
</section>
<section id="examples">
<h2><span class="section-number">2.4. </span>EXAMPLES<a class="headerlink" href="#examples" title="Permalink to this headline">¶</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">wla</span><span class="o">-</span><span class="n">gb</span> <span class="o">-</span><span class="n">D</span> <span class="n">DEBUG</span> <span class="o">-</span><span class="n">D</span> <span class="n">VERBOSE</span><span class="o">=</span><span class="mi">5</span> <span class="o">-</span><span class="n">D</span> <span class="n">NAME</span> <span class="o">=</span> <span class="s2">&quot;math v1.0&quot;</span> <span class="o">-</span><span class="n">o</span> <span class="n">math</span><span class="o">.</span><span class="n">o</span> <span class="n">math</span><span class="o">.</span><span class="n">s</span>
</pre></div>
</div>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">-D</span> <span class="pre">IEXIST</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">-D</span> <span class="pre">DAY=10</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">-D</span> <span class="pre">BASE</span> <span class="pre">=</span> <span class="pre">$10</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">-D</span> <span class="pre">NAME=elvis</span></code></p></li>
</ul>
</section>
</section>
<span id="document-man/wlab"></span><section id="manpage-wlab">
<h1><span class="section-number">3. </span>Manpage: WLAB<a class="headerlink" href="#manpage-wlab" title="Permalink to this headline">¶</a></h1>
<section id="synopsis">
<h2><span class="section-number">3.1. </span>SYNOPSIS<a class="headerlink" href="#synopsis" title="Permalink to this headline">¶</a></h2>
<div class="line-block">
<div class="line"><code class="docutils literal notranslate"><span class="pre">wlab</span></code> -[<code class="docutils literal notranslate"><span class="pre">ap</span></code>]{<code class="docutils literal notranslate"><span class="pre">bdh</span></code>} <code class="docutils literal notranslate"><span class="pre">BIN_FILE</span></code></div>
</div>
</section>
<section id="options">
<h2><span class="section-number">3.2. </span>OPTIONS<a class="headerlink" href="#options" title="Permalink to this headline">¶</a></h2>
<dl class="option-list">
<dt><kbd><span class="option">-a</span></kbd></dt>
<dd><p>Print the address (relative to the beginning of the data).</p>
</dd>
<dt><kbd><span class="option">-p</span></kbd></dt>
<dd><p>Don’t print file header.</p>
</dd>
</dl>
<p>Choose one:</p>
<dl class="option-list">
<dt><kbd><span class="option">-b</span></kbd></dt>
<dd><p>Output data in binary format.</p>
</dd>
<dt><kbd><span class="option">-d</span></kbd></dt>
<dd><p>Output data in decimal format.</p>
</dd>
<dt><kbd><span class="option">-h</span></kbd></dt>
<dd><p>Output data in hexadecimal format.</p>
</dd>
</dl>
</section>
<section id="description">
<h2><span class="section-number">3.3. </span>DESCRIPTION<a class="headerlink" href="#description" title="Permalink to this headline">¶</a></h2>
<p><em class="manpage">wlab(1)</em> converts binary files to WLA’s byte definition strings and
print it to the standard output.</p>
</section>
<section id="examples">
<h2><span class="section-number">3.4. </span>EXAMPLES<a class="headerlink" href="#examples" title="Permalink to this headline">¶</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">wlab</span> <span class="o">-</span><span class="n">da</span> <span class="n">gayskeletor</span><span class="o">.</span><span class="n">bin</span> <span class="o">&gt;</span> <span class="n">gayskeletor</span><span class="o">.</span><span class="n">s</span>
<span class="n">wlab</span> <span class="o">-</span><span class="n">bap</span> <span class="n">iscandar</span><span class="o">.</span><span class="n">bin</span> <span class="o">&gt;</span> <span class="n">iscandar</span><span class="o">.</span><span class="n">s</span>
<span class="n">wlab</span> <span class="o">-</span><span class="n">h</span> <span class="n">starsha</span><span class="o">.</span><span class="n">bin</span> <span class="o">&gt;</span> <span class="n">starsha</span><span class="o">.</span><span class="n">s</span>
</pre></div>
</div>
</section>
</section>
</div>


      </div>
      <div class="bottomnav" role="navigation" aria-label="bottom navigation">
      
        <p>
        <a class="uplink" href="#">Contents</a>
        </p>

      </div>

    <div class="footer" role="contentinfo">
        &#169; Copyright 1998, vhelin.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 4.4.0.
    </div>
  </body>
</html>